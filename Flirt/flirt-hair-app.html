<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Runtime-configurable client settings (override by replacing content) -->
    <meta name="flirt-api-base" content="/api">
    <meta name="flirt-support-whatsapp" content="27821234567">
    <meta name="flirt-media-base" content="https://www.flirthair.co.za">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FL!RT - Premium Hair Extensions</title>

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#F67599">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Flirt">
    <meta name="description" content="Book appointments, shop products, and earn rewards at Flirt Hair & Beauty Bar">

    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">

    <!-- Flirt Brand Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='100' fill='%23F67599'/><text y='68' x='50' text-anchor='middle' font-size='36' font-family='Arial' font-weight='300' letter-spacing='2' fill='white'>FL<tspan fill='%23414042'>.</tspan>RT</text></svg>">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">

    <!-- Google Fonts - Closest to Lulo Clean One & Humanist -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@300;400;600&family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            /* Flirt Brand Colors - from Style Guide */
            --brand-pink: #F67599;          /* Primary - Pantone 190 C */
            --brand-pink-dark: #e05a7f;     /* Darker pink for hover states */
            --brand-charcoal: #414042;      /* Secondary - Pantone Black 7 C */
            --brand-white: #ffffff;         /* Base color */

            /* Legacy variable mapping for compatibility */
            --primary-black: #414042;
            --primary-white: #ffffff;
            --accent-pink: #F67599;
            --accent-gold: #F67599;         /* Using pink instead of gold for brand consistency */
            --gray-dark: #414042;
            --gray-medium: #6d6e70;
            --gray-light: #f8f8f8;
            --success: #4CAF50;
            --warning: #FF9800;
            --shadow: rgba(65, 64, 66, 0.1);
        }

        body {
            font-family: 'Open Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--gray-light);
            color: var(--brand-charcoal);
            line-height: 1.6;
        }

        /* Brand Typography */
        .logo, h1, h2, h3, .section-title {
            font-family: 'Josefin Sans', 'Helvetica Neue', Arial, sans-serif;
            letter-spacing: 0.15em;
            text-transform: uppercase;
        }

        /* App Container */
        .app-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        .app-header {
            background: linear-gradient(135deg, var(--brand-charcoal) 0%, #2d2d2e 100%);
            color: white;
            padding: 0;
            display: flex;
            justify-content: space-between;
            align-items: stretch;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            min-height: 80px;
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 25px;
            background: var(--brand-pink);
            position: relative;
        }

        .logo::after {
            content: '';
            position: absolute;
            right: -30px;
            top: 0;
            bottom: 0;
            width: 60px;
            background: var(--brand-pink);
            clip-path: polygon(0 0, 50% 0, 100% 100%, 0 100%);
        }

        .logo img {
            height: 60px;
            width: auto;
            position: relative;
            z-index: 1;
        }

        .header-center {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 40px;
        }

        .header-tagline {
            font-family: 'Josefin Sans', Arial, sans-serif;
            font-size: 11px;
            letter-spacing: 0.3em;
            text-transform: uppercase;
            color: rgba(255, 255, 255, 0.6);
            font-weight: 300;
        }

        .header-icons {
            display: flex;
            gap: 8px;
            align-items: center;
            padding: 0 20px;
        }

        .icon-btn {
            background: rgba(255, 255, 255, 0.08);
            border: none;
            color: white;
            font-size: 20px;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
            width: 44px;
            height: 44px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon-btn:hover {
            background: var(--brand-pink);
            transform: translateY(-2px);
        }

        .icon-btn svg {
            width: 22px;
            height: 22px;
        }

        .badge {
            position: absolute;
            top: -4px;
            right: -4px;
            background: #ff4757;
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            font-size: 11px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            box-shadow: 0 2px 6px rgba(255, 71, 87, 0.4);
        }

        .profile-btn {
            background: linear-gradient(135deg, var(--brand-pink) 0%, var(--brand-pink-dark) 100%);
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .profile-btn:hover {
            background: linear-gradient(135deg, var(--brand-pink-dark) 0%, var(--brand-pink) 100%);
            border-color: rgba(255, 255, 255, 0.4);
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            background: white;
            border-bottom: 1px solid var(--gray-light);
            overflow-x: auto;
            position: sticky;
            top: 80px;
            z-index: 90;
        }

        .nav-tab {
            flex: 1;
            min-width: 80px;
            padding: 12px 10px;
            text-align: center;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 12px;
            color: var(--gray-medium);
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            white-space: nowrap;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
        }

        .nav-icon {
            width: 22px;
            height: 22px;
            transition: all 0.3s;
        }

        .nav-tab:hover .nav-icon {
            transform: translateY(-2px);
        }

        .nav-tab.active {
            color: var(--brand-pink);
            border-bottom-color: var(--brand-pink);
            font-weight: 600;
        }

        .nav-tab.active .nav-icon {
            stroke-width: 2.5;
        }

        /* Content Area */
        .content-area {
            flex: 1;
            padding: 20px;
            display: none;
        }

        .content-area.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Home Dashboard */
        .welcome-banner {
            background: linear-gradient(135deg, var(--primary-black) 0%, var(--gray-dark) 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
        }

        .welcome-banner::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 200px;
            height: 200px;
            background: url('https://www.flirthair.co.za/wp-content/uploads/2022/03/home-image-1.jpg') center/cover;
            opacity: 0.1;
            border-radius: 50%;
        }

        .welcome-title {
            font-size: 24px;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .points-display {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            background: rgba(255, 255, 255, 0.1);
            padding: 10px 15px;
            border-radius: 10px;
            width: fit-content;
            position: relative;
            z-index: 1;
        }

        .points-icon {
            color: var(--brand-pink);
            font-size: 24px;
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .action-card {
            background: white;
            border: 2px solid var(--gray-light);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .action-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, var(--brand-pink) 0%, transparent 100%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .action-card:hover::before {
            opacity: 0.05;
        }

        .action-card:hover {
            border-color: var(--brand-pink);
            transform: translateY(-5px);
            box-shadow: 0 5px 15px var(--shadow);
        }

        .action-icon {
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 50px;
        }

        .action-title {
            font-weight: 600;
            font-size: 14px;
            position: relative;
            z-index: 1;
        }

        /* Section Headers */
        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: var(--primary-black);
        }

        .view-all-btn {
            color: var(--brand-pink);
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
        }

        /* Cards */
        .card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 10px var(--shadow);
        }

        .offer-card {
            background: linear-gradient(135deg, var(--brand-pink) 0%, var(--brand-pink-dark) 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .offer-card:hover {
            transform: scale(1.02);
        }

        .offer-badge {
            display: inline-block;
            background: rgba(255, 255, 255, 0.3);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            margin-bottom: 10px;
        }

        .offer-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .offer-description {
            font-size: 14px;
            opacity: 0.9;
        }

        /* Booking Section */
        .booking-type-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .booking-type-card {
            background: white;
            border: 3px solid var(--gray-light);
            border-radius: 20px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .booking-type-card:hover {
            border-color: var(--brand-pink);
            transform: translateY(-8px);
            box-shadow: 0 10px 30px var(--shadow);
        }

        .booking-type-image {
            width: 100%;
            height: 200px;
            background-size: cover;
            background-position: center;
            position: relative;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            padding-bottom: 15px;
        }

        .booking-type-overlay {
            background: linear-gradient(to top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 50%, transparent 100%);
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
        }

        .booking-type-content {
            padding: 25px 30px 30px;
        }

        .booking-type-icon {
            font-size: 80px;
            margin-bottom: 15px;
        }

        .booking-type-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--primary-black);
            margin-bottom: 10px;
        }

        .booking-type-description {
            font-size: 14px;
            color: var(--gray-medium);
            margin-bottom: 20px;
        }

        .booking-type-features {
            text-align: left;
            font-size: 14px;
            color: var(--gray-dark);
            line-height: 1.8;
            background: var(--gray-light);
            padding: 15px;
            border-radius: 10px;
        }

        .stylist-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stylist-card {
            background: white;
            border: 2px solid var(--gray-light);
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .stylist-card:hover {
            border-color: var(--brand-pink);
            transform: translateY(-5px);
            box-shadow: 0 8px 20px var(--shadow);
        }

        .stylist-card.favorite {
            border-color: var(--brand-pink);
            background: linear-gradient(135deg, rgba(246, 117, 153, 0.05) 0%, transparent 100%);
        }

        .favorite-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: var(--brand-pink);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .stylist-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: bold;
            color: white;
            margin: 0 auto 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .stylist-avatar-small {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: bold;
            color: white;
            background: var(--brand-pink);
        }

        .stylist-info {
            text-align: center;
        }

        .stylist-name {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 5px;
            color: var(--primary-black);
        }

        .stylist-specialty {
            font-size: 13px;
            color: var(--gray-medium);
            margin-bottom: 10px;
        }

        .stylist-badges {
            display: flex;
            gap: 8px;
            justify-content: center;
            flex-wrap: wrap;
            margin: 10px 0;
        }

        .badge-specialty {
            background: var(--gray-light);
            color: var(--gray-dark);
            padding: 5px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }

        .stylist-rating {
            font-size: 14px;
            color: var(--gray-dark);
            margin: 8px 0;
        }

        .stylist-availability {
            font-size: 13px;
            color: var(--success);
            font-weight: 500;
        }

        .booking-progress {
            display: flex;
            justify-content: space-between;
            margin-bottom: 25px;
            gap: 10px;
        }

        .progress-step {
            flex: 1;
            text-align: center;
            padding: 12px 10px;
            background: var(--gray-light);
            border-radius: 8px;
            font-size: 13px;
            font-weight: 600;
            color: var(--gray-medium);
            transition: all 0.3s;
        }

        .progress-step.active {
            background: var(--brand-pink);
            color: white;
        }

        .progress-step.completed {
            background: var(--success);
            color: white;
        }

        .selected-stylist-banner {
            background: var(--gray-light);
            padding: 15px;
            border-radius: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .service-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .service-card {
            background: white;
            border: 2px solid var(--gray-light);
            border-radius: 15px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }

        .service-image {
            width: 100%;
            height: 180px;
            object-fit: cover;
        }

        .service-content {
            padding: 15px;
        }

        .service-card.selected {
            border-color: var(--brand-pink);
            background: rgba(231, 84, 128, 0.05);
        }

        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px var(--shadow);
        }

        .service-name {
            font-weight: 600;
            margin-top: 10px;
            margin-bottom: 5px;
        }

        .service-duration {
            color: var(--gray-medium);
            font-size: 13px;
        }

        .service-price {
            color: var(--brand-pink);
            font-weight: 600;
            margin-top: 10px;
            font-size: 18px;
        }

        /* Calendar */
        .calendar-container {
            margin: 20px 0;
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .calendar-month {
            font-weight: 600;
            font-size: 18px;
        }

        .calendar-nav {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            padding: 5px 10px;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid var(--gray-light);
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }

        .calendar-day.disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .calendar-day.selected {
            background: var(--brand-pink);
            color: white;
            font-weight: 600;
        }

        .calendar-day:hover:not(.disabled):not(.selected) {
            background: var(--gray-light);
        }

        .time-slots {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }

        .time-slot {
            padding: 12px;
            border: 2px solid var(--gray-light);
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 14px;
        }

        .time-slot.selected {
            background: var(--brand-pink);
            color: white;
            border-color: var(--brand-pink);
        }

        .time-slot:hover:not(.selected):not(.unavailable) {
            border-color: var(--brand-pink);
        }

        .time-slot.unavailable {
            background: var(--gray-light);
            color: var(--gray-medium);
            border-color: var(--gray-light);
            cursor: not-allowed;
            opacity: 0.5;
            text-decoration: line-through;
        }

        /* Products */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .product-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 2px 10px var(--shadow);
            transition: transform 0.3s;
            cursor: pointer;
        }

        .product-card:hover {
            transform: translateY(-5px);
        }

        .product-image {
            width: 100%;
            height: 200px;
            object-fit: contain;
            background: white;
            padding: 20px;
        }

        .product-info {
            padding: 15px;
        }

        .product-name {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 15px;
        }

        .product-description {
            color: var(--gray-medium);
            font-size: 13px;
            margin-bottom: 10px;
        }

        .product-price {
            font-size: 18px;
            font-weight: 600;
            color: var(--brand-pink);
            margin-bottom: 10px;
        }

        .product-rating {
            color: var(--brand-pink);
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .product-rating svg {
            width: 14px;
            height: 14px;
            fill: var(--brand-pink);
            stroke: none;
        }

        /* Buttons - Brand Styled */
        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 4px;
            font-family: 'Josefin Sans', Arial, sans-serif;
            font-size: 14px;
            font-weight: 400;
            letter-spacing: 0.1em;
            text-transform: uppercase;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 10px;
        }

        .btn-primary {
            background: var(--brand-pink);
            color: white;
        }

        .btn-primary:hover {
            background: var(--brand-pink-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(246, 117, 153, 0.3);
        }

        .btn-secondary {
            background: var(--brand-charcoal);
            color: white;
        }

        .btn-secondary:hover {
            background: #2d2d2e;
            transform: translateY(-2px);
        }

        .btn-outline {
            background: transparent;
            color: var(--brand-charcoal);
            border: 2px solid var(--brand-charcoal);
        }

        .btn-outline:hover {
            background: var(--brand-charcoal);
            color: white;
        }

        .btn-pink-outline {
            background: transparent;
            color: var(--brand-pink);
            border: 2px solid var(--brand-pink);
        }

        .btn-pink-outline:hover {
            background: var(--brand-pink);
            color: white;
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 14px;
            width: auto;
        }

        /* Referral Section */
        .referral-code-box {
            background: linear-gradient(135deg, var(--brand-pink) 0%, var(--brand-pink-dark) 100%);
            color: white;
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 20px;
        }

        .referral-code {
            font-size: 32px;
            font-weight: bold;
            letter-spacing: 3px;
            margin: 20px 0;
            background: rgba(255, 255, 255, 0.2);
            padding: 15px;
            border-radius: 10px;
        }

        .share-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
        }

        .share-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 2px solid white;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .share-btn:hover {
            background: white;
            color: var(--brand-pink);
            transform: scale(1.1);
        }

        .referral-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }

        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: var(--brand-pink);
        }

        .stat-label {
            color: var(--gray-medium);
            font-size: 14px;
            margin-top: 5px;
        }

        /* Profile Section */
        .profile-header {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, var(--primary-black) 0%, var(--gray-dark) 100%);
            color: white;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: var(--brand-pink);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            margin: 0 auto 15px;
            border: 5px solid white;
        }

        .profile-name {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .profile-tier {
            color: var(--brand-pink);
            font-size: 16px;
        }

        .menu-list {
            list-style: none;
        }

        .menu-item {
            background: white;
            padding: 18px;
            border-radius: 10px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .menu-item:hover {
            background: var(--gray-light);
            transform: translateX(5px);
        }

        .menu-item-content {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .menu-icon {
            color: var(--brand-pink);
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
        }

        .menu-icon svg {
            width: 24px;
            height: 24px;
        }

        .menu-text {
            font-weight: 500;
        }

        /* Hair Tracker */
        .tracker-progress {
            background: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .progress-circle {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: conic-gradient(var(--brand-pink) 0deg 252deg, var(--gray-light) 252deg 360deg);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            position: relative;
        }

        .progress-circle::before {
            content: '';
            position: absolute;
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: white;
        }

        .progress-text {
            position: relative;
            z-index: 1;
            text-align: center;
        }

        .progress-days {
            font-size: 36px;
            font-weight: bold;
            color: var(--brand-pink);
        }

        .progress-label {
            font-size: 14px;
            color: var(--gray-medium);
        }

        .tracker-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .tracker-stat {
            padding: 15px;
            background: var(--gray-light);
            border-radius: 10px;
            text-align: center;
        }

        /* Notifications */
        .notification-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid var(--brand-pink);
            cursor: pointer;
            transition: all 0.3s;
        }

        .notification-item:hover {
            transform: translateX(5px);
            box-shadow: 0 3px 10px var(--shadow);
        }

        .notification-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .notification-title {
            font-weight: 600;
            font-size: 15px;
        }

        .notification-time {
            color: var(--gray-medium);
            font-size: 12px;
        }

        .notification-message {
            color: var(--gray-medium);
            font-size: 14px;
        }

        /* Appointment Card */
        .appointment-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 15px;
            border-left: 5px solid var(--brand-pink);
        }

        .appointment-date {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary-black);
            margin-bottom: 10px;
        }

        .appointment-details {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .appointment-info {
            flex: 1;
        }

        .appointment-service {
            font-weight: 500;
            margin-bottom: 5px;
        }

        .appointment-time {
            color: var(--gray-medium);
            font-size: 14px;
        }

        .appointment-actions {
            display: flex;
            gap: 10px;
        }

        /* Modal */
        /* Toast Notifications - Brand Styled */
        .toast-container {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 2000;
            display: flex;
            flex-direction: column;
            gap: 12px;
            max-width: 380px;
            width: calc(100% - 40px);
        }

        .toast {
            background: white;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15);
            padding: 0;
            display: flex;
            overflow: hidden;
            animation: toastSlideIn 0.4s cubic-bezier(0.16, 1, 0.3, 1);
            transform-origin: top right;
        }

        .toast.hiding {
            animation: toastSlideOut 0.3s ease forwards;
        }

        @keyframes toastSlideIn {
            from {
                transform: translateX(100%) scale(0.8);
                opacity: 0;
            }
            to {
                transform: translateX(0) scale(1);
                opacity: 1;
            }
        }

        @keyframes toastSlideOut {
            to {
                transform: translateX(100%) scale(0.8);
                opacity: 0;
            }
        }

        .toast-accent {
            width: 6px;
            flex-shrink: 0;
        }

        .toast-accent.success { background: linear-gradient(180deg, #4CAF50 0%, #45a049 100%); }
        .toast-accent.error { background: linear-gradient(180deg, #f44336 0%, #d32f2f 100%); }
        .toast-accent.warning { background: linear-gradient(180deg, #FF9800 0%, #f57c00 100%); }
        .toast-accent.info { background: linear-gradient(180deg, var(--brand-pink) 0%, var(--brand-pink-dark) 100%); }
        .toast-accent.promo { background: linear-gradient(180deg, var(--brand-pink) 0%, #9c27b0 100%); }

        .toast-body {
            flex: 1;
            padding: 16px;
            display: flex;
            gap: 14px;
            align-items: flex-start;
        }

        .toast-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
        }

        .toast-icon.success { background: rgba(76, 175, 80, 0.1); }
        .toast-icon.error { background: rgba(244, 67, 54, 0.1); }
        .toast-icon.warning { background: rgba(255, 152, 0, 0.1); }
        .toast-icon.info { background: rgba(246, 117, 153, 0.1); }
        .toast-icon.promo { background: linear-gradient(135deg, rgba(246, 117, 153, 0.15) 0%, rgba(156, 39, 176, 0.15) 100%); }

        .toast-content {
            flex: 1;
            min-width: 0;
        }

        .toast-title {
            font-family: 'Josefin Sans', Arial, sans-serif;
            font-size: 14px;
            font-weight: 600;
            color: var(--brand-charcoal);
            margin-bottom: 4px;
            letter-spacing: 0.02em;
        }

        .toast-message {
            font-size: 13px;
            color: var(--gray-medium);
            line-height: 1.4;
        }

        .toast-action {
            margin-top: 10px;
        }

        .toast-action-btn {
            background: var(--brand-pink);
            color: white;
            border: none;
            padding: 6px 14px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .toast-action-btn:hover {
            background: var(--brand-pink-dark);
            transform: translateY(-1px);
        }

        .toast-close {
            background: none;
            border: none;
            color: var(--gray-medium);
            cursor: pointer;
            padding: 4px;
            font-size: 18px;
            line-height: 1;
            opacity: 0.5;
            transition: opacity 0.2s;
        }

        .toast-close:hover {
            opacity: 1;
        }

        .toast-progress {
            height: 3px;
            background: var(--gray-light);
            position: relative;
            overflow: hidden;
        }

        .toast-progress-bar {
            height: 100%;
            background: var(--brand-pink);
            animation: toastProgress 5s linear forwards;
        }

        @keyframes toastProgress {
            from { width: 100%; }
            to { width: 0%; }
        }

        /* Modal Styles - Brand Updated */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(65, 64, 66, 0.85);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
            backdrop-filter: blur(4px);
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            animation: modalSlideUp 0.3s ease;
        }

        @keyframes modalSlideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 22px;
            font-weight: 600;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 28px;
            cursor: pointer;
            color: var(--gray-medium);
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--gray-dark);
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--gray-light);
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--brand-pink);
        }


        /* Gallery Grid */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .gallery-item {
            aspect-ratio: 1;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .gallery-item:hover {
            transform: scale(1.02);
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .gallery-label {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0,0,0,0.7));
            color: white;
            padding: 20px 10px 8px;
            font-size: 12px;
            font-weight: 500;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .quick-actions {
                grid-template-columns: repeat(2, 1fr);
            }

            .booking-type-cards {
                grid-template-columns: 1fr;
            }

            .booking-type-image {
                height: 180px;
            }

            .stylist-grid {
                grid-template-columns: 1fr;
            }

            .booking-progress {
                flex-wrap: wrap;
            }

            .progress-step {
                font-size: 11px;
                padding: 10px 5px;
            }

            .selected-stylist-banner {
                flex-direction: column;
                gap: 10px;
            }

            .service-grid {
                grid-template-columns: 1fr;
            }

            .product-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .referral-stats {
                grid-template-columns: 1fr;
            }

            .welcome-title {
                font-size: 20px;
            }

            .section-title {
                font-size: 18px;
            }

            .nav-tabs {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                top: auto;
                background: white;
                box-shadow: 0 -2px 10px var(--shadow);
                padding: 8px 0 5px 0;
                border-bottom: none;
                border-top: 1px solid var(--gray-light);
            }

            .nav-tab {
                padding: 8px 5px;
                font-size: 11px;
                gap: 4px;
                min-width: 60px;
                border-bottom: none;
            }

            .nav-icon {
                width: 20px;
                height: 20px;
            }

            .nav-tab.active {
                border-bottom: none;
                background: rgba(231, 84, 128, 0.05);
                border-radius: 8px;
            }

            .content-area {
                padding-bottom: 80px;
            }
        }

        /* Loading Spinner */
        .spinner {
            border: 4px solid var(--gray-light);
            border-top: 4px solid var(--brand-pink);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Staff Team Section */
        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        .team-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 5px 20px var(--shadow);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
        }

        .team-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 15px 40px rgba(231, 84, 128, 0.2);
        }

        .team-photo {
            width: 100%;
            height: 280px;
            object-fit: cover;
            object-position: center top;
        }

        .team-info {
            padding: 25px;
            text-align: center;
            position: relative;
        }

        .team-avatar-overlay {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--brand-pink) 0%, var(--brand-pink-dark) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            color: white;
            margin: -60px auto 15px;
            border: 5px solid white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .team-name {
            font-size: 22px;
            font-weight: 700;
            color: var(--primary-black);
            margin-bottom: 5px;
        }

        .team-role {
            color: var(--brand-pink);
            font-weight: 600;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 10px;
        }

        .team-tagline {
            font-style: italic;
            color: var(--gray-medium);
            font-size: 15px;
            margin-bottom: 15px;
            line-height: 1.5;
        }

        .team-specialties {
            display: flex;
            gap: 8px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }

        .team-specialty-tag {
            background: linear-gradient(135deg, rgba(231, 84, 128, 0.1) 0%, rgba(212, 175, 55, 0.1) 100%);
            color: var(--brand-pink);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .team-stats {
            display: flex;
            justify-content: center;
            gap: 20px;
            padding-top: 15px;
            border-top: 1px solid var(--gray-light);
        }

        .team-stat {
            text-align: center;
        }

        .team-stat-value {
            font-size: 18px;
            font-weight: 700;
            color: var(--brand-pink);
        }

        .team-stat-label {
            font-size: 11px;
            color: var(--gray-medium);
            text-transform: uppercase;
        }

        .team-socials {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
        }

        .team-social-btn {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: var(--gray-light);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
            font-size: 16px;
        }

        .team-social-btn:hover {
            background: var(--brand-pink);
            color: white;
            transform: scale(1.1);
        }

        /* Sales & Flash Sales */
        .flash-sale-banner {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            position: relative;
            overflow: hidden;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 0 0 rgba(255, 107, 107, 0.4); }
            50% { box-shadow: 0 0 0 15px rgba(255, 107, 107, 0); }
        }

        .flash-sale-timer {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 15px;
        }

        .timer-block {
            background: rgba(255,255,255,0.2);
            padding: 10px 15px;
            border-radius: 10px;
            text-align: center;
            min-width: 60px;
        }

        .timer-value {
            font-size: 24px;
            font-weight: bold;
        }

        .timer-label {
            font-size: 10px;
            text-transform: uppercase;
            opacity: 0.8;
        }

        .sale-badge {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ff6b6b;
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .original-price {
            text-decoration: line-through;
            opacity: 0.6;
            font-size: 14px;
        }

        .sale-price {
            color: #ff6b6b;
            font-weight: bold;
        }

        /* Cart & Checkout */
        .cart-modal {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            max-width: 100%;
            height: 100%;
            background: white;
            z-index: 1001;
            transition: right 0.3s ease;
            display: flex;
            flex-direction: column;
            box-shadow: -5px 0 30px rgba(0,0,0,0.2);
        }

        .cart-modal.open {
            right: 0;
        }

        .cart-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .cart-overlay.show {
            display: block;
        }

        .cart-header {
            padding: 20px;
            background: var(--primary-black);
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .cart-items {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }

        .cart-item {
            display: flex;
            gap: 15px;
            padding: 15px 0;
            border-bottom: 1px solid var(--gray-light);
        }

        .cart-item-image {
            width: 70px;
            height: 70px;
            border-radius: 10px;
            object-fit: cover;
            background: var(--gray-light);
        }

        .cart-item-details {
            flex: 1;
        }

        .cart-item-name {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .cart-item-price {
            color: var(--brand-pink);
            font-weight: 600;
        }

        .quantity-control {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }

        .qty-btn {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            border: 2px solid var(--gray-light);
            background: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            transition: all 0.2s;
        }

        .qty-btn:hover {
            border-color: var(--brand-pink);
            color: var(--brand-pink);
        }

        .cart-footer {
            padding: 20px;
            background: var(--gray-light);
            border-top: 1px solid #ddd;
        }

        .cart-subtotal {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .cart-total {
            display: flex;
            justify-content: space-between;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            padding-top: 10px;
            border-top: 2px solid var(--primary-black);
        }

        /* Checkout */
        .checkout-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px var(--shadow);
        }

        .checkout-section-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .delivery-options {
            display: grid;
            gap: 15px;
        }

        .delivery-option {
            border: 2px solid var(--gray-light);
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .delivery-option:hover {
            border-color: var(--brand-pink);
        }

        .delivery-option.selected {
            border-color: var(--brand-pink);
            background: rgba(231, 84, 128, 0.05);
        }

        .delivery-info h4 {
            margin-bottom: 5px;
        }

        .delivery-info p {
            font-size: 13px;
            color: var(--gray-medium);
        }

        .delivery-price {
            font-weight: 600;
            color: var(--brand-pink);
        }

        .invoice-preview {
            background: var(--gray-light);
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
        }

        .invoice-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px dashed #ddd;
        }

        .invoice-row:last-child {
            border-bottom: none;
            padding-top: 15px;
            font-weight: bold;
            font-size: 18px;
        }

        .price-adjust {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .price-input {
            width: 100px;
            padding: 8px;
            border: 2px solid var(--gray-light);
            border-radius: 8px;
            text-align: right;
            font-weight: 600;
        }

        /* Chat Feature */
        .chat-fab {
            position: fixed;
            bottom: 100px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--brand-pink) 0%, var(--brand-pink-dark) 100%);
            color: white;
            border: none;
            cursor: pointer;
            box-shadow: 0 5px 20px rgba(231, 84, 128, 0.4);
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .chat-fab:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 30px rgba(231, 84, 128, 0.5);
        }

        .chat-fab svg {
            width: 28px;
            height: 28px;
        }

        .chat-notification {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 20px;
            height: 20px;
            background: #ff6b6b;
            border-radius: 50%;
            font-size: 11px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }

        .chat-window {
            position: fixed;
            bottom: 100px;
            right: 20px;
            width: 380px;
            max-width: calc(100% - 40px);
            height: 500px;
            max-height: 70vh;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            z-index: 1000;
            display: none;
            flex-direction: column;
            overflow: hidden;
        }

        .chat-window.open {
            display: flex;
            animation: chatSlideUp 0.3s ease;
        }

        @keyframes chatSlideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .chat-header {
            background: linear-gradient(135deg, var(--brand-pink) 0%, var(--brand-pink-dark) 100%);
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-header-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .chat-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .chat-status {
            font-size: 12px;
            opacity: 0.9;
        }

        .chat-status::before {
            content: '';
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #4CAF50;
            border-radius: 50%;
            margin-right: 5px;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background: #f8f9fa;
        }

        .chat-message {
            margin-bottom: 15px;
            display: flex;
            flex-direction: column;
        }

        .chat-message.received {
            align-items: flex-start;
        }

        .chat-message.sent {
            align-items: flex-end;
        }

        .message-bubble {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 14px;
            line-height: 1.4;
        }

        .chat-message.received .message-bubble {
            background: white;
            border-bottom-left-radius: 4px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .chat-message.sent .message-bubble {
            background: var(--brand-pink);
            color: white;
            border-bottom-right-radius: 4px;
        }

        .message-time {
            font-size: 11px;
            color: var(--gray-medium);
            margin-top: 5px;
        }

        .chat-input-area {
            padding: 15px;
            background: white;
            border-top: 1px solid var(--gray-light);
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid var(--gray-light);
            border-radius: 25px;
            font-size: 14px;
            outline: none;
            transition: border-color 0.3s;
        }

        .chat-input:focus {
            border-color: var(--brand-pink);
        }

        .chat-send-btn {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: var(--brand-pink);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .chat-send-btn:hover {
            background: var(--brand-pink-dark);
            transform: scale(1.05);
        }

        /* Photo Upload Feature */
        .photo-upload-section {
            background: linear-gradient(135deg, rgba(231, 84, 128, 0.05) 0%, rgba(212, 175, 55, 0.05) 100%);
            border: 2px dashed var(--brand-pink);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 20px;
        }

        .photo-upload-section:hover {
            border-color: var(--brand-pink);
            background: rgba(246, 117, 153, 0.1);
        }

        .upload-icon {
            font-size: 50px;
            margin-bottom: 15px;
        }

        .upload-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--primary-black);
        }

        .upload-subtitle {
            color: var(--gray-medium);
            font-size: 14px;
            margin-bottom: 15px;
        }

        .inspo-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .inspo-item {
            aspect-ratio: 1;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .inspo-item:hover {
            transform: scale(1.05);
        }

        .inspo-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .inspo-item-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.7) 0%, transparent 50%);
            opacity: 0;
            transition: opacity 0.3s;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            padding: 10px;
        }

        .inspo-item:hover .inspo-item-overlay {
            opacity: 1;
        }

        .inspo-label {
            color: white;
            font-size: 12px;
            font-weight: 600;
        }

        .upload-preview {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .preview-thumb {
            width: 80px;
            height: 80px;
            border-radius: 10px;
            object-fit: cover;
            border: 3px solid var(--brand-pink);
        }

        @media (max-width: 768px) {
            .team-grid {
                grid-template-columns: 1fr;
            }

            .cart-modal {
                width: 100%;
                right: -100%;
            }

            .chat-window {
                width: 100%;
                height: 100%;
                max-height: 100%;
                bottom: 0;
                right: 0;
                border-radius: 0;
            }

            .chat-fab {
                bottom: 80px;
            }
        }

        /* Auth Modal Styles */
        .auth-tabs {
            display: flex;
            border-bottom: 2px solid var(--gray-light);
            margin-bottom: 20px;
        }

        .auth-tab {
            flex: 1;
            padding: 12px;
            background: none;
            border: none;
            font-size: 16px;
            cursor: pointer;
            color: var(--gray-medium);
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .auth-tab.active {
            color: var(--brand-pink);
            border-bottom-color: var(--brand-pink);
            font-weight: 600;
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
        }

        .auth-input {
            width: 100%;
            padding: 14px 16px;
            border: 2px solid var(--gray-light);
            border-radius: 10px;
            font-size: 16px;
            margin-bottom: 15px;
            transition: border-color 0.3s;
        }

        .auth-input:focus {
            outline: none;
            border-color: var(--brand-pink);
        }

        .auth-btn {
            width: 100%;
            padding: 16px;
            background: var(--brand-pink);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.3s;
        }

        .auth-btn:hover {
            background: var(--brand-pink-dark);
        }

        .auth-btn:disabled {
            background: var(--gray-medium);
            cursor: not-allowed;
        }

        .auth-error {
            color: #ff6b6b;
            font-size: 14px;
            margin-bottom: 15px;
            display: none;
        }

        .auth-error.show {
            display: block;
        }

        /* Social Login Styles */
        .social-auth {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 0 20px;
            margin-bottom: 15px;
        }

        .social-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            padding: 12px 16px;
            border-radius: 10px;
            border: 1px solid #ddd;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            background: white;
        }

        .social-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .social-google {
            color: #333;
        }

        .social-google:hover {
            background: #f8f9fa;
        }

        .social-facebook {
            background: #1877F2;
            color: white;
            border-color: #1877F2;
        }

        .social-facebook:hover {
            background: #166fe5;
        }

        .social-facebook .social-icon {
            fill: white;
        }

        .social-icon {
            flex-shrink: 0;
        }

        .social-divider {
            display: flex;
            align-items: center;
            padding: 0 20px;
            margin-bottom: 15px;
        }

        .social-divider::before,
        .social-divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background: #ddd;
        }

        .social-divider span {
            padding: 0 15px;
            color: #999;
            font-size: 13px;
        }

        .guest-link {
            text-align: center;
            margin-top: 15px;
            color: var(--gray-medium);
            cursor: pointer;
        }

        .guest-link:hover {
            color: var(--brand-pink);
        }

        /* Loading spinner */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Logged in vs logged out states */
        .logged-out-only {
            display: block;
        }

        .logged-in-only {
            display: none;
        }

        body.logged-in .logged-out-only {
            display: none;
        }

        body.logged-in .logged-in-only {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Toast Notification Container -->
    <div class="toast-container" id="toastContainer"></div>

    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="logo"><img src="Flirt pink logo 2.jpeg" alt="FL!RT Hair & Beauty Bar"></div>
            <div class="header-center">
                <span class="header-tagline">Premium Hair Extensions</span>
            </div>
            <div class="header-icons">
                <button class="icon-btn" onclick="showNotifications()" title="Notifications">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                        <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                    </svg>
                    <span class="badge">3</span>
                </button>
                <button class="icon-btn" onclick="showCart()" title="Shopping Cart">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="9" cy="21" r="1"></circle>
                        <circle cx="20" cy="21" r="1"></circle>
                        <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                    </svg>
                    <span class="badge" id="cartCount">2</span>
                </button>
                <button class="icon-btn profile-btn" onclick="switchTab('profile')" title="My Profile">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Navigation Tabs -->
        <nav class="nav-tabs">
            <button class="nav-tab active" data-tab="home" onclick="switchTab('home', event)">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                    <polyline points="9 22 9 12 15 12 15 22"></polyline>
                </svg>
                <span>Home</span>
            </button>
            <button class="nav-tab" data-tab="booking" onclick="switchTab('booking', event)">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
                <span>Book</span>
            </button>
            <button class="nav-tab" data-tab="shop" onclick="switchTab('shop', event)">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="9" cy="21" r="1"></circle>
                    <circle cx="20" cy="21" r="1"></circle>
                    <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                </svg>
                <span>Shop</span>
            </button>
            <button class="nav-tab" data-tab="rewards" onclick="switchTab('rewards', event)">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"></path>
                </svg>
                <span>Rewards</span>
            </button>
            <button class="nav-tab" data-tab="team" onclick="switchTab('team', event)">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                    <circle cx="9" cy="7" r="4"></circle>
                    <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                    <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                </svg>
                <span>Team</span>
            </button>
            <button class="nav-tab" data-tab="tracker" onclick="switchTab('tracker', event)">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21.21 15.89A10 10 0 1 1 8 2.83"></path>
                    <path d="M22 12A10 10 0 0 0 12 2v10z"></path>
                </svg>
                <span>Tracker</span>
            </button>
            <button class="nav-tab" data-tab="profile" onclick="switchTab('profile', event)">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                </svg>
                <span>Profile</span>
            </button>
        </nav>

        <!-- Home Content -->
        <div id="home" class="content-area active">
            <div class="welcome-banner" id="welcomeBanner">
                <div class="welcome-title" id="welcomeTitle">Welcome to FL!RT </div>
                <p id="welcomeSubtitle">Discover premium hair extensions and book your transformation!</p>
                <div class="points-display" id="pointsDisplay" style="display: none;">
                    <span class="points-icon"></span>
                    <div>
                        <strong id="bannerPoints">0 Points</strong>
                        <div style="font-size: 12px; opacity: 0.8;" id="bannerTier">Bronze Member</div>
                    </div>
                </div>
            </div>

            <div class="quick-actions">
                <div class="action-card" onclick="navigateToSection('book')">
                    <div class="action-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="40" height="40" style="color: var(--brand-pink);">
                            <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                            <line x1="16" y1="2" x2="16" y2="6"></line>
                            <line x1="8" y1="2" x2="8" y2="6"></line>
                            <line x1="3" y1="10" x2="21" y2="10"></line>
                        </svg>
                    </div>
                    <div class="action-title">Book Now</div>
                </div>
                <div class="action-card" onclick="switchTab('shop')">
                    <div class="action-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="40" height="40" style="color: var(--brand-pink);">
                            <circle cx="9" cy="21" r="1"></circle>
                            <circle cx="20" cy="21" r="1"></circle>
                            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
                        </svg>
                    </div>
                    <div class="action-title">Shop Products</div>
                </div>
                <div class="action-card" onclick="switchTab('rewards')">
                    <div class="action-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="40" height="40" style="color: var(--brand-pink);">
                            <circle cx="12" cy="8" r="7"></circle>
                            <polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"></polyline>
                        </svg>
                    </div>
                    <div class="action-title">Refer & Earn</div>
                </div>
                <div class="action-card" onclick="switchTab('team')">
                    <div class="action-icon">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="40" height="40" style="color: var(--brand-pink);">
                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                            <circle cx="9" cy="7" r="4"></circle>
                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                            <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                        </svg>
                    </div>
                    <div class="action-title">Meet Our Team</div>
                </div>
            </div>

            <!-- Special Offers Section (dynamically loaded) -->
            <section id="specialOffersSection">
                <div class="section-header">
                    <h2 class="section-title">Special Offers</h2>
                    <a href="#" class="view-all-btn" id="viewAllOffersBtn">View All</a>
                </div>
                <div class="offers-list" id="specialOffersList">
                    <!-- Dynamic content injected by loadSpecialOffers() -->
                    <div class="offer-card" style="opacity: 0.5;">
                        <span class="offer-badge">LOADING</span>
                        <div class="offer-title">Loading offers...</div>
                        <div class="offer-description">Please wait</div>
                    </div>
                </div>
            </section>

            <div class="section-header">
                <h2 class="section-title">Upcoming Appointments</h2>
            </div>

            <!-- Dynamic Upcoming Appointments Container -->
            <div id="upcomingAppointmentsContainer">
                <!-- Loading state -->
                <div class="appointment-card" style="opacity: 0.6;">
                    <div class="appointment-date">Loading...</div>
                    <div class="appointment-details">
                        <div class="appointment-info">
                            <div class="appointment-service">Checking your appointments</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="section-header">
                <h2 class="section-title">Gallery</h2>
            </div>

            <div class="gallery-grid" id="galleryGrid">
                <!-- Gallery items loaded dynamically -->
                <div class="gallery-item" style="display: flex; align-items: center; justify-content: center; background: var(--gray-light);">
                    <span style="color: var(--gray-medium);">Loading...</span>
                </div>
            </div>

            <div id="instagramFeedContainer" style="margin-top: 20px; display: none;">
                <div style="display:flex; justify-content: space-between; align-items:center; margin-bottom: 10px;">
                    <h3 style="font-size: 18px; margin: 0; color: var(--brand-charcoal);">Instagram Highlights</h3>
                    <a id="instagramCTA" href="#" target="_blank" style="display:none; font-size: 14px; color: var(--brand-pink); text-decoration: none;">Follow us</a>
                </div>
                <div id="instagramEmbed" style="width: 100%; min-height: 620px; background: var(--gray-light); border-radius: 12px; overflow: hidden;">
                    <iframe id="instagramEmbedFrame" src="" style="width:100%; height:620px; border:0; overflow:hidden;" allowtransparency="true" allow="encrypted-media"></iframe>
                </div>
                <div id="instagramFallback" style="display:none; color: var(--gray-medium); margin-top: 10px;"></div>
            </div>

            <div class="section-header">
                <h2 class="section-title">Hair Care Tips</h2>
            </div>

            <div class="card" id="hairTipCard">
                <strong> Pro Tip:</strong>
                <p id="hairTipText" style="margin-top: 10px; color: var(--gray-medium);">
                    Loading...
                </p>
            </div>
        </div>

        <!-- Booking Content -->
        <div id="booking" class="content-area">
            <h2 class="section-title" style="margin-bottom: 20px;">Book Your Appointment</h2>

            <!-- Booking Type Selection -->
            <div id="bookingTypeSelection">
                <div class="booking-type-cards">
                    <div class="booking-type-card" onclick="selectBookingType('hair')">
                        <div class="booking-type-image" style="background-image: url('https://www.flirthair.co.za/wp-content/uploads/2022/03/home-footer-images3.jpg');">
                            <div class="booking-type-overlay"></div>
                        </div>
                        <div class="booking-type-content">
                            <div class="booking-type-title">Hair Extensions</div>
                            <div class="booking-type-description">Book with your favorite extension stylist</div>
                            <div class="booking-type-features">
                                 Tape, Weft & Keratin Extensions<br>
                                 Color Matching<br>
                                 Maintenance Services
                            </div>
                        </div>
                    </div>

                    <div class="booking-type-card" onclick="selectBookingType('beauty')">
                        <div class="booking-type-image" style="background-image: url('https://www.flirthair.co.za/wp-content/uploads/2022/03/home-footer-images2.jpg');">
                            <div class="booking-type-overlay"></div>
                        </div>
                        <div class="booking-type-content">
                            <div class="booking-type-title">Beauty Salon</div>
                            <div class="booking-type-description">General beauty treatments - no stylist needed</div>
                            <div class="booking-type-features">
                                 Facials & Skin Treatments<br>
                                 Manicures & Pedicures<br>
                                 Waxing & Threading
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 1: Select Stylist (Hair Extensions) -->
            <div id="stylistSelection" style="display: none;">
                <div class="section-header">
                    <h3 style="font-size: 18px;">Choose Your Stylist</h3>
                </div>

                <div class="stylist-grid">
                    <div class="stylist-card" onclick="selectStylist('lisa')">
                        <div class="stylist-avatar" style="background: linear-gradient(135deg, #F67599 0%, #e05a7f 100%);">L</div>
                        <div class="stylist-info">
                            <div class="stylist-name">Lisa Thompson</div>
                            <div class="stylist-specialty">Senior Stylist  8 years exp</div>
                            <div class="stylist-badges">
                                <span class="badge-specialty">Tape Extensions</span>
                                <span class="badge-specialty">Weft</span>
                            </div>
                            <div class="stylist-rating"><svg viewBox="0 0 24 24" fill="#F67599" width="14" height="14"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg> 4.9 (127 reviews)</div>
                            <div class="stylist-availability"> Available this week</div>
                        </div>
                    </div>

                    <div class="stylist-card" onclick="selectStylist('emma')">
                        <div class="stylist-avatar" style="background: linear-gradient(135deg, var(--brand-pink) 0%, var(--brand-pink-dark) 100%);">E</div>
                        <div class="stylist-info">
                            <div class="stylist-name">Emma Williams</div>
                            <div class="stylist-specialty">Extension Specialist  6 years exp</div>
                            <div class="stylist-badges">
                                <span class="badge-specialty">Keratin Bonds</span>
                                <span class="badge-specialty">Volume</span>
                            </div>
                            <div class="stylist-rating"><svg viewBox="0 0 24 24" fill="#F67599" width="14" height="14"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg> 4.8 (94 reviews)</div>
                            <div class="stylist-availability"> Available this week</div>
                        </div>
                    </div>

                    <div class="stylist-card favorite" onclick="selectStylist('sarah')">
                        <div class="favorite-badge"><svg viewBox="0 0 24 24" fill="currentColor" width="12" height="12" style="margin-right: 4px;"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>Your Favorite</div>
                        <div class="stylist-avatar" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">S</div>
                        <div class="stylist-info">
                            <div class="stylist-name">Sarah Martinez</div>
                            <div class="stylist-specialty">Color Expert  10 years exp</div>
                            <div class="stylist-badges">
                                <span class="badge-specialty">Color Match</span>
                                <span class="badge-specialty">Balayage</span>
                            </div>
                            <div class="stylist-rating"><svg viewBox="0 0 24 24" fill="#F67599" width="14" height="14"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg> 5.0 (203 reviews)</div>
                            <div class="stylist-availability"> Available this week</div>
                        </div>
                    </div>

                    <div class="stylist-card" onclick="selectStylist('maya')">
                        <div class="stylist-avatar" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">M</div>
                        <div class="stylist-info">
                            <div class="stylist-name">Maya Johnson</div>
                            <div class="stylist-specialty">Maintenance Expert  5 years exp</div>
                            <div class="stylist-badges">
                                <span class="badge-specialty">Maintenance</span>
                                <span class="badge-specialty">Repair</span>
                            </div>
                            <div class="stylist-rating"><svg viewBox="0 0 24 24" fill="#F67599" width="14" height="14"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg> 4.9 (156 reviews)</div>
                            <div class="stylist-availability"> Available this week</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 2: Select Service -->
            <div id="serviceSelection" style="display: none;">
                <div class="booking-progress">
                    <div class="progress-step completed">1. Stylist</div>
                    <div class="progress-step active">2. Service</div>
                    <div class="progress-step">3. Date & Time</div>
                    <div class="progress-step">4. Confirm</div>
                </div>

                <div class="selected-stylist-banner">
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div class="stylist-avatar-small" id="selectedStylistAvatar">S</div>
                        <div>
                            <div style="font-weight: 600;" id="selectedStylistName">Sarah Martinez</div>
                            <div style="font-size: 13px; color: var(--gray-medium);" id="selectedStylistSpecialty">Color Expert</div>
                        </div>
                    </div>
                    <button class="btn btn-small btn-outline" onclick="changeStylist()">Change Stylist</button>
                </div>

                <div class="section-header" style="margin-top: 20px;">
                    <h3 style="font-size: 18px;">Select Service</h3>
                </div>

                <div class="service-grid">
                    <div class="service-card" onclick="selectService('tape', this)">
                        <img src="https://www.flirthair.co.za/wp-content/uploads/2022/03/categories1.jpg" alt="Tape Extensions" class="service-image">
                        <div class="service-content">
                            <div class="service-name">Tape Extensions</div>
                            <div class="service-duration">2-3 hours</div>
                            <div class="service-price">R2,500</div>
                        </div>
                    </div>
                    <div class="service-card" onclick="selectService('weft', this)">
                        <img src="https://www.flirthair.co.za/wp-content/uploads/2022/03/categories3.jpg" alt="Weft Installation" class="service-image">
                        <div class="service-content">
                            <div class="service-name">Weft Installation</div>
                            <div class="service-duration">3-4 hours</div>
                            <div class="service-price">R3,200</div>
                        </div>
                    </div>
                    <div class="service-card" onclick="selectService('color', this)">
                        <img src="https://www.flirthair.co.za/wp-content/uploads/2022/03/categories5.jpg" alt="Color Matching" class="service-image">
                        <div class="service-content">
                            <div class="service-name">Color Matching</div>
                            <div class="service-duration">30 min</div>
                            <div class="service-price">Free</div>
                        </div>
                    </div>
                    <div class="service-card" onclick="selectService('maintenance', this)">
                        <img src="https://www.flirthair.co.za/wp-content/uploads/2022/03/categories7.jpg" alt="Maintenance" class="service-image">
                        <div class="service-content">
                            <div class="service-name">Maintenance</div>
                            <div class="service-duration">1-2 hours</div>
                            <div class="service-price">R800</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Step 3: Select Date (Hair Extensions) -->
            <div class="card" id="bookingForm" style="display: none;">
                <div class="booking-progress">
                    <div class="progress-step completed">1. Stylist</div>
                    <div class="progress-step completed">2. Service</div>
                    <div class="progress-step active">3. Date</div>
                    <div class="progress-step">4. Confirm</div>
                </div>

                <div class="selected-stylist-banner">
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div class="stylist-avatar-small" id="selectedStylistAvatar2">S</div>
                        <div>
                            <div style="font-weight: 600;"><span id="selectedStylistName2">Sarah Martinez</span>'s Schedule</div>
                            <div style="font-size: 13px; color: var(--gray-medium);" id="selectedServiceName">Tape Extensions - R2,500</div>
                        </div>
                    </div>
                    <button class="btn btn-small btn-outline" onclick="goBackToService()">Change Service</button>
                </div>

                <div class="section-header" style="margin-top: 20px;">
                    <h3 style="font-size: 18px;">Select Preferred Date</h3>
                    <span style="font-size: 13px; color: var(--gray-medium);">Salon will confirm exact time</span>
                </div>

                <div class="calendar-container">
                    <div class="calendar-header">
                        <button class="calendar-nav" onclick="changeHairCalendarMonth(-1)"></button>
                        <div class="calendar-month" id="hairCalendarMonth">June 2024</div>
                        <button class="calendar-nav" onclick="changeHairCalendarMonth(1)"></button>
                    </div>
                    <div class="calendar-grid" id="calendarGrid">
                        <!-- Calendar will be generated by JS -->
                    </div>
                </div>

                <div class="card" style="background: linear-gradient(135deg, #fff5f8 0%, #ffe8ee 100%); border: 2px solid var(--brand-pink); margin: 20px 0;">
                    <div style="display: flex; gap: 15px; align-items: flex-start;">
                        <div style="font-size: 24px;"></div>
                        <div style="flex: 1;">
                            <div style="font-weight: 600; color: var(--primary-black); margin-bottom: 5px;">Time Confirmation</div>
                            <div style="font-size: 14px; color: var(--gray-dark);">
                                Our salon team will contact you within 24 hours to confirm the exact appointment time based on <span id="selectedStylistName3">Sarah</span>'s availability and your preferences.
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Preferred Time of Day (Optional)</label>
                    <select class="form-input" id="preferredTimeOfDay">
                        <option value="">No preference</option>
                        <option value="morning">Morning (8am - 12pm)</option>
                        <option value="afternoon">Afternoon (12pm - 4pm)</option>
                        <option value="evening">Evening (4pm - 7pm)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Special Requests or Notes</label>
                    <textarea class="form-input" rows="3" placeholder="Any specific requirements, hair goals, time preferences, or questions for your stylist..."></textarea>
                </div>

                <button class="btn btn-primary" onclick="confirmBooking()">Submit Booking Request</button>
            </div>

            <!-- Beauty Salon Booking (No Stylist) -->
            <div id="beautyBooking" style="display: none;">
                <div class="booking-progress">
                    <div class="progress-step completed">1. Type</div>
                    <div class="progress-step active">2. Service</div>
                    <div class="progress-step">3. Date & Time</div>
                    <div class="progress-step">4. Confirm</div>
                </div>

                <div class="card" style="background: linear-gradient(135deg, rgba(231, 84, 128, 0.1) 0%, transparent 100%); margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div style="font-weight: 600; margin-bottom: 5px;"> Beauty Salon Services</div>
                            <div style="font-size: 14px; color: var(--gray-medium);">Quick booking - no stylist selection needed</div>
                        </div>
                        <button class="btn btn-small btn-outline" onclick="changeBookingType()">Change Type</button>
                    </div>
                </div>

                <div class="section-header">
                    <h3 style="font-size: 18px;">Select Beauty Service</h3>
                </div>

                <div class="service-grid">
                    <div class="service-card" onclick="selectBeautyService('facial')">
                        <img src="https://images.unsplash.com/photo-1570172619644-dfd03ed5d881?w=400&h=300&fit=crop" alt="Facial Treatment" class="service-image">
                        <div class="service-content">
                            <div class="service-name">Facial Treatment</div>
                            <div class="service-duration">60 min</div>
                            <div class="service-price">R450</div>
                        </div>
                    </div>
                    <div class="service-card" onclick="selectBeautyService('manicure')">
                        <img src="https://images.unsplash.com/photo-1604654894610-df63bc536371?w=400&h=300&fit=crop" alt="Manicure" class="service-image">
                        <div class="service-content">
                            <div class="service-name">Manicure</div>
                            <div class="service-duration">45 min</div>
                            <div class="service-price">R250</div>
                        </div>
                    </div>
                    <div class="service-card" onclick="selectBeautyService('pedicure')">
                        <img src="https://images.unsplash.com/photo-1519491050282-cf00c82424b4?w=400&h=300&fit=crop" alt="Pedicure" class="service-image">
                        <div class="service-content">
                            <div class="service-name">Pedicure</div>
                            <div class="service-duration">60 min</div>
                            <div class="service-price">R300</div>
                        </div>
                    </div>
                    <div class="service-card" onclick="selectBeautyService('waxing')">
                        <img src="https://images.unsplash.com/photo-1457972729786-0411a3b2b626?w=400&h=300&fit=crop" alt="Waxing" class="service-image">
                        <div class="service-content">
                            <div class="service-name">Waxing</div>
                            <div class="service-duration">30-60 min</div>
                            <div class="service-price">From R150</div>
                        </div>
                    </div>
                    <div class="service-card" onclick="selectBeautyService('threading')">
                        <img src="https://images.unsplash.com/photo-1528459801416-a9e53bbf4e17?w=400&h=300&fit=crop" alt="Eyebrow Threading" class="service-image">
                        <div class="service-content">
                            <div class="service-name">Eyebrow Threading</div>
                            <div class="service-duration">15 min</div>
                            <div class="service-price">R80</div>
                        </div>
                    </div>
                    <div class="service-card" onclick="selectBeautyService('massage')">
                        <img src="https://images.unsplash.com/photo-1544161515-4ab6ce6db874?w=400&h=300&fit=crop" alt="Massage Therapy" class="service-image">
                        <div class="service-content">
                            <div class="service-name">Massage Therapy</div>
                            <div class="service-duration">60 min</div>
                            <div class="service-price">R500</div>
                        </div>
                    </div>
                </div>

                <div class="card" id="beautyBookingCalendar" style="display: none;">
                    <div class="booking-progress">
                        <div class="progress-step completed">1. Type</div>
                        <div class="progress-step completed">2. Service</div>
                        <div class="progress-step active">3. Date & Time</div>
                        <div class="progress-step">4. Confirm</div>
                    </div>

                    <div style="background: var(--gray-light); padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-weight: 600;" id="selectedBeautyServiceName">Facial Treatment</div>
                                <div style="font-size: 13px; color: var(--gray-medium);" id="selectedBeautyServiceDetails">60 min - R450</div>
                            </div>
                            <button class="btn btn-small btn-outline" onclick="goBackToBeautyService()">Change Service</button>
                        </div>
                    </div>

                    <div class="section-header">
                        <h3 style="font-size: 18px;">Select Date</h3>
                    </div>

                    <div class="calendar-container">
                        <div class="calendar-header">
                            <button class="calendar-nav" onclick="changeBeautyCalendarMonth(-1)"></button>
                            <div class="calendar-month" id="beautyCalendarMonth">June 2024</div>
                            <button class="calendar-nav" onclick="changeBeautyCalendarMonth(1)"></button>
                        </div>
                        <div class="calendar-grid" id="beautyCalendarGrid">
                            <!-- Calendar will be generated by JS -->
                        </div>
                    </div>

                    <div class="section-header">
                        <h3 style="font-size: 18px;">Available Times</h3>
                        <span style="font-size: 13px; color: var(--gray-medium);">Next available therapist</span>
                    </div>

                    <div class="time-slots" id="beautyTimeSlots">
                        <div class="time-slot" onclick="selectBeautyTime(this)">08:00</div>
                        <div class="time-slot" onclick="selectBeautyTime(this)">09:00</div>
                        <div class="time-slot" onclick="selectBeautyTime(this)">10:00</div>
                        <div class="time-slot" onclick="selectBeautyTime(this)">11:00</div>
                        <div class="time-slot" onclick="selectBeautyTime(this)">12:00</div>
                        <div class="time-slot" onclick="selectBeautyTime(this)">13:00</div>
                        <div class="time-slot" onclick="selectBeautyTime(this)">14:00</div>
                        <div class="time-slot" onclick="selectBeautyTime(this)">15:00</div>
                        <div class="time-slot" onclick="selectBeautyTime(this)">16:00</div>
                        <div class="time-slot" onclick="selectBeautyTime(this)">17:00</div>
                        <div class="time-slot" onclick="selectBeautyTime(this)">18:00</div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Special Requests or Notes</label>
                        <textarea class="form-input" rows="3" placeholder="Any specific requirements or preferences..."></textarea>
                    </div>

                    <button class="btn btn-primary" onclick="confirmBeautyBooking()">Confirm Booking</button>
                </div>
            </div>
        </div>

        <!-- Shop Content -->
        <div id="shop" class="content-area">
            <h2 class="section-title" style="margin-bottom: 20px;">Shop Products</h2>

            <!-- Flash Sale Banner -->
            <div class="flash-sale-banner">
                <div style="text-align: center;">
                    <div style="font-size: 12px; text-transform: uppercase; letter-spacing: 2px; opacity: 0.9;">Flash Sale</div>
                    <div style="font-size: 24px; font-weight: bold; margin: 10px 0;">40% OFF All Care Products!</div>
                    <div style="font-size: 14px;">Use code: FLASH40 at checkout</div>
                </div>
                <div class="flash-sale-timer">
                    <div class="timer-block">
                        <div class="timer-value" id="hours">05</div>
                        <div class="timer-label">Hours</div>
                    </div>
                    <div class="timer-block">
                        <div class="timer-value" id="minutes">32</div>
                        <div class="timer-label">Mins</div>
                    </div>
                    <div class="timer-block">
                        <div class="timer-value" id="seconds">48</div>
                        <div class="timer-label">Secs</div>
                    </div>
                </div>
            </div>

            <div class="form-group" style="position: relative;">
                <svg viewBox="0 0 24 24" fill="none" stroke="var(--gray-medium)" stroke-width="2" width="18" height="18" style="position: absolute; left: 14px; top: 50%; transform: translateY(-50%); pointer-events: none;">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
                <input type="search" class="form-input" placeholder="Search products..." style="padding-left: 42px;">
            </div>

            <div style="display: flex; gap: 10px; margin-bottom: 20px; overflow-x: auto;">
                <button class="btn btn-small btn-primary" style="white-space: nowrap;">All Products</button>
                <button class="btn btn-small" style="white-space: nowrap; background: linear-gradient(135deg, var(--brand-pink) 0%, var(--brand-pink-dark) 100%); color: white; border: none;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="14" height="14" style="vertical-align: middle; margin-right: 4px;">
                        <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                    </svg>
                    On Sale
                </button>
                <button class="btn btn-small btn-outline" style="white-space: nowrap;">Extensions</button>
                <button class="btn btn-small btn-outline" style="white-space: nowrap;">Care Products</button>
                <button class="btn btn-small btn-outline" style="white-space: nowrap;">Styling</button>
            </div>

            <!-- Sale Products Section -->
            <div class="section-header">
                <h3 class="section-title" style="color: var(--brand-pink); display: flex; align-items: center; gap: 8px;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                        <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
                    </svg>
                    Hot Deals
                </h3>
                <a href="#" class="view-all-btn">View All Sales</a>
            </div>

            <div class="product-grid" style="margin-bottom: 30px;">
                <div class="product-card" onclick="addToCart('repair-me', 'Repair-Me.Wash', 231, 385)" style="position: relative;">
                    <span class="sale-badge">-40%</span>
                    <img src="https://www.flirthair.co.za/wp-content/uploads/2022/03/KEVIN-MURPHY-Angel-300x300.png" alt="Repair Me Wash" class="product-image">
                    <div class="product-info">
                        <div class="product-name">Repair-Me.Wash</div>
                        <div class="product-description">Reconstructing shampoo</div>
                        <div class="product-price">
                            <span class="original-price">R385</span>
                            <span class="sale-price">R231</span>
                        </div>
                        <div class="product-rating"><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg> (89)</div>
                        <button class="btn btn-secondary btn-small" onclick="event.stopPropagation(); addToCart('repair-me', 'Repair-Me.Wash', 231, 385)">Add to Cart</button>
                    </div>
                </div>

                <div class="product-card" onclick="addToCart('hydrate-me', 'Hydrate-Me.Masque', 288, 480)" style="position: relative;">
                    <span class="sale-badge">-40%</span>
                    <img src="https://www.flirthair.co.za/wp-content/uploads/2022/03/KEVIN-MURPHY-01-300x300.png" alt="Hydrate Me Masque" class="product-image">
                    <div class="product-info">
                        <div class="product-name">Hydrate-Me.Masque</div>
                        <div class="product-description">Intense hydrating mask</div>
                        <div class="product-price">
                            <span class="original-price">R480</span>
                            <span class="sale-price">R288</span>
                        </div>
                        <div class="product-rating"><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg> (124)</div>
                        <button class="btn btn-secondary btn-small" onclick="event.stopPropagation(); addToCart('hydrate-me', 'Hydrate-Me.Masque', 288, 480)">Add to Cart</button>
                    </div>
                </div>
            </div>

            <div class="section-header">
                <h3 class="section-title">All Products</h3>
            </div>

            <div class="product-grid">
                <div class="product-card" onclick="showProductDetails('angel-wash')">
                    <img src="https://www.flirthair.co.za/wp-content/uploads/2022/03/KEVIN-MURPHY-Angel-300x300.png" alt="Angel Wash" class="product-image">
                    <div class="product-info">
                        <div class="product-name">Angel.Wash</div>
                        <div class="product-description">Fine, dry & colored hair</div>
                        <div class="product-price">R385</div>
                        <div class="product-rating"><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg> (156)</div>
                        <button class="btn btn-secondary btn-small">Add to Cart</button>
                    </div>
                </div>

                <div class="product-card" onclick="showProductDetails('angel-rinse')">
                    <img src="https://www.flirthair.co.za/wp-content/uploads/2022/03/KEVIN-MURPHY-01-300x300.png" alt="Angel Rinse" class="product-image">
                    <div class="product-info">
                        <div class="product-name">Angel.Rinse</div>
                        <div class="product-description">Volumizing conditioner</div>
                        <div class="product-price">R385</div>
                        <div class="product-rating"><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg> (142)</div>
                        <button class="btn btn-secondary btn-small">Add to Cart</button>
                    </div>
                </div>

                <div class="product-card" onclick="showProductDetails('bedroom-hair')">
                    <img src="https://www.flirthair.co.za/wp-content/uploads/2022/03/KEVIN-MURPHY-09-300x300.png" alt="Bedroom Hair" class="product-image">
                    <div class="product-info">
                        <div class="product-name">Bedroom.Hair</div>
                        <div class="product-description">Flexible texturizing spray</div>
                        <div class="product-price">R420</div>
                        <div class="product-rating"><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg> (203)</div>
                        <button class="btn btn-secondary btn-small">Add to Cart</button>
                    </div>
                </div>

                <div class="product-card" onclick="showProductDetails('plumping-wash')">
                    <img src="https://www.flirthair.co.za/wp-content/uploads/2023/03/KMU249_PLUMPING.WASH_250ml-03-300x300.png" alt="Plumping Wash" class="product-image">
                    <div class="product-info">
                        <div class="product-name">Plumping.Wash</div>
                        <div class="product-description">Densifying shampoo</div>
                        <div class="product-price">R385</div>
                        <div class="product-rating"><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg> (178)</div>
                        <button class="btn btn-secondary btn-small">Add to Cart</button>
                    </div>
                </div>

                <div class="product-card" onclick="showProductDetails('session-spray')">
                    <img src="https://www.flirthair.co.za/wp-content/uploads/2023/03/KMU491_SESSION.SPRAY_FLEX_400ML_EU-02-300x300.png" alt="Session Spray" class="product-image">
                    <div class="product-info">
                        <div class="product-name">Session.Spray Flex</div>
                        <div class="product-description">Flexible hold spray</div>
                        <div class="product-price">R510</div>
                        <div class="product-rating"><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg> (189)</div>
                        <button class="btn btn-secondary btn-small">Add to Cart</button>
                    </div>
                </div>

                <div class="product-card" onclick="showProductDetails('stimulate-wash')">
                    <img src="https://www.flirthair.co.za/wp-content/uploads/2023/03/KMU291_STIMULATE-ME.WASH_250ml-03-300x300.png" alt="Stimulate Me Wash" class="product-image">
                    <div class="product-info">
                        <div class="product-name">Stimulate-Me.Wash</div>
                        <div class="product-description">Stimulating shampoo</div>
                        <div class="product-price">R385</div>
                        <div class="product-rating"><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg><svg viewBox="0 0 24 24"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg> (134)</div>
                        <button class="btn btn-secondary btn-small">Add to Cart</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Rewards Content -->
        <div id="rewards" class="content-area">
            <h2 id="rewardsTitle" class="section-title" style="margin-bottom: 20px;">Rewards & Referrals</h2>

            <div class="referral-code-box">
                <div>Your Referral Code</div>
                <div class="referral-code" id="referralCodeDisplay"></div>
                <div id="referralSubheading" style="font-size: 14px; margin-top: 10px;">
                    Share with friends and you both save!
                </div>
                <div class="share-buttons">
                    <button class="share-btn" onclick="shareReferral('whatsapp')"></button>
                    <button class="share-btn" onclick="shareReferral('instagram')"></button>
                    <button class="share-btn" onclick="shareReferral('facebook')"></button>
                    <button class="share-btn" onclick="copyReferralCode()"></button>
                </div>
            </div>

            <div class="referral-stats">
                <div class="stat-card">
                    <div class="stat-number" id="referralCount">0</div>
                    <div class="stat-label">Referrals</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="referralEarned">R0</div>
                    <div class="stat-label">Earned</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="userPoints">0</div>
                    <div class="stat-label">Points</div>
                </div>
            </div>

            <div class="section-header" style="margin-top: 30px;">
                <h3 class="section-title">Loyalty Tiers</h3>
            </div>

            <div class="card" id="loyaltyTierCard">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                    <div>
                        <strong style="color: var(--brand-pink);" id="userTierName"> Bronze Tier</strong>
                        <div style="font-size: 14px; color: var(--gray-medium);" id="userTierProgress">Loading...</div>
                    </div>
                    <div style="font-size: 12px; color: var(--gray-medium);" id="userTierLevel">Level 1 of 4</div>
                </div>
                <div style="background: var(--gray-light); height: 10px; border-radius: 10px; overflow: hidden;">
                    <div id="tierProgressBar" style="background: linear-gradient(90deg, var(--brand-pink-dark), var(--brand-pink)); height: 100%; width: 0%; transition: width 0.5s;"></div>
                </div>

                <div style="margin-top: 20px;">
                    <strong>Your Perks:</strong>
                    <ul id="tierPerksList" style="margin-top: 10px; padding-left: 20px;">
                        <li>Earn points on every visit</li>
                        <li>Birthday surprise</li>
                    </ul>
                </div>
            </div>

            <div class="section-header" style="margin-top: 30px;">
                <h3 class="section-title">Ways to Earn Points</h3>
            </div>

            <div class="card" id="earnRulesContainer">
                <!-- Dynamically populated from config -->
                <div style="text-align: center; padding: 20px; color: var(--gray-medium);">
                    Loading earn rules...
                </div>
            </div>

            <button class="btn btn-primary" onclick="showRedeemOptions()">Redeem Points</button>
        </div>

        <!-- Team Content -->
        <div id="team" class="content-area">
            <h2 class="section-title" style="margin-bottom: 10px;">Meet Our Dream Team</h2>
            <p style="color: var(--gray-medium); margin-bottom: 25px;">The talented stylists who'll make your hair goals a reality</p>

            <div class="team-grid">
                <!-- Lisa Thompson -->
                <div class="team-card">
                    <img src="https://www.flirthair.co.za/wp-content/uploads/2022/03/home-footer-images1.jpg" alt="Lisa Thompson" class="team-photo">
                    <div class="team-info">
                        <div class="team-avatar-overlay" style="background: linear-gradient(135deg, #F67599 0%, #e05a7f 100%);">L</div>
                        <div class="team-name">Lisa Thompson</div>
                        <div class="team-role">Senior Stylist</div>
                        <div class="team-tagline">"Your hair is your crown - let's make it royal! I believe every strand tells a story."</div>
                        <div class="team-specialties">
                            <span class="team-specialty-tag">Tape Extensions</span>
                            <span class="team-specialty-tag">Weft Master</span>
                            <span class="team-specialty-tag">Bridal</span>
                        </div>
                        <div class="team-stats">
                            <div class="team-stat">
                                <div class="team-stat-value">8</div>
                                <div class="team-stat-label">Years Exp</div>
                            </div>
                            <div class="team-stat">
                                <div class="team-stat-value">4.9</div>
                                <div class="team-stat-label">Rating</div>
                            </div>
                            <div class="team-stat">
                                <div class="team-stat-value">127</div>
                                <div class="team-stat-label">Reviews</div>
                            </div>
                        </div>
                        <div class="team-socials">
                            <button class="team-social-btn" onclick="openStylistInsta('lisa')"></button>
                            <button class="team-social-btn" onclick="bookWithStylist('lisa')"></button>
                            <button class="team-social-btn" onclick="chatWithStylist('lisa')"></button>
                        </div>
                    </div>
                </div>

                <!-- Emma Williams -->
                <div class="team-card">
                    <img src="https://images.unsplash.com/photo-1580618672591-eb180b1a973f?w=400&h=350&fit=crop" alt="Emma Williams" class="team-photo">
                    <div class="team-info">
                        <div class="team-avatar-overlay" style="background: linear-gradient(135deg, var(--brand-pink) 0%, var(--brand-pink-dark) 100%);">E</div>
                        <div class="team-name">Emma Williams</div>
                        <div class="team-role">Extension Specialist</div>
                        <div class="team-tagline">"Obsessed with creating that 'wow' moment when you see your transformation! Volume is my love language."</div>
                        <div class="team-specialties">
                            <span class="team-specialty-tag">Keratin Bonds</span>
                            <span class="team-specialty-tag">Volume Queen</span>
                            <span class="team-specialty-tag">Repairs</span>
                        </div>
                        <div class="team-stats">
                            <div class="team-stat">
                                <div class="team-stat-value">6</div>
                                <div class="team-stat-label">Years Exp</div>
                            </div>
                            <div class="team-stat">
                                <div class="team-stat-value">4.8</div>
                                <div class="team-stat-label">Rating</div>
                            </div>
                            <div class="team-stat">
                                <div class="team-stat-value">94</div>
                                <div class="team-stat-label">Reviews</div>
                            </div>
                        </div>
                        <div class="team-socials">
                            <button class="team-social-btn" onclick="openStylistInsta('emma')"></button>
                            <button class="team-social-btn" onclick="bookWithStylist('emma')"></button>
                            <button class="team-social-btn" onclick="chatWithStylist('emma')"></button>
                        </div>
                    </div>
                </div>

                <!-- Sarah Martinez -->
                <div class="team-card">
                    <img src="https://images.unsplash.com/photo-1522337360788-8b13dee7a37e?w=400&h=350&fit=crop" alt="Sarah Martinez" class="team-photo">
                    <div class="team-info">
                        <div class="team-avatar-overlay" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">S</div>
                        <div class="team-name">Sarah Martinez</div>
                        <div class="team-role">Color Expert</div>
                        <div class="team-tagline">"Matching hair color is an art form - and honey, I'm Picasso! Let's find YOUR perfect shade."</div>
                        <div class="team-specialties">
                            <span class="team-specialty-tag">Color Match Pro</span>
                            <span class="team-specialty-tag">Balayage</span>
                            <span class="team-specialty-tag">Blonding</span>
                        </div>
                        <div class="team-stats">
                            <div class="team-stat">
                                <div class="team-stat-value">10</div>
                                <div class="team-stat-label">Years Exp</div>
                            </div>
                            <div class="team-stat">
                                <div class="team-stat-value">5.0</div>
                                <div class="team-stat-label">Rating</div>
                            </div>
                            <div class="team-stat">
                                <div class="team-stat-value">203</div>
                                <div class="team-stat-label">Reviews</div>
                            </div>
                        </div>
                        <div class="team-socials">
                            <button class="team-social-btn" onclick="openStylistInsta('sarah')"></button>
                            <button class="team-social-btn" onclick="bookWithStylist('sarah')"></button>
                            <button class="team-social-btn" onclick="chatWithStylist('sarah')"></button>
                        </div>
                    </div>
                </div>

                <!-- Maya Johnson -->
                <div class="team-card">
                    <img src="https://images.unsplash.com/photo-1560066984-138dadb4c035?w=400&h=350&fit=crop" alt="Maya Johnson" class="team-photo">
                    <div class="team-info">
                        <div class="team-avatar-overlay" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">M</div>
                        <div class="team-name">Maya Johnson</div>
                        <div class="team-role">Maintenance Expert</div>
                        <div class="team-tagline">"I'll keep your extensions looking fresh and fabulous! Think of me as your hair's bestie."</div>
                        <div class="team-specialties">
                            <span class="team-specialty-tag">Maintenance</span>
                            <span class="team-specialty-tag">Repairs</span>
                            <span class="team-specialty-tag">Hair Care</span>
                        </div>
                        <div class="team-stats">
                            <div class="team-stat">
                                <div class="team-stat-value">5</div>
                                <div class="team-stat-label">Years Exp</div>
                            </div>
                            <div class="team-stat">
                                <div class="team-stat-value">4.9</div>
                                <div class="team-stat-label">Rating</div>
                            </div>
                            <div class="team-stat">
                                <div class="team-stat-value">156</div>
                                <div class="team-stat-label">Reviews</div>
                            </div>
                        </div>
                        <div class="team-socials">
                            <button class="team-social-btn" onclick="openStylistInsta('maya')"></button>
                            <button class="team-social-btn" onclick="bookWithStylist('maya')"></button>
                            <button class="team-social-btn" onclick="chatWithStylist('maya')"></button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Photo Upload Section for Inspo -->
            <div class="section-header" style="margin-top: 30px;">
                <h3 class="section-title">Share Your Hair Inspiration</h3>
            </div>

            <div class="photo-upload-section" onclick="openPhotoUpload()">
                <div class="upload-icon"></div>
                <div class="upload-title">Upload Your Inspo Photos</div>
                <div class="upload-subtitle">Share photos of your current hair or dream hairstyles with your stylist</div>
                <button class="btn btn-secondary btn-small" style="width: auto;">Choose Photos</button>
            </div>

            <div class="section-header">
                <h3 class="section-title">Your Uploaded Inspo</h3>
            </div>

            <div class="inspo-gallery" id="inspoGallery">
                <div class="inspo-item">
                        <img src="https://www.flirthair.co.za/wp-content/uploads/2022/03/home-footer-images1.jpg" alt="Inspo 1">
                    <div class="inspo-item-overlay">
                        <span class="inspo-label">Dream Length</span>
                    </div>
                </div>
                <div class="inspo-item">
                        <img src="https://www.flirthair.co.za/wp-content/uploads/2022/03/home-footer-images2.jpg" alt="Inspo 2">
                    <div class="inspo-item-overlay">
                        <span class="inspo-label">Color Goals</span>
                    </div>
                </div>
                <div class="inspo-item">
                        <img src="https://www.flirthair.co.za/wp-content/uploads/2022/03/categories1.jpg" alt="Inspo 3">
                    <div class="inspo-item-overlay">
                        <span class="inspo-label">Volume Vibes</span>
                    </div>
                </div>
                <div class="inspo-item" style="background: var(--gray-light); display: flex; align-items: center; justify-content: center; font-size: 30px;" onclick="openPhotoUpload()">
                    
                </div>
            </div>
        </div>

        <!-- Hair Tracker Content -->
        <div id="tracker" class="content-area">
            <h2 id="trackerTitle" class="section-title" style="margin-bottom: 20px;">Hair Care Journey</h2>
            <p id="trackerSubtitle" style="text-align: center; color: var(--gray-medium); margin-bottom: 20px; display: none;"></p>

            <!-- Setup prompt (shown when no tracker data) -->
            <div id="trackerSetupPrompt" class="card" style="text-align: center; padding: 30px; display: none;">
                <div style="font-size: 60px; margin-bottom: 15px;"></div>
                <h3 style="margin-bottom: 10px;">Set Up Your Hair Tracker</h3>
                <p id="trackerNoInstallMessage" style="color: var(--gray-medium); margin-bottom: 20px;">
                    Set up your hair tracker to get personalized care recommendations!
                </p>
                <button id="trackerSetupBtn" class="btn btn-primary" onclick="showTrackerSetupModal()">Set Up Tracker</button>
            </div>

            <!-- Main tracker content (shown when tracker is set up) -->
            <div id="trackerMainContent" style="display: none;">
                <div class="tracker-progress">
                    <div class="progress-circle" id="trackerProgressCircle">
                        <div class="progress-text">
                            <div class="progress-days" id="trackerDays"></div>
                            <div class="progress-label">Days</div>
                        </div>
                    </div>
                    <div style="text-align: center; color: var(--gray-medium);">
                        Since last installation
                    </div>
                    <div id="trackerExtensionType" style="text-align: center; color: var(--brand-pink); font-weight: 500; margin-top: 5px;"></div>
                </div>

                <div class="tracker-stats">
                    <div class="tracker-stat">
                        <div id="trackerWashes" style="font-size: 24px; font-weight: bold;">0</div>
                        <div style="font-size: 14px; color: var(--gray-medium);">Washes</div>
                    </div>
                    <div class="tracker-stat">
                        <div id="trackerDaysUntilMaintenance" style="font-size: 24px; font-weight: bold;"></div>
                        <div style="font-size: 14px; color: var(--gray-medium);">Days until maintenance</div>
                    </div>
                    <div class="tracker-stat">
                        <div id="trackerHealthScore" style="font-size: 24px; font-weight: bold;"></div>
                        <div style="font-size: 14px; color: var(--gray-medium);">Hair health score</div>
                    </div>
                    <div class="tracker-stat">
                        <div id="trackerProductsUsed" style="font-size: 24px; font-weight: bold;">0</div>
                        <div style="font-size: 14px; color: var(--gray-medium);">Products used</div>
                    </div>
                </div>

                <div class="section-header" style="margin-top: 30px;">
                    <h3 class="section-title">Care Schedule</h3>
                </div>

                <div class="card">
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                        <div style="font-size: 30px;"></div>
                        <div style="flex: 1;">
                            <strong id="trackerNextWashTitle">Next Wash Day</strong>
                            <div id="trackerNextWashLabel" style="color: var(--gray-medium); font-size: 14px;">Based on your routine</div>
                        </div>
                        <button class="btn btn-small btn-outline" onclick="logWash()">Log Wash</button>
                    </div>
                    <div style="display: flex; align-items: center; gap: 15px; margin-bottom: 15px;">
                        <div style="font-size: 30px;"></div>
                        <div style="flex: 1;">
                            <strong id="trackerMaintenanceTitle">Maintenance Due</strong>
                            <div id="trackerMaintenanceLabel" style="color: var(--gray-medium); font-size: 14px;"></div>
                        </div>
                        <button class="btn btn-small btn-secondary" onclick="bookMaintenance()">Book Now</button>
                    </div>
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <div style="font-size: 30px;"></div>
                        <div style="flex: 1;">
                            <strong id="trackerDeepConditionTitle">Deep Condition</strong>
                            <div id="trackerDeepConditionLabel" style="color: var(--gray-medium); font-size: 14px;">Every 2 weeks</div>
                        </div>
                        <button class="btn btn-small btn-outline" onclick="logDeepCondition()">Done</button>
                    </div>
                </div>

                <div class="section-header" style="margin-top: 30px;">
                    <h3 class="section-title">Progress Photos</h3>
                </div>

                <div class="gallery-grid" id="trackerPhotosGrid">
                    <div style="aspect-ratio: 1; background: var(--gray-light); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-size: 40px; cursor: pointer;" onclick="addProgressPhoto()"></div>
                </div>

                <div class="section-header" style="margin-top: 30px;">
                    <h3 class="section-title">Care Tips for You</h3>
                </div>

                <div class="card" id="trackerTipsCard">
                    <strong style="display: flex; align-items: center; gap: 8px;"><svg viewBox="0 0 24 24" fill="none" stroke="#F67599" stroke-width="2" width="18" height="18"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M15.09 14c.18-.98.65-1.74 1.41-2.5A4.65 4.65 0 0 0 18 8 6 6 0 0 0 6 8c0 1 .23 2.23 1.5 3.5A4.61 4.61 0 0 1 8.91 14"/></svg>Personalized Recommendations</strong>
                    <ul id="trackerTipsList" style="margin-top: 10px; padding-left: 20px; color: var(--gray-medium);">
                        <li>Loading tips...</li>
                    </ul>
                </div>

                <!-- Edit tracker button -->
                <button class="btn btn-outline" style="margin-top: 20px; width: 100%;" onclick="showTrackerSetupModal()">
                    Edit Tracker Settings
                </button>
            </div>
        </div>

        <!-- Tracker Setup Modal -->
        <div id="trackerSetupModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Set Up Hair Tracker</h3>
                    <button class="close-btn" onclick="closeModal('trackerSetupModal')">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label>Extension Type</label>
                        <select id="trackerExtensionTypeSelect" class="form-input">
                            <option value="">Select extension type...</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Last Installation Date</label>
                        <input type="date" id="trackerInstallDate" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>Last Wash Date (optional)</label>
                        <input type="date" id="trackerLastWashDate" class="form-input">
                    </div>
                    <div class="form-group">
                        <label>Last Deep Condition Date (optional)</label>
                        <input type="date" id="trackerLastDeepConditionDate" class="form-input">
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-outline" onclick="closeModal('trackerSetupModal')">Cancel</button>
                    <button class="btn btn-primary" onclick="saveTrackerSetup()">Save</button>
                </div>
            </div>
        </div>

        <!-- Profile Content -->
        <div id="profile" class="content-area">
            <div class="profile-header">
                <div class="profile-avatar" id="profileAvatar">?</div>
                <div class="profile-name" id="profileName">Guest</div>
                <div class="profile-tier" id="profileTier" style="display: flex; align-items: center; justify-content: center; gap: 6px;"><svg viewBox="0 0 24 24" fill="#F67599" width="16" height="16"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg> <span id="profileTierText">Sign in to unlock rewards</span></div>
            </div>

            <ul class="menu-list">
                <li class="menu-item" onclick="editProfile()">
                    <div class="menu-item-content">
                        <span class="menu-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="24" height="24">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                        </span>
                        <span class="menu-text">Edit Profile</span>
                    </div>
                    <span></span>
                </li>
                <li class="menu-item" onclick="viewAppointments()">
                    <div class="menu-item-content">
                        <span class="menu-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="24" height="24">
                                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                <line x1="16" y1="2" x2="16" y2="6"></line>
                                <line x1="8" y1="2" x2="8" y2="6"></line>
                                <line x1="3" y1="10" x2="21" y2="10"></line>
                            </svg>
                        </span>
                        <span class="menu-text">My Appointments</span>
                    </div>
                    <span></span>
                </li>
                <li class="menu-item" onclick="viewOrders()">
                    <div class="menu-item-content">
                        <span class="menu-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="24" height="24">
                                <line x1="16.5" y1="9.4" x2="7.5" y2="4.21"></line>
                                <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                                <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                                <line x1="12" y1="22.08" x2="12" y2="12"></line>
                            </svg>
                        </span>
                        <span class="menu-text">Order History</span>
                    </div>
                    <span></span>
                </li>
                <li class="menu-item" onclick="viewPayments()">
                    <div class="menu-item-content">
                        <span class="menu-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="24" height="24">
                                <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
                                <line x1="1" y1="10" x2="23" y2="10"></line>
                            </svg>
                        </span>
                        <span class="menu-text">Payment Methods</span>
                    </div>
                    <span></span>
                </li>
                <li class="menu-item" onclick="hairProfile()">
                    <div class="menu-item-content">
                        <span class="menu-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="24" height="24">
                                <path d="M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3z"></path>
                                <path d="M12 12v10"></path>
                                <path d="M7 17c0-1.5 1-3 3-3s3 1.5 3 3"></path>
                                <path d="M12 22c-3 0-5-2-5-5"></path>
                                <path d="M12 22c3 0 5-2 5-5"></path>
                            </svg>
                        </span>
                        <span class="menu-text">Hair Profile</span>
                    </div>
                    <span></span>
                </li>
                <li class="menu-item" onclick="notificationSettings()">
                    <div class="menu-item-content">
                        <span class="menu-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="24" height="24">
                                <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                                <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                            </svg>
                        </span>
                        <span class="menu-text">Notifications</span>
                    </div>
                    <span></span>
                </li>
                <li class="menu-item" onclick="helpCenter()">
                    <div class="menu-item-content">
                        <span class="menu-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="24" height="24">
                                <circle cx="12" cy="12" r="10"></circle>
                                <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                <line x1="12" y1="17" x2="12.01" y2="17"></line>
                            </svg>
                        </span>
                        <span class="menu-text">Help Center</span>
                    </div>
                    <span></span>
                </li>
                <li class="menu-item" onclick="settings()">
                    <div class="menu-item-content">
                        <span class="menu-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="24" height="24">
                                <circle cx="12" cy="12" r="3"></circle>
                                <path d="M12 1v6m0 6v6m5.5-13v6m0 6v6m5.5-13v6m0 6v6"></path>
                                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
                            </svg>
                        </span>
                        <span class="menu-text">Settings</span>
                    </div>
                    <span></span>
                </li>
            </ul>

            <button class="btn btn-outline" style="margin-top: 20px;" onclick="logout()">Logout</button>
        </div>
    </div>

    <!-- Modals -->
    <div id="notificationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Notifications</h3>
                <button class="close-btn" onclick="closeModal('notificationModal')">&times;</button>
            </div>

            <div class="notification-item">
                <div class="notification-header">
                    <div class="notification-title"> Special Offer!</div>
                    <div class="notification-time">2h ago</div>
                </div>
                <div class="notification-message">30% off tape extensions this week only!</div>
            </div>

            <div class="notification-item">
                <div class="notification-header">
                    <div class="notification-title"> Appointment Reminder</div>
                    <div class="notification-time">5h ago</div>
                </div>
                <div class="notification-message">Your appointment is tomorrow at 10:00 AM with Lisa</div>
            </div>

            <div class="notification-item">
                <div class="notification-header">
                    <div class="notification-title" style="display: flex; align-items: center; gap: 6px;"><svg viewBox="0 0 24 24" fill="#F67599" width="14" height="14"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg> Points Earned!</div>
                    <div class="notification-time">1d ago</div>
                </div>
                <div class="notification-message">You earned 50 points for your last booking!</div>
            </div>
        </div>
    </div>

    <!-- Cart Overlay & Modal -->
    <div class="cart-overlay" id="cartOverlay" onclick="closeCart()"></div>
    <div class="cart-modal" id="cartModal">
        <div class="cart-header">
            <h3>Shopping Cart</h3>
            <button class="close-btn" onclick="closeCart()" style="color: white;">&times;</button>
        </div>
        <div class="cart-items" id="cartItems">
            <!-- Cart items will be added dynamically -->
            <div class="cart-item">
                <img src="https://www.flirthair.co.za/wp-content/uploads/2022/03/KEVIN-MURPHY-Angel-300x300.png" class="cart-item-image" alt="Angel Wash">
                <div class="cart-item-details">
                    <div class="cart-item-name">Angel.Wash</div>
                    <div class="cart-item-price">R385</div>
                    <div class="quantity-control">
                        <button class="qty-btn" onclick="updateQty('angel-wash', -1)">-</button>
                        <span id="qty-angel-wash">1</span>
                        <button class="qty-btn" onclick="updateQty('angel-wash', 1)">+</button>
                        <button style="background: none; border: none; color: #ff6b6b; cursor: pointer; margin-left: 10px;" onclick="removeFromCart('angel-wash')">Remove</button>
                    </div>
                </div>
            </div>
            <div class="cart-item">
                <img src="https://www.flirthair.co.za/wp-content/uploads/2022/03/KEVIN-MURPHY-09-300x300.png" class="cart-item-image" alt="Bedroom Hair">
                <div class="cart-item-details">
                    <div class="cart-item-name">Bedroom.Hair</div>
                    <div class="cart-item-price">R420</div>
                    <div class="quantity-control">
                        <button class="qty-btn" onclick="updateQty('bedroom-hair', -1)">-</button>
                        <span id="qty-bedroom-hair">1</span>
                        <button class="qty-btn" onclick="updateQty('bedroom-hair', 1)">+</button>
                        <button style="background: none; border: none; color: #ff6b6b; cursor: pointer; margin-left: 10px;" onclick="removeFromCart('bedroom-hair')">Remove</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="cart-footer">
            <div class="cart-subtotal">
                <span>Subtotal</span>
                <span id="cartSubtotal">R805</span>
            </div>
            <div class="cart-subtotal">
                <span>Delivery</span>
                <span id="cartDelivery">Calculated at checkout</span>
            </div>
            <div class="cart-total">
                <span>Total</span>
                <span id="cartTotal">R805</span>
            </div>
            <button class="btn btn-primary" onclick="openCheckout()">Proceed to Checkout</button>
            <button class="btn btn-outline" onclick="closeCart()">Continue Shopping</button>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div id="checkoutModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h3 class="modal-title">Checkout</h3>
                <button class="close-btn" onclick="closeModal('checkoutModal')">&times;</button>
            </div>

            <div class="checkout-section">
                <div class="checkout-section-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18" style="vertical-align: middle; margin-right: 6px;">
                        <rect x="1" y="3" width="15" height="13"></rect>
                        <polygon points="16 8 20 8 23 11 23 16 16 16 16 8"></polygon>
                        <circle cx="5.5" cy="18.5" r="2.5"></circle>
                        <circle cx="18.5" cy="18.5" r="2.5"></circle>
                    </svg>
                    Delivery Method
                </div>
                <div class="delivery-options">
                    <div class="delivery-option selected" data-method="pickup" onclick="selectDelivery(this, 'pickup', 0)">
                        <div class="delivery-info">
                            <h4>Collect from Salon</h4>
                            <p>Ready in 24 hours - Free pickup at Flirt Hair salon</p>
                        </div>
                        <div class="delivery-price">FREE</div>
                    </div>
                    <div class="delivery-option" data-method="standard" onclick="selectDelivery(this, 'standard', 65)">
                        <div class="delivery-info">
                            <h4>Standard Courier</h4>
                            <p>3-5 business days delivery</p>
                        </div>
                        <div class="delivery-price">R65</div>
                    </div>
                    <div class="delivery-option" data-method="express" onclick="selectDelivery(this, 'express', 120)">
                        <div class="delivery-info">
                            <h4>Express Courier</h4>
                            <p>Next day delivery (order before 2pm)</p>
                        </div>
                        <div class="delivery-price">R120</div>
                    </div>
                </div>
            </div>

            <div class="checkout-section" id="deliveryAddressSection" style="display: none;">
                <div class="checkout-section-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18" style="vertical-align: middle; margin-right: 6px;">
                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                        <circle cx="12" cy="10" r="3"></circle>
                    </svg>
                    Delivery Address
                </div>
                <div class="form-group">
                    <label class="form-label">Street Address *</label>
                    <input type="text" id="deliveryStreet" class="form-input" placeholder="123 Main Street" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Suburb / Area</label>
                    <input type="text" id="deliverySuburb" class="form-input" placeholder="Gardens">
                </div>
                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 15px;">
                    <div class="form-group">
                        <label class="form-label">City *</label>
                        <input type="text" id="deliveryCity" class="form-input" placeholder="Cape Town" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Postal Code *</label>
                        <input type="text" id="deliveryPostalCode" class="form-input" placeholder="8001" required>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Delivery Instructions (optional)</label>
                    <textarea id="deliveryInstructions" class="form-input" rows="2" placeholder="Gate code, building name, etc."></textarea>
                </div>
            </div>

            <div class="checkout-section">
                <div class="checkout-section-title"> Promo Code</div>
                <div style="display: flex; gap: 10px;">
                    <input type="text" class="form-input" id="promoCode" placeholder="Enter promo code" style="flex: 1;">
                    <button class="btn btn-outline btn-small" onclick="applyPromo()">Apply</button>
                </div>
                <div id="promoMessage" style="margin-top: 10px; color: var(--success); font-size: 14px;"></div>
            </div>

            <div class="checkout-section">
                <div class="checkout-section-title"> Order Summary</div>
                <div class="invoice-preview">
                    <div class="invoice-row">
                        <span>Angel.Wash x 1</span>
                        <span>R385</span>
                    </div>
                    <div class="invoice-row">
                        <span>Bedroom.Hair x 1</span>
                        <span>R420</span>
                    </div>
                    <div class="invoice-row">
                        <span>Subtotal</span>
                        <span>R805</span>
                    </div>
                    <div class="invoice-row">
                        <span>Delivery</span>
                        <span id="invoiceDelivery">FREE</span>
                    </div>
                    <div class="invoice-row" id="discountRow" style="display: none; color: var(--success);">
                        <span>Discount</span>
                        <span id="invoiceDiscount">-R0</span>
                    </div>
                    <div class="invoice-row">
                        <span>Total</span>
                        <span id="invoiceTotal">R805</span>
                    </div>
                </div>
            </div>

            <button class="btn btn-primary" onclick="processPayment()">Pay Now - R<span id="payAmount">805</span></button>
        </div>
    </div>

    <!-- Photo Upload Modal -->
    <div id="photoUploadModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Upload Hair Inspo</h3>
                <button class="close-btn" onclick="closeModal('photoUploadModal')">&times;</button>
            </div>

            <div class="photo-upload-section" onclick="triggerFileUpload()">
                <div class="upload-icon"></div>
                <div class="upload-title">Choose Photos</div>
                <div class="upload-subtitle">Upload photos of your current hair or dream hairstyles</div>
                <input type="file" id="photoInput" multiple accept="image/*" style="display: none;" onchange="handlePhotoUpload(event)">
            </div>

            <div id="uploadPreviewContainer" class="upload-preview"></div>

            <div class="form-group">
                <label class="form-label">Add a note for your stylist</label>
                <textarea class="form-input" rows="3" placeholder="e.g., 'I love this length!' or 'Can we achieve this color?'"></textarea>
            </div>

            <button class="btn btn-primary" onclick="saveInspoPhotos()">Save to My Inspo Board</button>
        </div>
    </div>

    <!-- Auth Modal -->
    <div id="authModal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h3 class="modal-title">Welcome to Flirt</h3>
                <button class="close-btn" onclick="closeModal('authModal')">&times;</button>
            </div>

            <div class="auth-tabs">
                <button class="auth-tab active" onclick="switchAuthTab('login')">Login</button>
                <button class="auth-tab" onclick="switchAuthTab('signup')">Sign Up</button>
            </div>

            <!-- Social Login Buttons -->
            <div class="social-auth">
                <button class="social-btn social-google" onclick="startGoogleLogin()">
                    <svg class="social-icon" viewBox="0 0 24 24" width="20" height="20">
                        <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                        <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                        <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                        <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                    </svg>
                    Continue with Google
                </button>
                <button class="social-btn social-facebook" onclick="startFacebookLogin()">
                    <svg class="social-icon" viewBox="0 0 24 24" width="20" height="20" fill="#1877F2">
                        <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                    </svg>
                    Continue with Facebook
                </button>
            </div>

            <div class="social-divider">
                <span>or</span>
            </div>

            <div id="authError" class="auth-error"></div>

            <!-- Login Form -->
            <div id="loginForm" class="auth-form active">
                <form id="loginFormElement" onsubmit="handleLogin(event)">
                    <input type="email" id="loginEmail" class="auth-input" placeholder="Email address" autocomplete="email">
                    <input type="password" id="loginPassword" class="auth-input" placeholder="Password" autocomplete="current-password">
                    <button type="submit" class="auth-btn" id="loginBtn">Login</button>
                </form>
            </div>

            <!-- Signup Form -->
            <div id="signupForm" class="auth-form">
                <form id="signupFormElement" onsubmit="handleSignup(event)">
                    <input type="text" id="signupName" class="auth-input" placeholder="Full name" autocomplete="name">
                    <input type="email" id="signupEmail" class="auth-input" placeholder="Email address" autocomplete="email">
                    <input type="tel" id="signupPhone" class="auth-input" placeholder="Phone number (optional)" autocomplete="tel">
                    <input type="password" id="signupPassword" class="auth-input" placeholder="Password (min 6 characters)" autocomplete="new-password">
                    <input type="password" id="signupPasswordConfirm" class="auth-input" placeholder="Confirm password" autocomplete="new-password">
                    <input type="text" id="signupReferral" class="auth-input" placeholder="Referral code (optional)">
                    <button type="submit" class="auth-btn" id="signupBtn">Create Account</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Chat Window -->
    <button class="chat-fab" id="chatFab" onclick="toggleChat()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
        </svg>
        <span class="chat-notification">1</span>
    </button>

    <div class="chat-window" id="chatWindow">
        <div class="chat-header">
            <div class="chat-header-info">
                <div class="chat-avatar"></div>
                <div>
                    <strong>Flirt Hair Support</strong>
                    <div class="chat-status">Online now</div>
                </div>
            </div>
            <button class="close-btn" onclick="toggleChat()" style="color: white;">&times;</button>
        </div>
        <div class="chat-messages" id="chatMessages">
            <div class="chat-message received">
                <div class="message-bubble">
                    Hey gorgeous!  Welcome to Flirt Hair! How can I help you with your hair journey today?
                </div>
                <div class="message-time">Just now</div>
            </div>
        </div>
        <div class="chat-input-area">
            <input type="text" class="chat-input" id="chatInput" placeholder="Type a message..." onkeypress="handleChatKeypress(event)">
            <button class="chat-send-btn" onclick="sendChatMessage()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="20" height="20">
                    <line x1="22" y1="2" x2="11" y2="13"></line>
                    <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                </svg>
            </button>
        </div>
    </div>

    <!-- Edit Profile Modal -->
    <div class="modal" id="editProfileModal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h3 class="modal-title">Edit Profile</h3>
                <button class="modal-close" onclick="closeEditProfileModal()">&times;</button>
            </div>
            <div class="modal-body" style="padding: 20px;">
                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--gray-dark);">Full Name</label>
                    <input type="text" id="editProfileName" class="form-input" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px;" placeholder="Your name">
                </div>
                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--gray-dark);">Phone Number</label>
                    <input type="tel" id="editProfilePhone" class="form-input" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px;" placeholder="+27 82 123 4567">
                </div>
                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--gray-dark);">Email (read-only)</label>
                    <input type="email" id="editProfileEmail" class="form-input" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px; background: #f5f5f5;" readonly>
                </div>
                <div id="editProfileError" style="color: #e74c3c; font-size: 14px; margin-bottom: 15px; display: none;"></div>
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-outline" onclick="closeEditProfileModal()" style="flex: 1;">Cancel</button>
                    <button class="btn btn-primary" onclick="saveProfile()" style="flex: 1; background: var(--brand-pink);">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- My Appointments Modal -->
    <div class="modal" id="appointmentsModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3 class="modal-title">My Appointments</h3>
                <button class="modal-close" onclick="closeAppointmentsModal()">&times;</button>
            </div>
            <div class="modal-body" id="appointmentsModalBody" style="padding: 20px; max-height: 400px; overflow-y: auto;">
                <!-- Appointments will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Order History Modal -->
    <div class="modal" id="ordersModal">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3 class="modal-title">Order History</h3>
                <button class="modal-close" onclick="closeOrdersModal()">&times;</button>
            </div>
            <div class="modal-body" id="ordersModalBody" style="padding: 20px; max-height: 400px; overflow-y: auto;">
                <!-- Orders will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Hair Profile Modal -->
    <div class="modal" id="hairProfileModal">
        <div class="modal-content" style="max-width: 450px;">
            <div class="modal-header">
                <h3 class="modal-title">Hair Profile</h3>
                <button class="modal-close" onclick="closeHairProfileModal()">&times;</button>
            </div>
            <div class="modal-body" style="padding: 20px;">
                <p style="color: #666; margin-bottom: 20px; font-size: 14px;">Help us personalize your experience by telling us about your hair.</p>
                <div id="hairProfileLoading" style="display: none; align-items: center; gap: 10px; color: var(--gray-medium); font-size: 14px; margin-bottom: 15px;">
                    <span class="loading-spinner"></span>
                    <span>Loading your hair profile...</span>
                </div>
                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--gray-dark);">Hair Type</label>
                    <select id="hairProfileType" class="form-input" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px;">
                        <option value="">Select hair type...</option>
                        <option value="straight">Straight</option>
                        <option value="wavy">Wavy</option>
                        <option value="curly">Curly</option>
                        <option value="coily">Coily</option>
                    </select>
                </div>
                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--gray-dark);">Extension Type</label>
                    <select id="hairProfileExtension" class="form-input" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px;">
                        <option value="">Select extension type...</option>
                        <option value="tape">Tape Extensions</option>
                        <option value="weft">Weft Extensions</option>
                        <option value="keratin">Keratin Bonds</option>
                        <option value="clip-in">Clip-In Extensions</option>
                        <option value="ponytail">Ponytails</option>
                        <option value="none">No Extensions Yet</option>
                    </select>
                </div>
                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--gray-dark);">Preferred Stylist</label>
                    <select id="hairProfileStylist" class="form-input" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px;">
                        <option value="">No preference</option>
                        <!-- Stylists will be loaded dynamically -->
                    </select>
                </div>
                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--gray-dark);">Notes</label>
                    <textarea id="hairProfileNotes" class="form-input" rows="3" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px; resize: none;" placeholder="Any allergies, sensitivities, or preferences..."></textarea>
                </div>
                <div id="hairProfileError" style="color: #e74c3c; font-size: 14px; margin-bottom: 15px; display: none;"></div>
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-outline" onclick="closeHairProfileModal()" style="flex: 1;">Cancel</button>
                    <button id="hairProfileSaveBtn" class="btn btn-primary" onclick="saveHairProfile()" style="flex: 1; background: var(--brand-pink);">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Payment Methods Modal -->
    <div class="modal" id="paymentMethodsModal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h3 class="modal-title">Payment Methods</h3>
                <button class="modal-close" onclick="closePaymentMethodsModal()">&times;</button>
            </div>
            <div class="modal-body" style="padding: 20px; text-align: center;">
                <div style="font-size: 48px; margin-bottom: 15px;"></div>
                <div style="font-weight: 600; margin-bottom: 8px;">Saved Cards Coming Soon</div>
                <p style="color: #888; margin-bottom: 20px;">We're working on adding the ability to save your payment methods for faster checkout.</p>
                <p style="color: #666; font-size: 14px;">For now, you can enter your card details during checkout.</p>
                <button class="btn btn-primary" onclick="closePaymentMethodsModal()" style="margin-top: 15px; background: var(--brand-pink);">Got it</button>
            </div>
        </div>
    </div>

    <!-- Notification Preferences Modal -->
    <div class="modal" id="notificationPrefsModal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h3 class="modal-title">Notification Settings</h3>
                <button class="modal-close" onclick="closeNotificationPrefsModal()">&times;</button>
            </div>
            <div class="modal-body" style="padding: 20px;">
                <p style="color: #666; margin-bottom: 20px; font-size: 14px;">Choose which notifications you'd like to receive.</p>
                <div style="display: flex; flex-direction: column; gap: 15px;">
                    <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                        <input type="checkbox" id="prefPromotions" style="width: 20px; height: 20px; accent-color: var(--brand-pink);">
                        <div>
                            <div style="font-weight: 500;">Promotions & Offers</div>
                            <div style="font-size: 13px; color: #888;">Special deals and discounts</div>
                        </div>
                    </label>
                    <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                        <input type="checkbox" id="prefAppointments" style="width: 20px; height: 20px; accent-color: var(--brand-pink);">
                        <div>
                            <div style="font-weight: 500;">Appointment Reminders</div>
                            <div style="font-size: 13px; color: #888;">Upcoming booking notifications</div>
                        </div>
                    </label>
                    <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                        <input type="checkbox" id="prefLoyalty" style="width: 20px; height: 20px; accent-color: var(--brand-pink);">
                        <div>
                            <div style="font-weight: 500;">Loyalty Updates</div>
                            <div style="font-size: 13px; color: #888;">Points earned and tier changes</div>
                        </div>
                    </label>
                </div>
                <div id="notifPrefsError" style="color: #e74c3c; font-size: 14px; margin-top: 15px; display: none;"></div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button class="btn btn-outline" onclick="closeNotificationPrefsModal()" style="flex: 1;">Cancel</button>
                    <button class="btn btn-primary" onclick="saveNotificationPrefs()" style="flex: 1; background: var(--brand-pink);">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Help Center Modal -->
    <div class="modal" id="helpCenterModal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h3 class="modal-title">Help Center</h3>
                <button class="modal-close" onclick="closeHelpCenterModal()">&times;</button>
            </div>
            <div class="modal-body" style="padding: 20px;">
                <p style="color: #666; margin-bottom: 20px; font-size: 14px;">Need help? We're here for you!</p>
                <div style="display: flex; flex-direction: column; gap: 15px;">
                    <a id="supportWhatsappLink" href="#" target="_blank" style="display: flex; align-items: center; gap: 12px; padding: 15px; background: #f9f9f9; border-radius: 12px; text-decoration: none; color: inherit;">
                        <div style="width: 40px; height: 40px; background: #25D366; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 20px;"></div>
                        <div>
                            <div style="font-weight: 500;">WhatsApp</div>
                            <div style="font-size: 13px; color: #888;">+27 82 123 4567</div>
                        </div>
                    </a>
                    <a href="tel:+27111234567" style="display: flex; align-items: center; gap: 12px; padding: 15px; background: #f9f9f9; border-radius: 12px; text-decoration: none; color: inherit;">
                        <div style="width: 40px; height: 40px; background: var(--brand-pink); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 20px;"></div>
                        <div>
                            <div style="font-weight: 500;">Call Us</div>
                            <div style="font-size: 13px; color: #888;">+27 11 123 4567</div>
                        </div>
                    </a>
                    <a href="#" onclick="showToast({type:'info',title:'FAQ',message:'FAQ page coming soon!'}); return false;" style="display: flex; align-items: center; gap: 12px; padding: 15px; background: #f9f9f9; border-radius: 12px; text-decoration: none; color: inherit;">
                        <div style="width: 40px; height: 40px; background: #9B59B6; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 20px;"></div>
                        <div>
                            <div style="font-weight: 500;">FAQs</div>
                            <div style="font-size: 13px; color: #888;">Common questions answered</div>
                        </div>
                    </a>
                </div>
                <button class="btn btn-primary" onclick="closeHelpCenterModal()" style="width: 100%; margin-top: 20px; background: var(--brand-pink);">Close</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settingsModal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h3 class="modal-title">Settings</h3>
                <button class="modal-close" onclick="closeSettingsModal()">&times;</button>
            </div>
            <div class="modal-body" style="padding: 20px;">
                <div style="display: flex; flex-direction: column; gap: 15px;">
                    <div style="padding: 15px; background: #f9f9f9; border-radius: 12px;">
                        <div style="font-weight: 500; margin-bottom: 4px;">Account</div>
                        <div style="font-size: 13px; color: #888;" id="settingsEmail">-</div>
                    </div>
                    <button class="btn btn-outline" onclick="closeSettingsModal(); logout();" style="width: 100%; border-color: #e74c3c; color: #e74c3c;">
                        Log Out
                    </button>
                    <div style="text-align: center; padding: 15px; color: #ccc; font-size: 13px;">
                        Delete Account - Coming Soon
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Reschedule Appointment Modal -->
    <div class="modal" id="rescheduleModal">
        <div class="modal-content" style="max-width: 400px;">
            <div class="modal-header">
                <h3 class="modal-title">Reschedule Appointment</h3>
                <button class="modal-close" onclick="closeRescheduleModal()">&times;</button>
            </div>
            <div class="modal-body" style="padding: 20px;">
                <div id="rescheduleBookingInfo" style="background: var(--gray-light); padding: 12px; border-radius: 10px; margin-bottom: 20px;">
                    <!-- Current booking info will be shown here -->
                </div>
                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--gray-dark);">New Date</label>
                    <input type="date" id="rescheduleDate" class="form-input" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px;">
                </div>
                <div class="form-group" style="margin-bottom: 15px;">
                    <label style="display: block; margin-bottom: 8px; font-weight: 500; color: var(--gray-dark);">Preferred Time</label>
                    <select id="rescheduleTimeOfDay" class="form-input" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 10px; font-size: 16px;">
                        <option value="morning">Morning (9AM - 12PM)</option>
                        <option value="afternoon">Afternoon (12PM - 4PM)</option>
                        <option value="evening">Evening (4PM - 7PM)</option>
                    </select>
                </div>
                <div id="rescheduleError" style="color: #e74c3c; font-size: 14px; margin-bottom: 15px; display: none;"></div>
                <div style="display: flex; gap: 10px;">
                    <button class="btn btn-outline" onclick="closeRescheduleModal()" style="flex: 1;">Cancel</button>
                    <button class="btn btn-primary" onclick="submitReschedule()" style="flex: 1; background: var(--brand-pink);">Confirm</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        console.log('%c FLIRT Hair & Beauty App Script Loaded', 'background: #f67599; color: white; padding: 4px 8px; border-radius: 4px; font-weight: bold;');

        // ============================================
        // TOAST NOTIFICATION SYSTEM
        // ============================================
        const toastIcons = {
            success: `<svg viewBox="0 0 24 24" fill="none" stroke="#4CAF50" stroke-width="2.5" width="20" height="20">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>`,
            error: `<svg viewBox="0 0 24 24" fill="none" stroke="#f44336" stroke-width="2.5" width="20" height="20">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="15" y1="9" x2="9" y2="15"></line>
                <line x1="9" y1="9" x2="15" y2="15"></line>
            </svg>`,
            warning: `<svg viewBox="0 0 24 24" fill="none" stroke="#FF9800" stroke-width="2.5" width="20" height="20">
                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                <line x1="12" y1="9" x2="12" y2="13"></line>
                <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>`,
            info: `<svg viewBox="0 0 24 24" fill="none" stroke="#F67599" stroke-width="2.5" width="20" height="20">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="16" x2="12" y2="12"></line>
                <line x1="12" y1="8" x2="12.01" y2="8"></line>
            </svg>`,
            promo: `<svg viewBox="0 0 24 24" fill="none" stroke="#F67599" stroke-width="2.5" width="20" height="20">
                <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon>
            </svg>`,
            booking: `<svg viewBox="0 0 24 24" fill="none" stroke="#F67599" stroke-width="2.5" width="20" height="20">
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>`,
            points: `<svg viewBox="0 0 24 24" fill="none" stroke="#F67599" stroke-width="2.5" width="20" height="20">
                <circle cx="12" cy="8" r="7"></circle>
                <polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"></polyline>
            </svg>`,
            gift: `<svg viewBox="0 0 24 24" fill="none" stroke="#F67599" stroke-width="2.5" width="20" height="20">
                <polyline points="20 12 20 22 4 22 4 12"></polyline>
                <rect x="2" y="7" width="20" height="5"></rect>
                <line x1="12" y1="22" x2="12" y2="7"></line>
                <path d="M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z"></path>
                <path d="M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z"></path>
            </svg>`
        };

        function showToast(options) {
            const {
                type = 'info',
                title = 'Notice',
                message = '',
                duration = 5000,
                action = null,
                actionText = 'View',
                icon = null
            } = options;

            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = 'toast';

            const safeTitle = title || 'Notification';
            const safeMessage = message || '';
            const displayIcon = icon || toastIcons[type] || toastIcons.info;

            toast.innerHTML = `
                <div class="toast-accent ${type}"></div>
                <div class="toast-body">
                    <div class="toast-icon ${type}">${displayIcon}</div>
                    <div class="toast-content">
                        <div class="toast-title">${safeTitle}</div>
                        ${safeMessage ? `<div class="toast-message">${safeMessage}</div>` : ''}
                        ${action ? `<div class="toast-action"><button class="toast-action-btn" onclick="${action}">${actionText}</button></div>` : ''}
                    </div>
                    <button class="toast-close" onclick="dismissToast(this)">&times;</button>
                </div>
                <div class="toast-progress"><div class="toast-progress-bar" style="animation-duration: ${duration}ms"></div></div>
            `;

            container.appendChild(toast);

            // Auto dismiss
            setTimeout(() => {
                dismissToast(toast.querySelector('.toast-close'));
            }, duration);

            return toast;
        }

        function dismissToast(closeBtn) {
            const toast = closeBtn.closest('.toast');
            if (toast && !toast.classList.contains('hiding')) {
                toast.classList.add('hiding');
                setTimeout(() => toast.remove(), 300);
            }
        }

        // Convenience functions
        function showSuccessToast(title, message, options = {}) {
            return showToast({ type: 'success', title, message, ...options });
        }

        function showErrorToast(title, message, options = {}) {
            return showToast({ type: 'error', title, message, ...options });
        }

        function showPromoToast(title, message, options = {}) {
            return showToast({ type: 'promo', title, message, duration: 8000, ...options });
        }

        // Check for admin-triggered notifications
        async function checkForNotifications() {
            try {
                const response = await fetch(`${API_BASE}/notifications/active`);
                if (response.ok) {
                    const data = await response.json();
                    if (data.notifications && data.notifications.length > 0) {
                        const shownIds = JSON.parse(localStorage.getItem('flirt_shown_notifications') || '[]');

                        data.notifications.forEach(notif => {
                            if (!shownIds.includes(notif.id)) {
                                showToast({
                                    type: notif.type || 'promo',
                                    title: notif.title,
                                    message: notif.message,
                                    duration: 8000,
                                    action: notif.action || null,
                                    actionText: notif.actionText || 'View'
                                });
                                shownIds.push(notif.id);
                            }
                        });

                        localStorage.setItem('flirt_shown_notifications', JSON.stringify(shownIds));
                    }
                }
            } catch (error) {
                console.log('Notification check skipped:', error.message);
            }
        }

        // ============================================
        // API CONFIGURATION
        // ============================================
        // Prefer meta-injected base; fallback to relative /api or localhost for dev
        const API_BASE = (() => {
            const meta = document.querySelector('meta[name="flirt-api-base"]');
            if (meta && meta.content) return meta.content;
            const origin = window.location.origin;
            const port = window.location.port;
            if (origin === 'null' || origin.startsWith('file://') || (port && port !== '3001')) {
                console.warn('Running in dev mode - using localhost:3001 for API.');
                return 'http://localhost:3001/api';
            }
            return '/api';
        })();

        // Client contact configuration (override via meta)
        const SUPPORT_WHATSAPP = (() => {
            const meta = document.querySelector('meta[name="flirt-support-whatsapp"]');
            return meta && meta.content ? meta.content : '27821234567';
        })();

        // Media base URL for static assets (override via meta if CDN changes)
        const MEDIA_BASE = (() => {
            const meta = document.querySelector('meta[name="flirt-media-base"]');
            return meta && meta.content ? meta.content.replace(/\/$/, '') : 'https://www.flirthair.co.za';
        })();

        // Get auth token from storage
        function getToken() {
            return localStorage.getItem('flirt_token');
        }

        // API connectivity status
        let apiConnected = true;

        // Show connection error banner
        function showConnectionError() {
            const existingBanner = document.getElementById('connectionError');
            if (existingBanner) return;

            const banner = document.createElement('div');
            banner.id = 'connectionError';
            banner.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; background: #f44336; color: white; padding: 12px 20px; text-align: center; z-index: 10000; font-size: 14px; display: flex; align-items: center; justify-content: center; gap: 10px;';
            banner.innerHTML = `
                <span>Unable to connect to server. Some features may not work.</span>
                <button onclick="retryConnection()" style="background: white; color: #f44336; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-weight: 600;">Retry</button>
            `;
            document.body.prepend(banner);
        }

        // Hide connection error banner
        function hideConnectionError() {
            const banner = document.getElementById('connectionError');
            if (banner) banner.remove();
        }

        // Retry API connection
        async function retryConnection() {
            try {
                await fetch(`${API_BASE}/health`, { method: 'GET' });
                apiConnected = true;
                hideConnectionError();
                location.reload();
            } catch (e) {
                alert('Still unable to connect. Please ensure the server is running.');
            }
        }

        // API helper function with graceful error handling
        async function apiCall(endpoint, options = {}) {
            const token = getToken();
            const headers = {
                'Content-Type': 'application/json',
                ...(token && { 'Authorization': `Bearer ${token}` })
            };

            try {
                const response = await fetch(`${API_BASE}${endpoint}`, {
                    ...options,
                    headers: { ...headers, ...options.headers }
                });
                const data = await response.json();

                if (!response.ok) {
                    throw new Error(data.message || 'API request failed');
                }
                apiConnected = true;
                hideConnectionError();
                return data;
            } catch (error) {
                console.error('API Error:', error);
                // Detect network/connection errors
                if (error.message.includes('Failed to fetch') ||
                    error.message.includes('NetworkError') ||
                    error.name === 'TypeError') {
                    apiConnected = false;
                    showConnectionError();
                }
                throw error;
            }
        }

        // ============================================
        // AUTH STATE & FUNCTIONS
        // ============================================
        let currentUser = null;

        function showAuthModal() {
            document.getElementById('authModal').classList.add('show');
        }

        function switchAuthTab(tab) {
            document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.auth-form').forEach(f => f.classList.remove('active'));

            if (tab === 'login') {
                document.querySelector('.auth-tab:first-child').classList.add('active');
                document.getElementById('loginForm').classList.add('active');
            } else {
                document.querySelector('.auth-tab:last-child').classList.add('active');
                document.getElementById('signupForm').classList.add('active');
            }
            clearAuthError();
        }

        function showAuthError(message) {
            const errorEl = document.getElementById('authError');
            errorEl.textContent = message;
            errorEl.classList.add('show');
        }

        function clearAuthError() {
            const errorEl = document.getElementById('authError');
            if (errorEl) {
                errorEl.textContent = '';
                errorEl.classList.remove('show');
            }
        }

        // Email validation regex
        const emailRegex = /^[^@\s]+@[^@\s]+\.[^@\s]+$/;

        async function handleLogin(event) {
            if (event) event.preventDefault();

            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value;
            const btn = document.getElementById('loginBtn');

            if (!email || !password) {
                showAuthError('Please enter email and password');
                return;
            }

            if (!emailRegex.test(email)) {
                showAuthError('Please enter a valid email address');
                return;
            }

            btn.disabled = true;
            btn.innerHTML = '<span class="loading-spinner"></span>';

            try {
                const data = await apiCall('/auth/login', {
                    method: 'POST',
                    body: JSON.stringify({ email, password })
                });

                localStorage.setItem('flirt_token', data.token);
                currentUser = data.user;
                onLoginSuccess();
            } catch (error) {
                showAuthError(error.message || 'Something went wrong. Please try again.');
            } finally {
                btn.disabled = false;
                btn.textContent = 'Login';
            }
        }

        async function handleSignup(event) {
            if (event) event.preventDefault();

            const name = document.getElementById('signupName').value.trim();
            const email = document.getElementById('signupEmail').value.trim();
            const phone = document.getElementById('signupPhone').value.trim();
            const password = document.getElementById('signupPassword').value;
            const confirmPassword = document.getElementById('signupPasswordConfirm').value;
            const referralCode = document.getElementById('signupReferral').value.trim();
            const btn = document.getElementById('signupBtn');

            if (!name) {
                showAuthError('Please enter your name');
                return;
            }

            if (!email) {
                showAuthError('Please enter your email address');
                return;
            }

            if (!emailRegex.test(email)) {
                showAuthError('Please enter a valid email address');
                return;
            }

            if (!password) {
                showAuthError('Please enter a password');
                return;
            }

            if (password.length < 6) {
                showAuthError('Password must be at least 6 characters');
                return;
            }

            if (password !== confirmPassword) {
                showAuthError('Passwords do not match');
                return;
            }

            btn.disabled = true;
            btn.innerHTML = '<span class="loading-spinner"></span>';

            try {
                const data = await apiCall('/auth/signup', {
                    method: 'POST',
                    body: JSON.stringify({ name, email, phone, password })
                });

                localStorage.setItem('flirt_token', data.token);
                currentUser = data.user;

                // Apply referral code if provided
                if (referralCode) {
                    try {
                        await apiCall('/referrals/apply', {
                            method: 'POST',
                            body: JSON.stringify({ referralCode })
                        });
                    } catch (e) {
                        console.log('Referral code error:', e.message);
                    }
                }

                onLoginSuccess();
            } catch (error) {
                showAuthError(error.message || 'Something went wrong. Please try again.');
            } finally {
                btn.disabled = false;
                btn.textContent = 'Create Account';
            }
        }

        // ============================================
        // SOCIAL LOGIN (GOOGLE & FACEBOOK)
        // ============================================

        function startGoogleLogin() {
            openSocialPopup('/api/auth/google/start');
        }

        function startFacebookLogin() {
            openSocialPopup('/api/auth/facebook/start');
        }

        function openSocialPopup(path) {
            const width = 500;
            const height = 600;
            const left = (window.screen.width - width) / 2;
            const top = (window.screen.height - height) / 2;

            // Build URL - remove /api from API_BASE if present
            const baseUrl = API_BASE.replace('/api', '');
            window.open(
                baseUrl + path,
                'flirt_social_login',
                `width=${width},height=${height},top=${top},left=${left}`
            );
        }

        // Listen for OAuth popup messages
        window.addEventListener('message', (event) => {
            const data = event.data || {};

            if (data.type === 'flirt_social_login' && data.token && data.user) {
                localStorage.setItem('flirt_token', data.token);
                currentUser = data.user;
                document.body.classList.add('logged-in');
                updateUserUI();
                loadUserData();
                closeModal('authModal');
            } else if (data.type === 'flirt_social_error' && data.message) {
                showAuthError(data.message);
            }
        });

        // Clear errors when user starts typing
        function setupAuthInputListeners() {
            const authInputs = [
                'loginEmail', 'loginPassword',
                'signupName', 'signupEmail', 'signupPhone',
                'signupPassword', 'signupPasswordConfirm', 'signupReferral'
            ];

            authInputs.forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    el.addEventListener('input', clearAuthError);
                }
            });
        }

        function onLoginSuccess() {
            closeModal('authModal');
            document.body.classList.add('logged-in');
            updateUserUI();
            loadUserData();
            loadUpcomingAppointment();
        }

        async function checkAuthStatus() {
            const token = getToken();
            if (!token) return;

            try {
                const data = await apiCall('/auth/me');
                currentUser = data.user;
                document.body.classList.add('logged-in');
                updateUserUI();
                await loadUserData();
                await loadUpcomingAppointment();
            } catch (error) {
                // Token was present but invalid/expired - clear it and notify user
                localStorage.removeItem('flirt_token');
                currentUser = null;
                document.body.classList.remove('logged-in');
                updateUserUI();

                // Show non-intrusive feedback about session expiry
                showToast({
                    title: 'Session expired',
                    message: 'Please sign in again to view your profile and bookings.',
                    type: 'info'
                });
            }
        }

        // Dev-only auto-login when running locally without a token
        async function devAutoLoginIfNeeded() {
            const hasToken = !!getToken();
            const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';
            if (hasToken || !isLocalhost) return;
            try {
                const res = await fetch(`${API_BASE}/auth/dev-login`);
                if (!res.ok) return;
                const data = await res.json();
                if (data.token && data.user) {
                    localStorage.setItem('flirt_token', data.token);
                    currentUser = data.user;
                    document.body.classList.add('logged-in');
                    updateUserUI();
                    await loadUserData();
                    await loadUpcomingAppointment();
                }
            } catch (e) {
                console.warn('Dev auto-login failed:', e);
            }
        }

        function updateUserUI() {
            // Update profile section - handles both logged-in and guest states
            const avatar = document.getElementById('profileAvatar');
            const name = document.getElementById('profileName');
            const tierText = document.getElementById('profileTierText');

            // Update welcome banner
            const welcomeTitle = document.getElementById('welcomeTitle');
            const welcomeSubtitle = document.getElementById('welcomeSubtitle');
            const pointsDisplayBanner = document.getElementById('pointsDisplay');
            const bannerPoints = document.getElementById('bannerPoints');
            const bannerTier = document.getElementById('bannerTier');

            if (!currentUser) {
                // Guest state
                if (avatar) avatar.textContent = '?';
                if (name) name.textContent = 'Guest';
                if (tierText) tierText.textContent = 'Sign in to unlock rewards';

                // Welcome banner for guests
                if (welcomeTitle) welcomeTitle.textContent = 'Welcome to FL!RT ';
                if (welcomeSubtitle) welcomeSubtitle.textContent = 'Discover premium hair extensions and book your transformation!';
                if (pointsDisplayBanner) pointsDisplayBanner.style.display = 'none';
                return;
            }

            // Logged-in state
            if (avatar) avatar.textContent = currentUser.name?.charAt(0).toUpperCase() || 'U';
            if (name) name.textContent = currentUser.name || 'User';
            if (tierText) {
                const tier = currentUser.tier || 'bronze';
                const niceTier = tier.charAt(0).toUpperCase() + tier.slice(1);
                tierText.textContent = `${niceTier} Tier Member`;
            }

            // Welcome banner for logged-in users
            const firstName = currentUser.name?.split(' ')[0] || 'there';
            if (welcomeTitle) welcomeTitle.textContent = `Welcome back, ${firstName}! `;
            if (welcomeSubtitle) welcomeSubtitle.textContent = 'Your beauty journey continues...';

            // Show points display
            if (pointsDisplayBanner) pointsDisplayBanner.style.display = 'flex';
            if (bannerPoints) bannerPoints.textContent = `${(currentUser.points ?? 0).toLocaleString()} Points`;
            if (bannerTier) {
                const tier = currentUser.tier || 'bronze';
                const niceTier = tier.charAt(0).toUpperCase() + tier.slice(1);
                bannerTier.textContent = `${niceTier} Tier Member`;
            }

            // Update rewards section - use #userPoints which has class .stat-number
            const pointsDisplay = document.getElementById('userPoints');
            if (pointsDisplay) pointsDisplay.textContent = (currentUser.points ?? 0).toLocaleString();

            const referralCode = document.querySelector('.referral-code');
            if (referralCode) referralCode.textContent = currentUser.referralCode || '';

            // Update tier display if loyalty config is loaded
            if (loyaltyConfig) {
                updateTierDisplay();
            }
        }

        async function loadUserData() {
            if (!currentUser) return;

            try {
                // Load loyalty balance
                const loyalty = await apiCall('/loyalty/balance');
                currentUser.points = loyalty.points;
                currentUser.tier = loyalty.tier;
                updateUserUI();
            } catch (error) {
                console.log('Error loading user data:', error);
            }
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                // Clear auth token and user state
                localStorage.removeItem('flirt_token');
                currentUser = null;
                document.body.classList.remove('logged-in');

                // Update profile UI to show guest state immediately
                updateUserUI();

                // Show confirmation toast
                showToast({ type: 'info', title: 'Logged Out', message: 'You have been logged out successfully.' });

                // Switch to home tab
                switchTab('home');
            }
        }

        // ============================================
        // TAB NAVIGATION
        // ============================================
        // switchTab handles both click events (from nav tabs) and programmatic calls (from JS)
        // When called from onclick, pass the event: switchTab('home', event)
        // When called programmatically, just pass the tab name: switchTab('home')
        function switchTab(tabName, evt) {
            const contentAreas = document.querySelectorAll('.content-area');
            contentAreas.forEach(area => area.classList.remove('active'));

            const targetContent = document.getElementById(tabName);
            if (targetContent) {
                targetContent.classList.add('active');
            }

            // Clear active state from all nav tabs
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => tab.classList.remove('active'));

            // Set active state on the appropriate nav tab
            if (evt && evt.target) {
                // Click event path: find the clicked nav-tab
                const clickedTab = evt.target.closest('.nav-tab');
                if (clickedTab) clickedTab.classList.add('active');
            } else {
                // Programmatic path: find nav-tab by data-tab attribute
                const targetTab = document.querySelector(`.nav-tab[data-tab="${tabName}"]`);
                if (targetTab) targetTab.classList.add('active');
            }

            // Load data for specific tabs
            if (tabName === 'rewards') {
                loadUserData();
                loadLoyaltyConfig();
            } else if (tabName === 'tracker') {
                loadHairTracker();
            }
        }

        // Simple section navigator to booking tab or other anchors
        function navigateToSection(section) {
            if (section === 'book') {
            switchTab('booking');
            document.getElementById('booking')?.scrollIntoView({ behavior: 'smooth' });
            } else if (section === 'my-bookings') {
                switchTab('booking');
                document.getElementById('booking')?.scrollIntoView({ behavior: 'smooth' });
            }
        }

        // ============================================
        // BOOKING STATE & DATA
        // ============================================
        let bookingType = null;
        let selectedStylist = null;
        let selectedService = null;
        let selectedServiceId = null;
        let selectedDate = null;
        let selectedTime = null;

        // Local cache for stylists/services (loaded from API)
        let stylists = {};
        let services = {};
        let beautyServices = {};
        let bookingDataLoaded = false;

        // Load data from API on init
        async function loadBookingData() {
            try {
                // Load stylists
                const stylistsData = await apiCall('/stylists');
                stylistsData.stylists.forEach(s => {
                    const entry = {
                        name: s.name,
                        specialty: s.specialty,
                        avatar: s.name.charAt(0),
                        color: `linear-gradient(135deg, ${s.color} 0%, ${s.color}99 100%)`
                    };
                    // Store by full id and simple id (for legacy hardcoded cards like "lisa", "emma")
                    stylists[s.id] = entry;
                    const simpleId = s.id.replace(/^stylist_/, '').toLowerCase();
                    stylists[simpleId] = entry;
                });

                // Load hair services
                const hairData = await apiCall('/services/hair');
                hairData.services.forEach(s => {
                    const entry = {
                        id: s.id,
                        name: s.name,
                        price: s.price === 0 ? 'Free' : `R${s.price.toLocaleString()}`
                    };
                    services[s.id] = entry;
                    const slug = s.name.toLowerCase().replace(/[^a-z0-9]/g, '');
                    services[slug] = entry;
                    if (slug.includes('tape')) services['tape'] = entry;
                    if (slug.includes('weft')) services['weft'] = entry;
                    if (slug.includes('color')) services['color'] = entry;
                    if (slug.includes('maint')) services['maintenance'] = entry;
                });

                // Load beauty services
                const beautyData = await apiCall('/services/beauty');
                beautyData.services.forEach(s => {
                    beautyServices[s.id] = {
                        id: s.id,
                        name: s.name,
                        duration: `${s.durationMinutes} min`,
                        price: `R${s.price}`
                    };
                });
                bookingDataLoaded = true;
            } catch (error) {
                console.log('Using fallback data:', error);
                // Fallback to hardcoded data if API fails
                stylists = {
                    'lisa': { name: 'Lisa Thompson', specialty: 'Senior Stylist', avatar: 'L', color: 'linear-gradient(135deg, #F67599 0%, #e05a7f 100%)' },
                    'emma': { name: 'Emma Williams', specialty: 'Extension Specialist', avatar: 'E', color: 'linear-gradient(135deg, #F67599 0%, #e05a7f 100%)' },
                    'sarah': { name: 'Sarah Martinez', specialty: 'Color Expert', avatar: 'S', color: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' },
                    'maya': { name: 'Maya Johnson', specialty: 'Maintenance Expert', avatar: 'M', color: 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)' }
                };
                services = {
                    'tape': { name: 'Tape Extensions', price: 'R2,500' },
                    'weft': { name: 'Weft Installation', price: 'R3,200' },
                    'color': { name: 'Color Matching', price: 'Free' },
                    'maintenance': { name: 'Maintenance', price: 'R800' }
                };
                beautyServices = {
                    'facial': { name: 'Facial Treatment', duration: '60 min', price: 'R450' },
                    'manicure': { name: 'Manicure', duration: '45 min', price: 'R250' },
                    'pedicure': { name: 'Pedicure', duration: '60 min', price: 'R300' },
                    'waxing': { name: 'Waxing', duration: '30-60 min', price: 'From R150' },
                    'threading': { name: 'Eyebrow Threading', duration: '15 min', price: 'R80' },
                    'massage': { name: 'Massage Therapy', duration: '60 min', price: 'R500' }
                };
            }
        }

        // Booking Type Selection
        function selectBookingType(type) {
            bookingType = type;

            // Hide booking type selection
            document.getElementById('bookingTypeSelection').style.display = 'none';

            if (type === 'hair') {
                // Show stylist selection for hair extensions
                document.getElementById('stylistSelection').style.display = 'block';
            } else if (type === 'beauty') {
                // Show beauty service selection (no stylist needed)
                document.getElementById('beautyBooking').style.display = 'block';
            }
        }

        // Change Booking Type
        function changeBookingType() {
            // Reset everything
            bookingType = null;
            selectedStylist = null;
            selectedService = null;
            selectedDate = null;
            selectedTime = null;

            // Hide all booking sections
            document.getElementById('stylistSelection').style.display = 'none';
            document.getElementById('serviceSelection').style.display = 'none';
            document.getElementById('bookingForm').style.display = 'none';
            document.getElementById('beautyBooking').style.display = 'none';
            document.getElementById('beautyBookingCalendar').style.display = 'none';

            // Show booking type selection
            document.getElementById('bookingTypeSelection').style.display = 'block';
        }

        // Stylist Selection
        function selectStylist(stylistId) {
            selectedStylist = stylistId;
            const stylist = stylists[stylistId];

            // Update selected stylist displays
            document.getElementById('selectedStylistName').textContent = stylist.name;
            document.getElementById('selectedStylistName2').textContent = stylist.name;
            document.getElementById('selectedStylistName3').textContent = stylist.name.split(' ')[0];
            document.getElementById('selectedStylistSpecialty').textContent = stylist.specialty;

            const avatars = document.querySelectorAll('.stylist-avatar-small');
            avatars.forEach(avatar => {
                avatar.textContent = stylist.avatar;
                avatar.style.background = stylist.color;
            });

            // Show service selection, hide stylist selection
            document.getElementById('stylistSelection').style.display = 'none';
            document.getElementById('serviceSelection').style.display = 'block';
            document.getElementById('serviceSelection').scrollIntoView({ behavior: 'smooth' });
        }

        // Change Stylist
        function changeStylist() {
            document.getElementById('stylistSelection').style.display = 'block';
            document.getElementById('serviceSelection').style.display = 'none';
            document.getElementById('bookingForm').style.display = 'none';
            selectedStylist = null;
            selectedService = null;
        }

        // Service Selection
        async function ensureBookingData() {
            if (bookingDataLoaded) return;
            try {
                await loadBookingData();
            } catch (e) {
                console.error('Failed to refresh booking data:', e);
            }
        }

        async function selectService(serviceType, el) {
            await ensureBookingData();
            // Find service from cache; if missing, build from the card DOM
            let service = services[serviceType];
            const targetCard = el ? el.closest('.service-card') : null;
            if (!service && targetCard) {
                const name = targetCard.querySelector('.service-name')?.textContent?.trim() || 'Selected Service';
                const price = targetCard.querySelector('.service-price')?.textContent?.trim() || '';
                service = { id: serviceType, name, price };
                services[serviceType] = service;
            }

            if (!service) {
                showToast({ type: 'error', title: 'Service unavailable', message: 'Please reload and try again.' });
                return;
            }

            selectedService = serviceType;
            selectedServiceId = service.id || serviceType;

            const cards = document.querySelectorAll('#serviceSelection .service-card');
            cards.forEach(card => card.classList.remove('selected'));
            if (targetCard) targetCard.classList.add('selected');

            // Update service name display
            document.getElementById('selectedServiceName').textContent = `${service.name} - ${service.price}`;

            // Show booking form
            setTimeout(() => {
                document.getElementById('bookingForm').style.display = 'block';
                document.getElementById('bookingForm').scrollIntoView({ behavior: 'smooth' });

                // Generate calendar
                generateCalendar();
            }, 300);
        }

        // Go back to service selection
        function goBackToService() {
            document.getElementById('serviceSelection').scrollIntoView({ behavior: 'smooth' });
            document.getElementById('bookingForm').style.display = 'none';
            selectedService = null;
        }

        // Compare Availability - Modal
        function compareAvailability() {
            alert('Compare Availability Feature:\n\nThis would show a side-by-side comparison of all stylists\' availability for the selected date and service, allowing you to see who else is available if your preferred stylist is fully booked.');
        }

        // Beauty Service Selection
        async function selectBeautyService(serviceType, el) {
            await ensureBookingData();
            selectedService = serviceType;
            const service = beautyServices[serviceType];

            const cards = document.querySelectorAll('#beautyBooking .service-card');
            cards.forEach(card => card.classList.remove('selected'));
            const targetCard = el ? el.closest('.service-card') : null;
            if (targetCard) targetCard.classList.add('selected');

            if (service) {
                selectedServiceId = service.id || serviceType;
                // Update service name display
                document.getElementById('selectedBeautyServiceName').textContent = service.name;
                document.getElementById('selectedBeautyServiceDetails').textContent = `${service.duration} - ${service.price}`;
            } else {
                selectedServiceId = serviceType;
            }

            // Show booking calendar
            setTimeout(() => {
                document.getElementById('beautyBookingCalendar').style.display = 'block';
                document.getElementById('beautyBookingCalendar').scrollIntoView({ behavior: 'smooth' });

                // Generate calendar for beauty
                generateBeautyCalendar();
            }, 300);
        }

        // Go back to beauty service selection
        function goBackToBeautyService() {
            document.getElementById('beautyBookingCalendar').style.display = 'none';
            selectedService = null;
            selectedDate = null;
            selectedTime = null;
        }

        // ========== CALENDAR STATE ==========
        let hairCalendarMonthOffset = 0;
        let beautyCalendarMonthOffset = 0;
        let selectedDateStr = null; // Store as YYYY-MM-DD string

        // Reusable calendar renderer
        function renderCalendar(gridId, monthLabelId, monthOffset, calendarType) {
            const calendarGrid = document.getElementById(gridId);
            const monthLabel = document.getElementById(monthLabelId);
            calendarGrid.innerHTML = '';

            const today = new Date();
            today.setHours(0, 0, 0, 0);

            // Calculate the target month
            const targetDate = new Date(today.getFullYear(), today.getMonth() + monthOffset, 1);
            const year = targetDate.getFullYear();
            const month = targetDate.getMonth();

            // Update month label
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                               'July', 'August', 'September', 'October', 'November', 'December'];
            monthLabel.textContent = `${monthNames[month]} ${year}`;

            // Days of week headers
            const days = ['S', 'M', 'T', 'W', 'T', 'F', 'S'];
            days.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.style.cssText = 'text-align: center; font-weight: 600; padding: 10px; font-size: 12px;';
                dayHeader.textContent = day;
                calendarGrid.appendChild(dayHeader);
            });

            // First day of month (0 = Sunday)
            const firstDayOfMonth = new Date(year, month, 1).getDay();

            // Number of days in month
            const daysInMonth = new Date(year, month + 1, 0).getDate();

            // Add empty cells for days before the first of the month
            for (let i = 0; i < firstDayOfMonth; i++) {
                const emptyCell = document.createElement('div');
                emptyCell.className = 'calendar-day disabled';
                emptyCell.style.opacity = '0';
                calendarGrid.appendChild(emptyCell);
            }

            // Add day cells
            for (let day = 1; day <= daysInMonth; day++) {
                const cellDate = new Date(year, month, day);
                const dateStr = cellDate.toISOString().split('T')[0];
                const isPast = cellDate < today;
                const isToday = cellDate.getTime() === today.getTime();

                const dayCell = document.createElement('div');
                dayCell.className = 'calendar-day';
                dayCell.textContent = day;
                dayCell.dataset.date = dateStr;

                if (isPast) {
                    dayCell.classList.add('disabled');
                    dayCell.style.opacity = '0.4';
                    dayCell.style.cursor = 'not-allowed';
                } else {
                    if (isToday) {
                        dayCell.style.border = '2px solid var(--brand-pink)';
                    }

                    // Check if this date is currently selected
                    if (selectedDateStr === dateStr) {
                        dayCell.classList.add('selected');
                    }

                    dayCell.onclick = function() {
                        // Clear selection from all calendars of this type
                        document.querySelectorAll(`#${gridId} .calendar-day`).forEach(d => d.classList.remove('selected'));
                        this.classList.add('selected');
                        selectedDateStr = dateStr;
                        selectedDate = day; // Keep for backward compatibility
                    };
                }

                calendarGrid.appendChild(dayCell);
            }
        }

        // Hair calendar navigation
        function changeHairCalendarMonth(delta) {
            // Don't allow going to past months
            if (hairCalendarMonthOffset + delta < 0) return;
            // Limit to 6 months ahead
            if (hairCalendarMonthOffset + delta > 6) return;

            hairCalendarMonthOffset += delta;
            generateCalendar();
        }

        // Beauty calendar navigation
        function changeBeautyCalendarMonth(delta) {
            // Don't allow going to past months
            if (beautyCalendarMonthOffset + delta < 0) return;
            // Limit to 6 months ahead
            if (beautyCalendarMonthOffset + delta > 6) return;

            beautyCalendarMonthOffset += delta;
            generateBeautyCalendar();
        }

        // Generate Beauty Calendar
        function generateBeautyCalendar() {
            renderCalendar('beautyCalendarGrid', 'beautyCalendarMonth', beautyCalendarMonthOffset, 'beauty');
        }

        // Beauty Time Slot Selection
        function selectBeautyTime(element) {
            document.querySelectorAll('#beautyTimeSlots .time-slot').forEach(slot => slot.classList.remove('selected'));
            element.classList.add('selected');
            selectedTime = element.textContent;
        }

        // Confirm Beauty Booking
        async function confirmBeautyBooking() {
            await ensureBookingData();
            if (!selectedService || !selectedDateStr || !selectedTime) {
                showToast({ type: 'error', title: 'Incomplete Booking', message: 'Please complete all booking steps' });
                return;
            }

            // Check if user is logged in
            if (!currentUser) {
                showAuthModal();
                return;
            }

            const service = beautyServices[selectedService];
            const bookingDate = new Date(selectedDateStr + 'T00:00:00');

            try {
                await apiCall('/bookings', {
                    method: 'POST',
                    body: JSON.stringify({
                        type: 'beauty',
                        serviceId: selectedServiceId || selectedService,
                        date: selectedDateStr,
                        time: selectedTime
                    })
                });

                showToast({ type: 'success', title: 'Booking Confirmed!', message: 'Your beauty appointment has been booked.' });

                // Show success modal
                setTimeout(() => {
                    alert(` Beauty Salon Booking Confirmed!\n\nService: ${service.name}\nDuration: ${service.duration}\nPrice: ${service.price}\nDate: ${bookingDate.toLocaleDateString()}\nTime: ${selectedTime}\n\nNext available therapist will be assigned.\nYou will receive a confirmation email shortly.\n\n+50 loyalty points earned! `);
                }, 100);

                // Reset booking state
                bookingType = null;
                selectedService = null;
                selectedServiceId = null;
                selectedDate = null;
                selectedDateStr = null;
                selectedTime = null;
                beautyCalendarMonthOffset = 0;

                // Reset UI
                document.getElementById('bookingTypeSelection').style.display = 'block';
                document.getElementById('beautyBooking').style.display = 'none';
                document.getElementById('beautyBookingCalendar').style.display = 'none';

                // Reload user data to update points
                loadUserData();
                switchTab('home');
            } catch (error) {
                showToast({ type: 'error', title: 'Booking Failed', message: error.message || 'Error creating booking' });
            }
        }

        // Calendar Generation for Hair Bookings
        function generateCalendar() {
            renderCalendar('calendarGrid', 'hairCalendarMonth', hairCalendarMonthOffset, 'hair');
        }

        // Time Slot Selection
        function selectTime(element) {
            if (element.classList.contains('unavailable')) {
                return;
            }
            document.querySelectorAll('.time-slot').forEach(slot => slot.classList.remove('selected'));
            element.classList.add('selected');
            selectedTime = element.textContent;
        }

        // Booking Confirmation
        async function confirmBooking() {
            await ensureBookingData();
            if (!selectedStylist || !selectedService || !selectedDateStr) {
                showToast({ type: 'error', title: 'Incomplete Booking', message: 'Please select a stylist, service, and preferred date' });
                return;
            }

            // Check if user is logged in
            if (!currentUser) {
                showAuthModal();
                return;
            }

            const stylist = stylists[selectedStylist];
            const service = services[selectedService];
            const preferredTime = document.getElementById('preferredTimeOfDay').value;
            let timePreferenceText = '';

            if (preferredTime === 'morning') timePreferenceText = '\nPreferred Time: Morning (8am - 12pm)';
            else if (preferredTime === 'afternoon') timePreferenceText = '\nPreferred Time: Afternoon (12pm - 4pm)';
            else if (preferredTime === 'evening') timePreferenceText = '\nPreferred Time: Evening (4pm - 7pm)';

            const bookingDate = new Date(selectedDateStr + 'T00:00:00');
            const notes = document.querySelector('#bookingForm textarea')?.value || '';

            try {
                await apiCall('/bookings', {
                    method: 'POST',
                    body: JSON.stringify({
                        type: 'hair',
                        stylistId: selectedStylist,
                        serviceId: selectedServiceId || selectedService,
                        date: selectedDateStr,
                        preferredTimeOfDay: preferredTime || null,
                        notes
                    })
                });

                showToast({ type: 'success', title: 'Request Submitted!', message: 'Our team will contact you to confirm your appointment.' });

                // Show success modal
                setTimeout(() => {
                    alert(` Booking Request Submitted!\n\nStylist: ${stylist.name}\nService: ${service.name}\nPrice: ${service.price}\nPreferred Date: ${bookingDate.toLocaleDateString()}${timePreferenceText}\n\nOur salon team will contact you within 24 hours to confirm the exact appointment time. You will also receive a confirmation email.\n\n+50 loyalty points earned! `);
                }, 100);

                // Reset booking state
                selectedStylist = null;
                selectedService = null;
                selectedServiceId = null;
                selectedDate = null;
                selectedDateStr = null;
                selectedTime = null;
                hairCalendarMonthOffset = 0;

                // Reset UI
                document.getElementById('stylistSelection').style.display = 'block';
                document.getElementById('serviceSelection').style.display = 'none';
                document.getElementById('bookingForm').style.display = 'none';

                // Reload user data to update points
                loadUserData();
                switchTab('home');
            } catch (error) {
                showToast({ type: 'error', title: 'Booking Failed', message: error.message || 'Error creating booking' });
            }
        }

        // Modal Functions
        function showNotifications() {
            document.getElementById('notificationModal').classList.add('show');
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('show');
        }

        // ========== LOYALTY CONFIG ==========
        // Cached loyalty config loaded from API
        let loyaltyConfig = null;

        // Load loyalty configuration from API
        async function loadLoyaltyConfig() {
            if (loyaltyConfig) return loyaltyConfig;

            try {
                const response = await fetch(`${API_BASE}/loyalty/config`);
                const data = await response.json();

                if (data.success) {
                    loyaltyConfig = data;
                    renderRewardsSection();
                    return loyaltyConfig;
                }
            } catch (error) {
                console.error('Failed to load loyalty config:', error);
            }

            // Return fallback config if API fails
            return null;
        }

        // Render the rewards section from config
        function renderRewardsSection() {
            if (!loyaltyConfig) return;

            const { referral, pointsRules, earnRulesDisplay, tierThresholds } = loyaltyConfig;

            // Update title and subheading
            const titleEl = document.getElementById('rewardsTitle');
            if (titleEl && referral?.headline) {
                titleEl.textContent = referral.headline;
            }

            const subEl = document.getElementById('referralSubheading');
            if (subEl && referral?.subheading) {
                subEl.textContent = referral.subheading;
            }

            // Update referral code display
            if (currentUser?.referralCode) {
                const codeEl = document.getElementById('referralCodeDisplay');
                if (codeEl) codeEl.textContent = currentUser.referralCode;
            }

            // Update points display
            if (currentUser?.points !== undefined) {
                const pointsEl = document.getElementById('userPoints');
                if (pointsEl) pointsEl.textContent = currentUser.points.toLocaleString();
            }

            // Render Ways to Earn Points
            const earnContainer = document.getElementById('earnRulesContainer');
            if (earnContainer && Array.isArray(earnRulesDisplay)) {
                earnContainer.innerHTML = earnRulesDisplay.map((rule, index) => {
                    const key = rule.pointsKey;
                    let pointsLabel = '';

                    if (rule.isSpendRule) {
                        // e.g. Every R10 spent  +1 pt
                        pointsLabel = `+1 pt`;
                    } else {
                        const pts = pointsRules[key] || 0;
                        pointsLabel = `+${pts} pts`;
                    }

                    // Replace {spendRand} placeholder in label
                    const labelText = rule.label.replace('{spendRand}', pointsRules.spendRand || 10);
                    const isLast = index === earnRulesDisplay.length - 1;

                    return `
                        <div style="display: flex; justify-content: space-between; padding: 10px 0; ${isLast ? '' : 'border-bottom: 1px solid var(--gray-light);'}">
                            <span>${labelText}</span>
                            <strong style="color: var(--brand-pink);">${pointsLabel}</strong>
                        </div>
                    `;
                }).join('');
            }

            // Update tier display based on user's points
            updateTierDisplay();
        }

        // Update tier display based on current user's points
        function updateTierDisplay() {
            if (!loyaltyConfig || !currentUser) return;

            const { tierThresholds } = loyaltyConfig;
            const points = currentUser.points || 0;

            // Calculate current tier
            let currentTier = 'bronze';
            let tierLevel = 1;
            if (points >= tierThresholds.platinum) {
                currentTier = 'platinum';
                tierLevel = 4;
            } else if (points >= tierThresholds.gold) {
                currentTier = 'gold';
                tierLevel = 3;
            } else if (points >= tierThresholds.silver) {
                currentTier = 'silver';
                tierLevel = 2;
            }

            // Calculate progress to next tier
            const tierNames = ['bronze', 'silver', 'gold', 'platinum'];
            const tierEmojis = { bronze: '', silver: '', gold: '', platinum: '' };
            const nextTierIndex = Math.min(tierLevel, 3);
            const nextTier = tierNames[nextTierIndex];
            const nextThreshold = tierThresholds[nextTier] || tierThresholds.platinum;
            const currentThreshold = tierLevel === 1 ? 0 : tierThresholds[currentTier];

            const progressPercent = tierLevel === 4 ? 100 :
                Math.min(100, ((points - currentThreshold) / (nextThreshold - currentThreshold)) * 100);

            // Update UI
            const tierNameEl = document.getElementById('userTierName');
            if (tierNameEl) {
                tierNameEl.textContent = `${tierEmojis[currentTier]} ${currentTier.charAt(0).toUpperCase() + currentTier.slice(1)} Tier`;
            }

            const tierProgressEl = document.getElementById('userTierProgress');
            if (tierProgressEl) {
                if (tierLevel === 4) {
                    tierProgressEl.textContent = 'Maximum tier reached!';
                } else {
                    tierProgressEl.textContent = `${points.toLocaleString()} / ${nextThreshold.toLocaleString()} points to ${nextTier.charAt(0).toUpperCase() + nextTier.slice(1)}`;
                }
            }

            const tierLevelEl = document.getElementById('userTierLevel');
            if (tierLevelEl) {
                tierLevelEl.textContent = `Level ${tierLevel} of 4`;
            }

            const progressBar = document.getElementById('tierProgressBar');
            if (progressBar) {
                progressBar.style.width = `${progressPercent}%`;
            }

            // Update perks list
            const perks = getTierPerks(currentTier);
            const perksList = document.getElementById('tierPerksList');
            if (perksList && perks.length > 0) {
                perksList.innerHTML = perks.map(perk => `<li>${perk}</li>`).join('');
            }
        }

        // Get tier perks (fallback if not from API)
        function getTierPerks(tier) {
            const perks = {
                bronze: ['Earn points on every visit', 'Birthday surprise'],
                silver: ['5% off all services', 'Priority booking', 'Birthday surprise', 'Early access to sales'],
                gold: ['15% off all services', 'Free birthday blowout', 'Priority booking', 'Exclusive events', 'Free product samples'],
                platinum: ['20% off all services', 'Free monthly treatment', 'VIP parking', 'Personal stylist', 'Exclusive events', 'Complimentary refreshments']
            };
            return perks[tier] || perks.bronze;
        }

        // Get referral share message from config
        function getReferralShareMessage(code) {
            const referral = loyaltyConfig?.referral;
            let discountLabel = '10%'; // Default fallback

            if (referral) {
                if (referral.discountType === 'percent') {
                    discountLabel = `${referral.discountValue}%`;
                } else if (referral.discountType === 'amount') {
                    discountLabel = `R${referral.discountValue}`;
                }
            }

            const template = referral?.shareMessageTemplate ||
                'Check out Flirt Hair Extensions! Use my code {code} for {discount} off your first booking! ';

            return template
                .replace('{code}', code)
                .replace('{discount}', discountLabel);
        }

        // Referral Functions
        function shareReferral(platform) {
            const code = currentUser?.referralCode || 'FLIRT100';
            const message = getReferralShareMessage(code);

            switch(platform) {
                case 'whatsapp':
                    window.open(`https://wa.me/?text=${encodeURIComponent(message)}`);
                    break;
                case 'facebook':
                    alert('Copy this and share on Facebook:\n\n' + message);
                    break;
                case 'instagram':
                    alert('Copy this and share on Instagram:\n\n' + message);
                    break;
            }
        }

        function copyReferralCode() {
            const code = currentUser?.referralCode || 'FLIRT100';
            navigator.clipboard.writeText(code);
            showToast({ type: 'success', title: 'Copied!', message: 'Referral code copied to clipboard' });
        }

        // ========== HAIR TRACKER ==========
        let hairTrackerData = null;
        let hairTrackerConfig = null;

        // Load hair tracker data and config
        async function loadHairTracker() {
            if (!currentUser) {
                // Show setup prompt for non-logged in users
                document.getElementById('trackerSetupPrompt').style.display = 'block';
                document.getElementById('trackerMainContent').style.display = 'none';
                return;
            }

            try {
                const [trackerRes, configRes] = await Promise.all([
                    apiCall('/hair-tracker'),
                    fetch(`${API_BASE}/hair-tracker/config`).then(r => r.json())
                ]);

                if (trackerRes.success) {
                    hairTrackerData = trackerRes.data;
                }
                if (configRes.success) {
                    hairTrackerConfig = configRes.config;
                }

                renderHairTracker();
            } catch (error) {
                console.error('Failed to load hair tracker:', error);
                showToast({ type: 'error', title: 'Error', message: 'Failed to load hair tracker data' });
            }
        }

        // Render the hair tracker UI
        function renderHairTracker() {
            const data = hairTrackerData || {};
            const config = hairTrackerConfig || {};
            const copy = config.copy || {};

            // Update title and subtitle
            const titleEl = document.getElementById('trackerTitle');
            if (titleEl && copy.trackerTitle) {
                titleEl.textContent = copy.trackerTitle;
            }

            const subtitleEl = document.getElementById('trackerSubtitle');
            if (subtitleEl && copy.trackerSubtitle) {
                subtitleEl.textContent = copy.trackerSubtitle;
                subtitleEl.style.display = 'block';
            }

            // Check if tracker is set up
            if (!data.lastInstallDate) {
                // Show setup prompt
                document.getElementById('trackerSetupPrompt').style.display = 'block';
                document.getElementById('trackerMainContent').style.display = 'none';

                // Update copy for no-install message
                const noInstallMsg = document.getElementById('trackerNoInstallMessage');
                if (noInstallMsg && copy.noInstallMessage) {
                    noInstallMsg.textContent = copy.noInstallMessage;
                }
                const setupBtn = document.getElementById('trackerSetupBtn');
                if (setupBtn && copy.setupButtonText) {
                    setupBtn.textContent = copy.setupButtonText;
                }
                return;
            }

            // Show main content
            document.getElementById('trackerSetupPrompt').style.display = 'none';
            document.getElementById('trackerMainContent').style.display = 'block';

            // Helper to set text content
            const setText = (id, value) => {
                const el = document.getElementById(id);
                if (el && value !== undefined && value !== null) {
                    el.textContent = value;
                }
            };

            // Core stats
            setText('trackerDays', data.daysSinceInstall ?? '');
            setText('trackerWashes', data.washes ?? 0);
            setText('trackerDaysUntilMaintenance', data.daysUntilMaintenance ?? '');
            setText('trackerHealthScore', (data.hairHealthScore ?? 0) + '%');
            setText('trackerProductsUsed', data.productsUsedCount ?? 0);

            // Show extension type
            if (data.extensionType && config.extensionTypes) {
                const extType = config.extensionTypes.find(et => et.id === data.extensionType);
                setText('trackerExtensionType', extType?.label || data.extensionType);
            }

            // Update progress circle visual
            updateTrackerProgressCircle(data);

            // Care schedule labels
            setText('trackerNextWashTitle', copy.nextWashLabel || 'Next Wash Day');
            setText('trackerMaintenanceTitle', copy.maintenanceLabel || 'Maintenance Due');
            setText('trackerDeepConditionTitle', copy.deepConditionLabel || 'Deep Condition');

            // Next wash label
            if (data.nextWashDate && data.daysUntilWash !== null) {
                const dateText = formatDateShort(data.nextWashDate);
                if (data.daysUntilWash === 0) {
                    setText('trackerNextWashLabel', `Today - ${dateText}`);
                } else if (data.daysUntilWash === 1) {
                    setText('trackerNextWashLabel', `Tomorrow - ${dateText}`);
                } else {
                    setText('trackerNextWashLabel', `${dateText} (${data.daysUntilWash} days)`);
                }
            } else {
                setText('trackerNextWashLabel', 'Log your first wash to track');
            }

            // Maintenance label
            if (data.nextMaintenanceDate && data.daysUntilMaintenance !== null) {
                const dateText = formatDateShort(data.nextMaintenanceDate);
                setText('trackerMaintenanceLabel', `${dateText} (${data.daysUntilMaintenance} days)`);
            }

            // Deep condition label
            setText('trackerDeepConditionLabel', `Every ${data.deepConditionFrequencyDays || config.deepConditionFrequencyDays || 14} days`);

            // Render tips
            renderTrackerTips();
        }

        // Update the circular progress indicator
        function updateTrackerProgressCircle(data) {
            const { daysSinceInstall, maintenanceIntervalDays } = data;
            if (!daysSinceInstall || !maintenanceIntervalDays) return;

            const percent = Math.min(100, Math.round((daysSinceInstall / maintenanceIntervalDays) * 100));
            const circle = document.getElementById('trackerProgressCircle');

            if (circle) {
                // Calculate color based on progress
                let color = 'var(--brand-pink)'; // Normal
                if (percent >= 90) {
                    color = '#ff4444'; // Urgent - red
                } else if (percent >= 75) {
                    color = '#ffaa00'; // Warning - orange
                }

                // Apply gradient based on progress
                circle.style.background = `conic-gradient(${color} ${percent * 3.6}deg, var(--gray-light) 0deg)`;
            }
        }

        // Render personalized tips based on tracker data
        function renderTrackerTips() {
            const tips = [];
            const data = hairTrackerData || {};
            const config = hairTrackerConfig || {};

            // Generate dynamic tips based on data
            if (data.hairHealthScore >= 90) {
                tips.push('Your extensions are at optimal health! Keep up the great care routine.');
            } else if (data.hairHealthScore < 70) {
                tips.push('Your hair health score is low. Consider deep conditioning more frequently.');
            }

            if (data.daysUntilMaintenance !== null) {
                if (data.daysUntilMaintenance <= 14 && data.daysUntilMaintenance > 0) {
                    tips.push(`Consider booking maintenance in the next ${data.daysUntilMaintenance} days for best results.`);
                } else if (data.daysUntilMaintenance <= 0) {
                    tips.push('Your maintenance is overdue! Book an appointment soon to protect your extensions.');
                }
            }

            if (data.daysUntilDeepCondition !== null && data.daysUntilDeepCondition <= 3) {
                tips.push("You're due for a deep conditioning treatment soon.");
            }

            // Add tips from config
            if (config.tips && config.tips.length > 0) {
                // Add a couple random tips from config
                const configTips = [...config.tips].sort(() => Math.random() - 0.5).slice(0, 2);
                tips.push(...configTips);
            }

            // Render tips
            const tipsList = document.getElementById('trackerTipsList');
            if (tipsList && tips.length > 0) {
                tipsList.innerHTML = tips.slice(0, 4).map(tip => `<li>${tip}</li>`).join('');
            }
        }

        // Format date for display
        function formatDateShort(iso) {
            if (!iso) return '';
            const d = new Date(iso);
            return d.toLocaleDateString(undefined, { month: 'short', day: 'numeric' });
        }

        // Show tracker setup modal
        function showTrackerSetupModal() {
            if (!currentUser) {
                showAuthModal();
                return;
            }

            // Populate extension type dropdown
            const select = document.getElementById('trackerExtensionTypeSelect');
            const config = hairTrackerConfig || {};

            if (config.extensionTypes && select) {
                select.innerHTML = '<option value="">Select extension type...</option>';
                config.extensionTypes.forEach(et => {
                    const option = document.createElement('option');
                    option.value = et.id;
                    option.textContent = et.label + (et.maintenanceDays > 0 ? ` (${et.maintenanceDays} day cycle)` : '');
                    select.appendChild(option);
                });
            }

            // Pre-fill with existing data
            const data = hairTrackerData || {};
            if (data.extensionType) {
                select.value = data.extensionType;
            }
            if (data.lastInstallDate) {
                document.getElementById('trackerInstallDate').value = data.lastInstallDate.split('T')[0];
            }
            if (data.lastWashDate) {
                document.getElementById('trackerLastWashDate').value = data.lastWashDate.split('T')[0];
            }
            if (data.lastDeepConditionDate) {
                document.getElementById('trackerLastDeepConditionDate').value = data.lastDeepConditionDate.split('T')[0];
            }

            document.getElementById('trackerSetupModal').classList.add('show');
        }

        // Save tracker setup
        async function saveTrackerSetup() {
            const extensionType = document.getElementById('trackerExtensionTypeSelect').value;
            const installDate = document.getElementById('trackerInstallDate').value;
            const lastWashDate = document.getElementById('trackerLastWashDate').value;
            const lastDeepConditionDate = document.getElementById('trackerLastDeepConditionDate').value;

            if (!extensionType || !installDate) {
                showToast({ type: 'error', title: 'Error', message: 'Please select extension type and installation date' });
                return;
            }

            try {
                const updateData = {
                    extensionType,
                    lastInstallDate: new Date(installDate).toISOString()
                };

                if (lastDeepConditionDate) {
                    updateData.lastDeepConditionDate = new Date(lastDeepConditionDate).toISOString();
                }

                const res = await apiCall('/hair-tracker', {
                    method: 'PATCH',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(updateData)
                });

                // If last wash date provided, log it
                if (lastWashDate) {
                    await apiCall('/hair-tracker/log-wash', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ date: new Date(lastWashDate).toISOString() })
                    });
                }

                closeModal('trackerSetupModal');
                showToast({ type: 'success', title: 'Success', message: 'Hair tracker set up successfully!' });

                // Reload tracker data
                hairTrackerData = null; // Clear cache
                await loadHairTracker();

            } catch (error) {
                console.error('Error saving tracker setup:', error);
                showToast({ type: 'error', title: 'Error', message: 'Failed to save tracker settings' });
            }
        }

        // Log a wash
        async function logWash() {
            if (!currentUser) {
                showAuthModal();
                return;
            }

            try {
                const res = await apiCall('/hair-tracker/log-wash', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ date: new Date().toISOString() })
                });

                if (res.success) {
                    showToast({ type: 'success', title: 'Logged!', message: 'Wash logged successfully' });
                    // Refresh tracker data
                    hairTrackerData = null;
                    await loadHairTracker();
                }
            } catch (error) {
                console.error('Error logging wash:', error);
                showToast({ type: 'error', title: 'Error', message: 'Failed to log wash' });
            }
        }

        // Log deep condition
        async function logDeepCondition() {
            if (!currentUser) {
                showAuthModal();
                return;
            }

            try {
                const res = await apiCall('/hair-tracker/log-deep-condition', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ date: new Date().toISOString() })
                });

                if (res.success) {
                    showToast({ type: 'success', title: 'Logged!', message: 'Deep condition logged successfully' });
                    // Refresh tracker data
                    hairTrackerData = null;
                    await loadHairTracker();
                }
            } catch (error) {
                console.error('Error logging deep condition:', error);
                showToast({ type: 'error', title: 'Error', message: 'Failed to log deep condition' });
            }
        }

        // Book maintenance appointment
        function bookMaintenance() {
            // Switch to booking tab
            switchTab('booking');

            // Optionally pre-select hair extensions service
            if (hairTrackerData?.extensionType) {
                // Select hair tab in booking
                const hairTab = document.querySelector('[onclick*="selectBookingType(\'hair\')"]');
                if (hairTab) hairTab.click();
            }
        }

        // Add progress photo (placeholder)
        function addProgressPhoto() {
            if (!currentUser) {
                showAuthModal();
                return;
            }
            showToast({ type: 'info', title: 'Coming Soon', message: 'Progress photos feature coming soon!' });
        }

        // Profile Actions
        function editProfile() {
            if (!currentUser) {
                showAuthModal();
                return;
            }
            // Prefill form with current user data
            document.getElementById('editProfileName').value = currentUser.name || '';
            document.getElementById('editProfilePhone').value = currentUser.phone || '';
            document.getElementById('editProfileEmail').value = currentUser.email || '';
            document.getElementById('editProfileError').style.display = 'none';
            document.getElementById('editProfileModal').classList.add('show');
        }

        function closeEditProfileModal() {
            document.getElementById('editProfileModal').classList.remove('show');
        }

        async function saveProfile() {
            const name = document.getElementById('editProfileName').value.trim();
            const phone = document.getElementById('editProfilePhone').value.trim();
            const errorEl = document.getElementById('editProfileError');

            if (!name) {
                errorEl.textContent = 'Name is required';
                errorEl.style.display = 'block';
                return;
            }

            try {
                const response = await apiCall('/auth/me', {
                    method: 'PATCH',
                    body: JSON.stringify({ name, phone })
                });
                currentUser = response.user;
                updateUserUI();
                closeEditProfileModal();
                showToast({ type: 'success', title: 'Profile Updated', message: 'Your profile has been saved.' });
            } catch (error) {
                errorEl.textContent = error.message || 'Failed to update profile';
                errorEl.style.display = 'block';
            }
        }

        async function viewAppointments() {
            if (!currentUser) {
                showAuthModal();
                return;
            }
            const modal = document.getElementById('appointmentsModal');
            const body = document.getElementById('appointmentsModalBody');
            body.innerHTML = '<div style="text-align: center; padding: 20px; color: #888;">Loading...</div>';
            modal.classList.add('show');

            try {
                const data = await apiCall('/bookings');
                if (!data.bookings || data.bookings.length === 0) {
                    body.innerHTML = `
                        <div style="text-align: center; padding: 30px;">
                            <div style="font-size: 48px; margin-bottom: 15px;"></div>
                            <div style="font-weight: 600; margin-bottom: 8px;">No appointments yet</div>
                            <p style="color: #888; margin-bottom: 15px;">Book your first appointment today!</p>
                            <button class="btn btn-primary" onclick="closeAppointmentsModal(); switchTab('booking');" style="background: var(--brand-pink);">Book Now</button>
                        </div>
                    `;
                } else {
                    body.innerHTML = data.bookings.map(b => {
                        const date = new Date(b.date);
                        const statusColors = {
                            confirmed: '#4CAF50',
                            pending: '#FF9800',
                            completed: '#2196F3',
                            cancelled: '#f44336'
                        };
                        return `
                            <div style="background: #f9f9f9; border-radius: 12px; padding: 15px; margin-bottom: 12px;">
                                <div style="display: flex; justify-content: space-between; align-items: start;">
                                    <div>
                                        <div style="font-weight: 600; font-size: 16px; margin-bottom: 4px;">${b.serviceName}</div>
                                        <div style="color: #666; font-size: 14px;">${date.toLocaleDateString('en-ZA', { weekday: 'short', day: 'numeric', month: 'short' })} at ${b.time || 'TBC'}</div>
                                        <div style="color: #888; font-size: 13px; margin-top: 4px;">with ${b.stylistName || 'Any stylist'}</div>
                                    </div>
                                    <span style="background: ${statusColors[b.status] || '#888'}; color: white; padding: 4px 10px; border-radius: 12px; font-size: 12px; font-weight: 500;">${b.status}</span>
                                </div>
                            </div>
                        `;
                    }).join('');
                }
            } catch (error) {
                body.innerHTML = `<div style="text-align: center; color: #e74c3c; padding: 20px;">Error loading appointments: ${error.message}</div>`;
            }
        }

        function closeAppointmentsModal() {
            document.getElementById('appointmentsModal').classList.remove('show');
        }

        async function viewOrders() {
            if (!currentUser) {
                showAuthModal();
                return;
            }
            const modal = document.getElementById('ordersModal');
            const body = document.getElementById('ordersModalBody');
            body.innerHTML = '<div style="text-align: center; padding: 20px; color: #888;">Loading...</div>';
            modal.classList.add('show');

            try {
                const data = await apiCall('/orders');
                if (!data.orders || data.orders.length === 0) {
                    body.innerHTML = `
                        <div style="text-align: center; padding: 30px;">
                            <div style="font-size: 48px; margin-bottom: 15px;"></div>
                            <div style="font-weight: 600; margin-bottom: 8px;">No orders yet</div>
                            <p style="color: #888; margin-bottom: 15px;">Shop our extension care products!</p>
                            <button class="btn btn-primary" onclick="closeOrdersModal(); switchTab('shop');" style="background: var(--brand-pink);">Shop Now</button>
                        </div>
                    `;
                } else {
                    body.innerHTML = data.orders.map(o => {
                        const date = new Date(o.createdAt);
                        const statusColors = {
                            pending: '#FF9800',
                            processing: '#2196F3',
                            shipped: '#9C27B0',
                            delivered: '#4CAF50',
                            cancelled: '#f44336'
                        };
                        return `
                            <div style="background: #f9f9f9; border-radius: 12px; padding: 15px; margin-bottom: 12px;">
                                <div style="display: flex; justify-content: space-between; align-items: start;">
                                    <div>
                                        <div style="font-weight: 600; font-size: 16px; margin-bottom: 4px;">Order #${o.id.substring(0, 8)}</div>
                                        <div style="color: #666; font-size: 14px;">${o.items?.length || 0} item(s) - R${o.total?.toLocaleString() || 0}</div>
                                        <div style="color: #888; font-size: 13px; margin-top: 4px;">${date.toLocaleDateString('en-ZA', { day: 'numeric', month: 'short', year: 'numeric' })}</div>
                                    </div>
                                    <span style="background: ${statusColors[o.status] || '#888'}; color: white; padding: 4px 10px; border-radius: 12px; font-size: 12px; font-weight: 500;">${o.status}</span>
                                </div>
                            </div>
                        `;
                    }).join('');
                }
            } catch (error) {
                body.innerHTML = `<div style="text-align: center; color: #e74c3c; padding: 20px;">Error loading orders: ${error.message}</div>`;
            }
        }

        function closeOrdersModal() {
            document.getElementById('ordersModal').classList.remove('show');
        }

        // Payment Methods Modal
        function viewPayments() {
            if (!currentUser) { showAuthModal(); return; }
            document.getElementById('paymentMethodsModal').classList.add('show');
        }
        function closePaymentMethodsModal() {
            document.getElementById('paymentMethodsModal').classList.remove('show');
        }

        // Hair Profile Modal
        async function hairProfile() {
            if (!currentUser) { showAuthModal(); return; }

            const modal = document.getElementById('hairProfileModal');
            const errorEl = document.getElementById('hairProfileError');
            const loadingEl = document.getElementById('hairProfileLoading');
            const saveBtn = document.getElementById('hairProfileSaveBtn');
            const formFields = [
                document.getElementById('hairProfileType'),
                document.getElementById('hairProfileExtension'),
                document.getElementById('hairProfileStylist'),
                document.getElementById('hairProfileNotes')
            ];

            const setLoadingState = (isLoading) => {
                formFields.forEach(field => { if (field) field.disabled = isLoading; });
                if (saveBtn) saveBtn.disabled = isLoading;
                if (loadingEl) loadingEl.style.display = isLoading ? 'flex' : 'none';
            };

            errorEl.style.display = 'none';
            errorEl.textContent = '';
            setLoadingState(true);
            modal.classList.add('show');

            // Load stylists into dropdown
            try {
                const stylistsData = await apiCall('/stylists');
                const select = document.getElementById('hairProfileStylist');
                select.innerHTML = '<option value="">No preference</option>';
                if (stylistsData.stylists) {
                    stylistsData.stylists.forEach(s => {
                        select.innerHTML += `<option value="${s.id}">${s.name}</option>`;
                    });
                }
            } catch (e) {
                const select = document.getElementById('hairProfileStylist');
                if (select) {
                    select.innerHTML = '<option value="">No preference</option>';
                }
                errorEl.textContent = e.message || 'Unable to load stylists right now. Please try again.';
                errorEl.style.display = 'block';
                formFields.forEach(field => { if (field) field.disabled = true; });
                if (saveBtn) saveBtn.disabled = true;
                if (loadingEl) loadingEl.style.display = 'none';
                return;
            }

            // Load current hair profile
            try {
                const data = await apiCall('/hair-profile');
                const hp = data.hairProfile || {};
                document.getElementById('hairProfileType').value = hp.hairType || '';
                document.getElementById('hairProfileExtension').value = hp.extensionType || '';
                document.getElementById('hairProfileStylist').value = hp.preferredStylist || '';
                document.getElementById('hairProfileNotes').value = hp.notes || '';
            } catch (e) {
                errorEl.textContent = e.message || 'Unable to load your hair profile right now. Please try again.';
                errorEl.style.display = 'block';
                formFields.forEach(field => { if (field) field.disabled = true; });
                if (saveBtn) saveBtn.disabled = true;
                if (loadingEl) loadingEl.style.display = 'none';
                return;
            }

            setLoadingState(false);
        }
        function closeHairProfileModal() {
            document.getElementById('hairProfileModal').classList.remove('show');
        }
        async function saveHairProfile() {
            const errorEl = document.getElementById('hairProfileError');
            const hairType = document.getElementById('hairProfileType').value;
            const extensionType = document.getElementById('hairProfileExtension').value;
            const preferredStylist = document.getElementById('hairProfileStylist').value;
            const notes = document.getElementById('hairProfileNotes').value.trim();

            errorEl.style.display = 'none';

            try {
                await apiCall('/hair-profile', {
                    method: 'PATCH',
                    body: JSON.stringify({ hairType, extensionType, preferredStylist, notes })
                });

                if (!currentUser) {
                    currentUser = {};
                }

                if (!currentUser.hairProfile) {
                    currentUser.hairProfile = {};
                }

                Object.assign(currentUser.hairProfile, {
                    hairType,
                    extensionType,
                    preferredStylist,
                    notes
                });
                closeHairProfileModal();
                showToast({ type: 'success', title: 'Saved', message: 'Your hair profile has been updated.' });
            } catch (error) {
                errorEl.textContent = error.message || 'Failed to save hair profile';
                errorEl.style.display = 'block';
            }
        }

        // Notification Preferences Modal
        async function notificationSettings() {
            if (!currentUser) { showAuthModal(); return; }

            const modal = document.getElementById('notificationPrefsModal');
            document.getElementById('notifPrefsError').style.display = 'none';

            // Load current preferences
            try {
                const data = await apiCall('/notification-prefs');
                const prefs = data.notificationPrefs || {};
                document.getElementById('prefPromotions').checked = prefs.promotions !== false;
                document.getElementById('prefAppointments').checked = prefs.appointmentReminders !== false;
                document.getElementById('prefLoyalty').checked = prefs.loyaltyUpdates !== false;
            } catch (e) {
                // Default to checked
                document.getElementById('prefPromotions').checked = true;
                document.getElementById('prefAppointments').checked = true;
                document.getElementById('prefLoyalty').checked = true;
            }

            modal.classList.add('show');
        }
        function closeNotificationPrefsModal() {
            document.getElementById('notificationPrefsModal').classList.remove('show');
        }
        async function saveNotificationPrefs() {
            const errorEl = document.getElementById('notifPrefsError');
            const promotions = document.getElementById('prefPromotions').checked;
            const appointmentReminders = document.getElementById('prefAppointments').checked;
            const loyaltyUpdates = document.getElementById('prefLoyalty').checked;

            try {
                await apiCall('/notification-prefs', {
                    method: 'PATCH',
                    body: JSON.stringify({ promotions, appointmentReminders, loyaltyUpdates })
                });
                closeNotificationPrefsModal();
                showToast({ type: 'success', title: 'Saved', message: 'Notification preferences updated.' });
            } catch (error) {
                errorEl.textContent = error.message || 'Failed to save preferences';
                errorEl.style.display = 'block';
            }
        }

        // Help Center Modal
        function helpCenter() {
            document.getElementById('helpCenterModal').classList.add('show');
        }
        function closeHelpCenterModal() {
            document.getElementById('helpCenterModal').classList.remove('show');
        }

        // Settings Modal
        function settings() {
            if (!currentUser) { showAuthModal(); return; }
            document.getElementById('settingsEmail').textContent = currentUser.email || '-';
            document.getElementById('settingsModal').classList.add('show');
        }
        function closeSettingsModal() {
            document.getElementById('settingsModal').classList.remove('show');
        }

        // Other Functions
        function showProductDetails(product) { alert('Product details: ' + product); }

        // ========== UPCOMING APPOINTMENTS FUNCTIONALITY ==========
        let bookingToReschedule = null;
        let userBookingsData = [];

        async function loadUpcomingAppointment() {
            const container = document.getElementById('upcomingAppointmentsContainer');
            if (!container) return;

            const token = getToken();

            // If not logged in, show login prompt
            if (!token) {
                container.innerHTML = `
                    <div class="appointment-card" style="text-align: center; padding: 30px;">
                        <div style="font-size: 40px; margin-bottom: 15px;"></div>
                        <div style="font-weight: 600; margin-bottom: 8px;">Sign in to view appointments</div>
                        <p style="color: var(--gray-medium); margin-bottom: 15px;">Log in to see and manage your upcoming appointments.</p>
                        <button class="btn btn-primary" onclick="showAuthModal('login')" style="background: var(--brand-pink);">Sign In</button>
                    </div>
                `;
                return;
            }

            try {
                const data = await apiCall('/bookings');
                const bookings = data.bookings || [];
                userBookingsData = bookings;

                // Filter for future confirmed/pending bookings (exclude cancelled)
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                const futureBookings = bookings.filter(b => {
                    const bookingDate = new Date(b.date);
                    return bookingDate >= today && b.status !== 'cancelled';
                });

                // Sort by date (soonest first)
                futureBookings.sort((a, b) => new Date(a.date) - new Date(b.date));

                if (futureBookings.length === 0) {
                    container.innerHTML = `
                        <div class="appointment-card" style="text-align: center; padding: 30px;">
                            <div style="font-size: 40px; margin-bottom: 15px;"></div>
                            <div style="font-weight: 600; margin-bottom: 8px;">No upcoming appointments</div>
                            <p style="color: var(--gray-medium); margin-bottom: 15px;">Book your next hair or beauty appointment!</p>
                            <button class="btn btn-primary" onclick="navigateToSection('book')" style="background: var(--brand-pink);">Book Now</button>
                        </div>
                    `;
                    return;
                }

                // Show all upcoming appointments (up to 3)
                const appointmentsToShow = futureBookings.slice(0, 3);
                container.innerHTML = appointmentsToShow.map(booking => {
                    const bookingDate = new Date(booking.date);
                    const formattedDate = bookingDate.toLocaleDateString('en-ZA', {
                        weekday: 'long',
                        month: 'long',
                        day: 'numeric'
                    });

                    // Format time display
                    let timeDisplay = booking.confirmedTime || booking.time || booking.preferredTimeOfDay || 'TBC';
                    if (timeDisplay === 'morning') timeDisplay = 'Morning (9AM-12PM)';
                    else if (timeDisplay === 'afternoon') timeDisplay = 'Afternoon (12PM-4PM)';
                    else if (timeDisplay === 'evening') timeDisplay = 'Evening (4PM-7PM)';

                    // Get stylist name if available
                    const stylistName = booking.stylistName || 'Our team';

                    // Status badge
                    const statusBadge = booking.status === 'confirmed'
                        ? '<span style="background: #4CAF50; color: white; padding: 2px 8px; border-radius: 10px; font-size: 11px; margin-left: 8px;">Confirmed</span>'
                        : '<span style="background: #FFC107; color: #333; padding: 2px 8px; border-radius: 10px; font-size: 11px; margin-left: 8px;">Pending</span>';

                    return `
                        <div class="appointment-card" data-booking-id="${booking.id}">
                            <div class="appointment-date">${formattedDate}${statusBadge}</div>
                            <div class="appointment-details">
                                <div class="appointment-info">
                                    <div class="appointment-service">${booking.serviceName}</div>
                                    <div class="appointment-time"> ${timeDisplay} with ${stylistName}</div>
                                </div>
                                <div class="appointment-actions">
                                    <button class="btn btn-small btn-outline" onclick="openRescheduleModal('${booking.id}')">Reschedule</button>
                                    <button class="btn btn-small" onclick="cancelBooking('${booking.id}')" style="background: none; color: #e74c3c; border: 1px solid #e74c3c;">Cancel</button>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');

                // Add "view all" link if there are more bookings
                if (futureBookings.length > 3) {
                    container.innerHTML += `
                        <div style="text-align: center; margin-top: 10px;">
                            <a href="#" onclick="navigateToSection('my-bookings'); return false;" style="color: var(--brand-pink); text-decoration: none;">
                                View all ${futureBookings.length} appointments 
                            </a>
                        </div>
                    `;
                }

            } catch (error) {
                console.error('Failed to load appointments:', error);
                container.innerHTML = `
                    <div class="appointment-card" style="text-align: center; padding: 30px;">
                        <div style="font-size: 40px; margin-bottom: 15px;"></div>
                        <div style="font-weight: 600; margin-bottom: 8px;">Unable to load appointments</div>
                        <p style="color: var(--gray-medium); margin-bottom: 15px;">Please try again later.</p>
                        <button class="btn btn-outline" onclick="loadUpcomingAppointment()">Retry</button>
                    </div>
                `;
            }
        }

        function openRescheduleModal(bookingId) {
            const booking = userBookingsData.find(b => b.id === bookingId);
            if (!booking) {
                showToast({ type: 'error', title: 'Booking not found', message: 'Please refresh and try again.' });
                return;
            }

            bookingToReschedule = booking;

            // Show current booking info
            const bookingDate = new Date(booking.date);
            const formattedDate = bookingDate.toLocaleDateString('en-ZA', {
                weekday: 'short',
                month: 'short',
                day: 'numeric'
            });

            document.getElementById('rescheduleBookingInfo').innerHTML = `
                <div style="font-weight: 600;">${booking.serviceName}</div>
                <div style="font-size: 14px; color: var(--gray-medium);">Currently: ${formattedDate}</div>
            `;

            // Set minimum date to tomorrow
            const tomorrow = new Date();
            tomorrow.setDate(tomorrow.getDate() + 1);
            const minDate = tomorrow.toISOString().split('T')[0];
            document.getElementById('rescheduleDate').min = minDate;
            document.getElementById('rescheduleDate').value = '';

            // Reset time select
            document.getElementById('rescheduleTimeOfDay').value = 'morning';

            // Hide any previous errors
            document.getElementById('rescheduleError').style.display = 'none';

            // Show modal
            document.getElementById('rescheduleModal').classList.add('show');
        }

        function closeRescheduleModal() {
            document.getElementById('rescheduleModal').classList.remove('show');
            bookingToReschedule = null;
        }

        async function submitReschedule() {
            const newDate = document.getElementById('rescheduleDate').value;
            const newTimeOfDay = document.getElementById('rescheduleTimeOfDay').value;
            const errorDiv = document.getElementById('rescheduleError');

            // Validation
            if (!newDate) {
                errorDiv.textContent = 'Please select a new date.';
                errorDiv.style.display = 'block';
                return;
            }

            const selectedDate = new Date(newDate);
            const today = new Date();
            today.setHours(0, 0, 0, 0);

            if (selectedDate <= today) {
                errorDiv.textContent = 'Please select a future date.';
                errorDiv.style.display = 'block';
                return;
            }

            if (!bookingToReschedule) {
                errorDiv.textContent = 'No booking selected.';
                errorDiv.style.display = 'block';
                return;
            }

            errorDiv.style.display = 'none';

            try {
                const result = await apiCall(`/bookings/${bookingToReschedule.id}`, {
                    method: 'PATCH',
                    body: JSON.stringify({
                        date: newDate,
                        preferredTimeOfDay: newTimeOfDay,
                        confirmedTime: null // Reset confirmed time since we're rescheduling
                    })
                });

                if (!result.success) throw new Error(result.message || 'Failed to reschedule');

                showToast({ type: 'success', title: 'Rescheduled', message: 'We will confirm your new time.' });
                closeRescheduleModal();
                await loadUpcomingAppointment(); // Refresh the appointments list
            } catch (error) {
                console.error('Reschedule error:', error);
                errorDiv.textContent = error.message || 'Failed to reschedule. Please try again.';
                errorDiv.style.display = 'block';
            }
        }

        async function cancelBooking(bookingId) {
            if (!confirm('Are you sure you want to cancel this appointment?')) {
                return;
            }

            try {
                const result = await apiCall(`/bookings/${bookingId}`, {
                    method: 'PATCH',
                    body: JSON.stringify({ status: 'cancelled' })
                });

                if (result.success) {
                    showToast('Appointment cancelled', 'success');
                    await loadUpcomingAppointment(); // Refresh the list
                } else {
                    throw new Error(result.message || 'Failed to cancel');
                }
            } catch (error) {
                console.error('Cancel error:', error);
                showToast('Failed to cancel appointment', 'error');
            }
        }

        // ========== SPECIAL OFFERS FUNCTIONALITY ==========
        let specialOffersData = [];

        async function loadSpecialOffers() {
            const container = document.getElementById('specialOffersList');
            if (!container) return;

            try {
                const data = await apiCall('/promos/highlighted');
                const promos = data.promos || [];
                specialOffersData = promos;

                if (!promos.length) {
                    // Hide the entire section if no offers
                    const section = document.getElementById('specialOffersSection');
                    if (section) section.style.display = 'none';
                    return;
                }

                container.innerHTML = promos.map(p => `
                    <div class="offer-card" data-code="${p.code}">
                        <span class="offer-badge">${p.badge || 'SPECIAL'}</span>
                        <div class="offer-title">${p.title || p.code}</div>
                        <div class="offer-description">${p.subtitle || p.description || ''}</div>
                    </div>
                `).join('');

                // Attach click handlers
                container.querySelectorAll('.offer-card').forEach(card => {
                    card.addEventListener('click', () => {
                        const code = card.getAttribute('data-code');
                        handleOfferClick(code);
                    });
                });

                // Setup View All button
                setupViewAllOffers();

            } catch (error) {
                console.error('Failed to load special offers:', error);
                container.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Unable to load special offers. Please try again later.</p>';
            }
        }

        function handleOfferClick(code) {
            // Find the promo details
            const promo = specialOffersData.find(p => p.code === code);

            // If user has items in cart or is on shop page, apply to cart
            const promoInput = document.getElementById('promoCodeInput');
            if (promoInput) {
                promoInput.value = code;
                // Show cart and trigger promo apply
                showCart();
                setTimeout(() => {
                    applyPromoCode();
                }, 300);
            } else {
                // Show offer details in a modal/alert
                const discountText = promo
                    ? (promo.discountType === 'percentage' ? `${promo.discountValue}% off` : `R${promo.discountValue} off`)
                    : '';
                const minOrderText = promo && promo.minOrder > 0 ? `\nMinimum order: R${promo.minOrder}` : '';

                alert(`Special Offer: ${promo?.title || code}\n\nUse code: ${code}\nDiscount: ${discountText}${minOrderText}\n\nAdd items to your cart and apply this code at checkout!`);
            }
        }

        function setupViewAllOffers() {
            const viewAllBtn = document.getElementById('viewAllOffersBtn');
            if (viewAllBtn) {
                viewAllBtn.addEventListener('click', (e) => {
                    e.preventDefault();
                    showAllOffersModal();
                });
            }
        }

        function showAllOffersModal() {
            if (!specialOffersData.length) {
                alert('No special offers available right now. Check back soon!');
                return;
            }

            // Create modal content
            const modalContent = specialOffersData.map(p => {
                const discountText = p.discountType === 'percentage' ? `${p.discountValue}% off` : `R${p.discountValue} off`;
                const minOrderText = p.minOrder > 0 ? `Min. order R${p.minOrder}` : 'No minimum';
                const expiresText = p.expiresAt ? `Expires: ${new Date(p.expiresAt).toLocaleDateString()}` : 'No expiry';

                return `
                    <div class="offer-modal-item" onclick="handleOfferClick('${p.code}'); closeModal('offersModal');" style="padding: 15px; border-bottom: 1px solid #eee; cursor: pointer;">
                        <div style="display: flex; justify-content: space-between; align-items: start;">
                            <div>
                                <span style="background: var(--brand-pink); color: white; padding: 2px 8px; border-radius: 4px; font-size: 10px; text-transform: uppercase;">${p.badge || 'SPECIAL'}</span>
                                <div style="font-weight: 600; margin: 8px 0 4px;">${p.title || p.code}</div>
                                <div style="font-size: 13px; color: #666;">${p.subtitle || p.description || ''}</div>
                            </div>
                            <div style="text-align: right; font-size: 12px; color: #888;">
                                <div style="font-weight: 600; color: var(--brand-pink);">${discountText}</div>
                                <div>${minOrderText}</div>
                            </div>
                        </div>
                        <div style="font-size: 11px; color: #999; margin-top: 8px;">Code: <strong>${p.code}</strong>  ${expiresText}</div>
                    </div>
                `;
            }).join('');

            // Check if modal already exists
            let modal = document.getElementById('offersModal');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'offersModal';
                modal.className = 'modal-overlay';
                modal.innerHTML = `
                    <div class="modal" style="max-width: 500px; max-height: 80vh; overflow: hidden;">
                        <div class="modal-header" style="padding: 20px; border-bottom: 1px solid #eee; display: flex; justify-content: space-between; align-items: center;">
                            <h3 style="margin: 0;">All Special Offers</h3>
                            <button onclick="closeModal('offersModal')" style="background: none; border: none; font-size: 24px; cursor: pointer;">&times;</button>
                        </div>
                        <div id="offersModalContent" style="max-height: 60vh; overflow-y: auto;">
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
            }

            document.getElementById('offersModalContent').innerHTML = modalContent;
            modal.classList.add('active');
            modal.style.display = 'flex';
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.classList.remove('active');
                modal.style.display = 'none';
            }
        }
        function showRedeemOptions() { alert('Redeem points options'); }
        function addProgressPhoto() { openPhotoUpload(); }

        // ========== GALLERY FUNCTIONALITY ==========
        async function loadGallery() {
            const container = document.getElementById('galleryGrid');
            if (!container) return;

            try {
                const response = await fetch(`${API_BASE}/gallery`);
                if (!response.ok) throw new Error('Failed to load gallery');

                const data = await response.json();
                const items = data.items || [];

                if (!items.length) {
                    container.innerHTML = `
                        <div style="grid-column: 1 / -1; text-align: center; padding: 40px 20px; background: linear-gradient(135deg, #fef5f8 0%, #fff 100%); border-radius: 15px; border: 2px dashed var(--brand-pink);">
                            <div style="font-size: 60px; margin-bottom: 15px;"></div>
                            <h3 style="font-size: 20px; font-weight: 600; margin-bottom: 10px; color: var(--brand-charcoal);">Our Gallery is Coming Soon!</h3>
                            <p style="color: var(--gray-medium); margin-bottom: 20px; max-width: 400px; margin-left: auto; margin-right: auto;">
                                We're building an amazing collection of transformation photos. In the meantime, check out our services!
                            </p>
                            <button class="btn btn-primary" onclick="navigateToSection('book')" style="background: var(--brand-pink); border: none; padding: 12px 30px; border-radius: 25px; cursor: pointer; font-weight: 600;">
                                Explore Our Services
                            </button>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = items.map(item => `
                    <div class="gallery-item" onclick="openGalleryLightbox('${item.id}')">
                        <img src="${item.imageUrl}" alt="${item.altText || 'Gallery Image'}" onerror="this.src='https://via.placeholder.com/300x300?text=Image'">
                        ${item.label ? `<div class="gallery-label">${item.label}</div>` : ''}
                    </div>
                `).join('');

                // Store items for lightbox
                window.galleryItems = items;

                const instagram = data.instagram;
                const instaContainer = document.getElementById('instagramFeedContainer');
                const instaFallback = document.getElementById('instagramFallback');
                const instaCTA = document.getElementById('instagramCTA');
                const instaFrame = document.getElementById('instagramEmbedFrame');
                if (instaContainer && instaFallback && instaCTA && instaFrame) {
                    if (instagram && instagram.embedUrl) {
                        instaContainer.style.display = 'block';
                        instaFallback.style.display = 'none';
                        instaCTA.style.display = 'inline';
                        if (instagram.username) {
                            instaCTA.href = `https://www.instagram.com/${instagram.username}/`;
                            instaCTA.textContent = `@${instagram.username}`;
                        }
                        instaFrame.src = instagram.embedUrl;
                    } else {
                        instaContainer.style.display = 'block';
                        instaFrame.src = '';
                        instaCTA.style.display = instagram?.username ? 'inline' : 'none';
                        instaFallback.style.display = 'block';
                        instaFallback.innerHTML = instagram?.username
                            ? `Follow us on Instagram: <a href="https://www.instagram.com/${instagram.username}/" target="_blank">@${instagram.username}</a>`
                            : 'Follow us on Instagram for the latest looks.';
                    }
                }

            } catch (error) {
                console.error('Failed to load gallery:', error);
                container.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 40px 20px; background: linear-gradient(135deg, #fef5f8 0%, #fff 100%); border-radius: 15px; border: 2px dashed var(--brand-pink);">
                        <div style="font-size: 60px; margin-bottom: 15px;"></div>
                        <h3 style="font-size: 20px; font-weight: 600; margin-bottom: 10px; color: var(--brand-charcoal);">Our Gallery is Coming Soon!</h3>
                        <p style="color: var(--gray-medium); margin-bottom: 20px; max-width: 400px; margin-left: auto; margin-right: auto;">
                            We're building an amazing collection of transformation photos. In the meantime, check out our services!
                        </p>
                        <button class="btn btn-primary" onclick="navigateToSection('book')" style="background: var(--brand-pink); border: none; padding: 12px 30px; border-radius: 25px; cursor: pointer; font-weight: 600;">
                            Explore Our Services
                        </button>
                    </div>
                `;
            }
        }

        function openInstagramConfigPrompt() {
            const username = prompt('Follow us on Instagram! Enter handle to open profile:', 'flirthair');
            if (username) {
                const clean = username.replace('@','').trim();
                window.open(`https://www.instagram.com/${clean}/`, '_blank');
            }
        }

        function openGalleryLightbox(itemId) {
            const items = window.galleryItems || [];
            const item = items.find(i => i.id === itemId);
            if (!item) return;

            // Create lightbox if not exists
            let lightbox = document.getElementById('galleryLightbox');
            if (!lightbox) {
                lightbox = document.createElement('div');
                lightbox.id = 'galleryLightbox';
                lightbox.style.cssText = 'position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.95); z-index: 9999; display: none; align-items: center; justify-content: center; padding: 20px;';
                lightbox.innerHTML = `
                    <button onclick="closeGalleryLightbox()" style="position: absolute; top: 20px; right: 20px; background: none; border: none; color: white; font-size: 32px; cursor: pointer; z-index: 10001;">&times;</button>
                    <div style="max-width: 90%; max-height: 90%; text-align: center;">
                        <img id="lightboxImage" src="" alt="" style="max-width: 100%; max-height: 80vh; object-fit: contain; border-radius: 8px;">
                        <div id="lightboxCaption" style="color: white; margin-top: 15px; font-size: 16px;"></div>
                    </div>
                `;
                document.body.appendChild(lightbox);

                // Close on background click
                lightbox.addEventListener('click', (e) => {
                    if (e.target === lightbox) closeGalleryLightbox();
                });
            }

            document.getElementById('lightboxImage').src = item.imageUrl;
            document.getElementById('lightboxCaption').textContent = item.label || '';
            lightbox.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function closeGalleryLightbox() {
            const lightbox = document.getElementById('galleryLightbox');
            if (lightbox) {
                lightbox.style.display = 'none';
                document.body.style.overflow = '';
            }
        }

        // ========== HAIR TIPS FUNCTIONALITY ==========
        const defaultHairTips = [
            'Use a silk pillowcase to prevent tangling and maintain your extensions while you sleep. ',
            'Avoid washing your hair in very hot water - lukewarm water helps preserve your extension bonds. ',
            'Brush your extensions from bottom to top using a loop brush to prevent shedding. ',
            'Apply hair oil or serum to the mid-lengths and ends daily to keep extensions smooth and shiny. ',
            'Book regular maintenance appointments every 6-8 weeks to keep your extensions looking fresh. '
        ];

        async function loadHairTip() {
            const tipElement = document.getElementById('hairTipText');
            const tipCard = document.getElementById('hairTipCard');
            if (!tipElement || !tipCard) return;

            try {
                const response = await fetch(`${API_BASE}/hair-tips/random`);
                if (!response.ok) throw new Error('Failed to load hair tip');

                const data = await response.json();
                if (data.tip && data.tip.text) {
                    tipElement.textContent = data.tip.text;
                } else {
                    // Show random default tip
                    const randomTip = defaultHairTips[Math.floor(Math.random() * defaultHairTips.length)];
                    tipElement.textContent = randomTip;
                }
            } catch (error) {
                console.error('Failed to load hair tip:', error);
                // Show random default tip on error
                const randomTip = defaultHairTips[Math.floor(Math.random() * defaultHairTips.length)];
                tipElement.textContent = randomTip;
            }
        }

        // ========== CART FUNCTIONALITY ==========
        const CART_STORAGE_KEY = 'flirt_cart';

        // Load cart from localStorage or use empty array
        function loadCartFromStorage() {
            try {
                const stored = localStorage.getItem(CART_STORAGE_KEY);
                return stored ? JSON.parse(stored) : [];
            } catch (e) {
                console.error('Error loading cart from storage:', e);
                return [];
            }
        }

        // Save cart to localStorage
        function saveCartToStorage() {
            try {
                localStorage.setItem(CART_STORAGE_KEY, JSON.stringify(cart));
            } catch (e) {
                console.error('Error saving cart to storage:', e);
            }
        }

        // Clear cart from localStorage
        function clearCartStorage() {
            try {
                localStorage.removeItem(CART_STORAGE_KEY);
            } catch (e) {
                console.error('Error clearing cart storage:', e);
            }
        }

        // Initialize cart from storage
        let cart = loadCartFromStorage();
        let deliveryFee = 0;
        let discount = 0;

        function showCart() {
            document.getElementById('cartModal').classList.add('open');
            document.getElementById('cartOverlay').classList.add('show');
            updateCartDisplay();
        }

        function closeCart() {
            document.getElementById('cartModal').classList.remove('open');
            document.getElementById('cartOverlay').classList.remove('show');
        }

        function addToCart(id, name, price, originalPrice) {
            const existingItem = cart.find(item => item.id === id);
            if (existingItem) {
                existingItem.qty++;
            } else {
                cart.push({
                    id: id,
                    name: name,
                    price: price,
                    originalPrice: originalPrice,
                    qty: 1,
                image: 'https://www.flirthair.co.za/wp-content/uploads/2022/03/KEVIN-MURPHY-Angel-300x300.png'
                });
            }
            saveCartToStorage(); // Persist cart
            updateCartCount();
            showToast({ type: 'success', title: 'Added to Cart', message: `${name} has been added to your cart`, duration: 3000 });
        }

        function updateQty(id, change) {
            const item = cart.find(i => i.id === id);
            if (item) {
                item.qty = Math.max(1, item.qty + change);
                document.getElementById(`qty-${id}`).textContent = item.qty;
                saveCartToStorage(); // Persist cart
                updateCartTotals();
            }
        }

        function removeFromCart(id) {
            cart = cart.filter(item => item.id !== id);
            saveCartToStorage(); // Persist cart
            updateCartDisplay();
            updateCartCount();
        }

        function updateCartCount() {
            const count = cart.reduce((sum, item) => sum + item.qty, 0);
            document.getElementById('cartCount').textContent = count;
        }

        function updateCartDisplay() {
            const cartItemsContainer = document.getElementById('cartItems');
            if (cart.length === 0) {
                cartItemsContainer.innerHTML = '<p style="text-align: center; color: var(--gray-medium); padding: 40px;">Your cart is empty</p>';
            } else {
                cartItemsContainer.innerHTML = cart.map(item => `
                    <div class="cart-item">
                        <img src="${item.image}" class="cart-item-image" alt="${item.name}">
                        <div class="cart-item-details">
                            <div class="cart-item-name">${item.name}</div>
                            <div class="cart-item-price">R${item.price}</div>
                            <div class="quantity-control">
                                <button class="qty-btn" onclick="updateQty('${item.id}', -1)">-</button>
                                <span id="qty-${item.id}">${item.qty}</span>
                                <button class="qty-btn" onclick="updateQty('${item.id}', 1)">+</button>
                                <button style="background: none; border: none; color: #ff6b6b; cursor: pointer; margin-left: 10px;" onclick="removeFromCart('${item.id}')">Remove</button>
                            </div>
                        </div>
                    </div>
                `).join('');
            }
            updateCartTotals();
        }

        function updateCartTotals() {
            const subtotal = cart.reduce((sum, item) => sum + (item.price * item.qty), 0);
            document.getElementById('cartSubtotal').textContent = `R${subtotal}`;
            document.getElementById('cartTotal').textContent = `R${subtotal}`;
        }

        // ========== CHECKOUT FUNCTIONALITY ==========
        function openCheckout() {
            closeCart();
            document.getElementById('checkoutModal').classList.add('show');
        }

        function selectDelivery(element, method, fee) {
            document.querySelectorAll('.delivery-option').forEach(opt => opt.classList.remove('selected'));
            element.classList.add('selected');
            deliveryFee = fee;

            // Show/hide address section
            const addressSection = document.getElementById('deliveryAddressSection');
            if (method === 'pickup') {
                addressSection.style.display = 'none';
                document.getElementById('invoiceDelivery').textContent = 'FREE';
            } else {
                addressSection.style.display = 'block';
                document.getElementById('invoiceDelivery').textContent = `R${fee}`;
            }
            updateCheckoutTotal();
        }

        let appliedPromoCode = null;

        async function applyPromo() {
            const code = document.getElementById('promoCode').value.trim();
            const messageEl = document.getElementById('promoMessage');

            if (!code) {
                discount = 0;
                appliedPromoCode = null;
                messageEl.textContent = '';
                document.getElementById('discountRow').style.display = 'none';
                updateCheckoutTotal();
                return;
            }

            try {
                const data = await apiCall('/promo/validate', {
                    method: 'POST',
                    body: JSON.stringify({ code, subtotal: getSubtotal() })
                });

                discount = data.promo.calculatedDiscount;
                appliedPromoCode = data.promo.code;
                messageEl.textContent = ` ${data.promo.description}! You save R${discount}`;
                messageEl.style.color = 'var(--success)';
                document.getElementById('discountRow').style.display = 'flex';
                document.getElementById('invoiceDiscount').textContent = `-R${discount}`;
            } catch (error) {
                discount = 0;
                appliedPromoCode = null;
                messageEl.textContent = error.message || 'Invalid promo code';
                messageEl.style.color = '#ff6b6b';
                document.getElementById('discountRow').style.display = 'none';
            }
            updateCheckoutTotal();
        }

        function getSubtotal() {
            return cart.reduce((sum, item) => sum + (item.price * item.qty), 0);
        }

        function updateCheckoutTotal() {
            const subtotal = getSubtotal();
            const total = subtotal + deliveryFee - discount;
            document.getElementById('invoiceTotal').textContent = `R${total}`;
            document.getElementById('payAmount').textContent = total;
        }

        // Helper function to build delivery address from form fields
        function getDeliveryAddress() {
            const street = document.getElementById('deliveryStreet')?.value?.trim() || '';
            const suburb = document.getElementById('deliverySuburb')?.value?.trim() || '';
            const city = document.getElementById('deliveryCity')?.value?.trim() || '';
            const postalCode = document.getElementById('deliveryPostalCode')?.value?.trim() || '';
            const instructions = document.getElementById('deliveryInstructions')?.value?.trim() || '';

            // Build address string
            const parts = [street];
            if (suburb) parts.push(suburb);
            parts.push(city);
            parts.push(postalCode);

            return {
                formatted: parts.filter(p => p).join(', '),
                street,
                suburb,
                city,
                postalCode,
                instructions
            };
        }

        // Validate delivery address fields
        function validateDeliveryAddress() {
            const street = document.getElementById('deliveryStreet')?.value?.trim();
            const city = document.getElementById('deliveryCity')?.value?.trim();
            const postalCode = document.getElementById('deliveryPostalCode')?.value?.trim();

            const errors = [];
            if (!street) errors.push('Street address is required');
            if (!city) errors.push('City is required');
            if (!postalCode) errors.push('Postal code is required');

            return errors;
        }

        async function processPayment() {
            // Check if user is logged in
            if (!currentUser) {
                showAuthModal();
                return;
            }

            if (cart.length === 0) {
                alert('Your cart is empty!');
                return;
            }

            // Get delivery info
            const selectedDelivery = document.querySelector('.delivery-option.selected');
            const deliveryMethod = selectedDelivery?.dataset?.method || 'pickup';

            // Get and validate delivery address for non-pickup orders
            let deliveryAddress = null;
            if (deliveryMethod !== 'pickup') {
                const addressErrors = validateDeliveryAddress();
                if (addressErrors.length > 0) {
                    alert('Please complete your delivery address:\n\n' + addressErrors.join('\n'));
                    return;
                }
                deliveryAddress = getDeliveryAddress();
            }

            if (deliveryMethod !== 'pickup' && !deliveryAddress) {
                alert('Please enter your delivery address');
                return;
            }

            try {
                const orderData = {
                    items: cart.map(item => ({
                        productId: item.id,
                        quantity: item.qty
                    })),
                    deliveryMethod,
                    deliveryAddress: deliveryMethod !== 'pickup' ? deliveryAddress : null,
                    promoCode: appliedPromoCode
                };

                const data = await apiCall('/orders', {
                    method: 'POST',
                    body: JSON.stringify(orderData)
                });

                // Choose provider: prefer PayFast if configured, else Yoco
                const preferredProvider = window.paymentConfig?.payfast?.configured ? 'payfast' : 'yoco';

                const paymentInit = await apiCall('/payments/initiate', {
                    method: 'POST',
                    body: JSON.stringify({
                        provider: preferredProvider,
                        orderId: data.order.id
                    })
                });

                if (paymentInit.payment?.provider === 'payfast') {
                    const form = document.createElement('form');
                    form.action = paymentInit.payment.formAction;
                    form.method = 'POST';
                    form.style.display = 'none';

                    Object.entries(paymentInit.payment.formData || {}).forEach(([name, value]) => {
                        const input = document.createElement('input');
                        input.type = 'hidden';
                        input.name = name;
                        input.value = value;
                        form.appendChild(input);
                    });

                    document.body.appendChild(form);
                    form.submit();
                } else if (paymentInit.payment?.provider === 'yoco' && paymentInit.payment.redirectUrl) {
                    window.location.href = paymentInit.payment.redirectUrl;
                } else {
                    alert('Payment created, but no redirect URL returned. Please contact support.');
                }

                // Clear cart after redirect is triggered
                closeModal('checkoutModal');
                cart = [];
                clearCartStorage(); // Clear persisted cart
                discount = 0;
                appliedPromoCode = null;
                updateCartCount();
            } catch (error) {
                alert('Error processing order: ' + error.message);
            }
        }
        // ========== CHAT FUNCTIONALITY ==========
        let chatOpen = false;

        // ========== REAL-TIME CHAT SYSTEM ==========
        let currentConversationId = null;
        let chatPollingInterval = null;
        let lastRenderedMessageCount = 0;

        function getGuestId() {
            let id = localStorage.getItem('flirt_guest_id');
            if (!id) {
                id = 'guest_' + Math.random().toString(36).slice(2);
                localStorage.setItem('flirt_guest_id', id);
            }
            return id;
        }

        function toggleChat() {
            chatOpen = !chatOpen;
            const chatWindow = document.getElementById('chatWindow');
            const chatFab = document.getElementById('chatFab');

            if (chatOpen) {
                chatWindow.classList.add('open');
                chatFab.style.display = 'none';
                document.querySelector('.chat-notification').style.display = 'none';
                // Load existing conversation when chat opens
                loadExistingConversation();
                // Start polling for new messages
                startChatPolling();
            } else {
                chatWindow.classList.remove('open');
                chatFab.style.display = 'flex';
                // Stop polling when chat closes
                stopChatPolling();
            }
        }

        async function loadExistingConversation() {
            try {
                let url = '/chat/my-latest';
                if (!currentUser) {
                    url += '?guestId=' + encodeURIComponent(getGuestId());
                }

                const data = await apiCall(url);

                if (data.conversation) {
                    currentConversationId = data.conversation.id;
                    renderConversation(data.conversation);
                } else {
                    // No existing conversation, show welcome message
                    const messagesContainer = document.getElementById('chatMessages');
                    messagesContainer.innerHTML = '';
                    appendChatMessage('received', 'Hey gorgeous!  Welcome to Flirt Hair! How can I help you with your hair journey today?', new Date());
                    lastRenderedMessageCount = 0;
                }
            } catch (error) {
                console.error('Failed to load conversation:', error);
            }
        }

        function renderConversation(conversation) {
            const messagesContainer = document.getElementById('chatMessages');
            messagesContainer.innerHTML = '';

            if (conversation.messages && conversation.messages.length > 0) {
                conversation.messages.forEach(msg => {
                    const fromType = msg.from === 'user' ? 'sent' : 'received';
                    appendChatMessage(fromType, msg.text, new Date(msg.createdAt));
                });
                lastRenderedMessageCount = conversation.messages.length;
            }
        }

        function appendChatMessage(fromType, text, date) {
            const messagesContainer = document.getElementById('chatMessages');
            const wrapper = document.createElement('div');
            wrapper.className = 'chat-message ' + fromType;

            const bubble = document.createElement('div');
            bubble.className = 'message-bubble';
            bubble.textContent = text; // Safe: uses textContent, not innerHTML

            const time = document.createElement('div');
            time.className = 'message-time';
            time.textContent = date ? formatChatTime(date) : '';

            wrapper.appendChild(bubble);
            wrapper.appendChild(time);
            messagesContainer.appendChild(wrapper);

            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function formatChatTime(date) {
            const now = new Date();
            const diff = now - date;

            if (diff < 60000) return 'Just now';
            if (diff < 3600000) return Math.floor(diff / 60000) + 'm ago';
            if (diff < 86400000) return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            return date.toLocaleDateString();
        }

        function handleChatKeypress(event) {
            if (event.key === 'Enter') {
                sendChatMessage();
            }
        }

        async function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const text = input.value.trim();

            if (!text) return;

            // Optimistic render of user message
            appendChatMessage('sent', text, new Date());
            input.value = '';

            try {
                const body = {
                    conversationId: currentConversationId,
                    text,
                    source: 'app'
                };

                if (!currentUser) {
                    body.guestId = getGuestId();
                }

                const data = await apiCall('/chat/message', {
                    method: 'POST',
                    body: JSON.stringify(body)
                });

                if (!currentConversationId && data.conversation) {
                    currentConversationId = data.conversation.id;
                    // Store in localStorage for persistence
                    localStorage.setItem('flirt_conversation_id', currentConversationId);
                }

                // If it's a new conversation, we may have received a system welcome message
                if (data.isNewConversation) {
                    // Reload to get the welcome message
                    await pollForNewMessages();
                }

                lastRenderedMessageCount++;

            } catch (error) {
                console.error('Chat send error:', error);
                // Show error indication
                appendChatMessage('received', 'Sorry, there was an error sending your message. Please try again.', new Date());
            }
        }

        function startChatPolling() {
            if (chatPollingInterval) return;

            chatPollingInterval = setInterval(async () => {
                if (currentConversationId && chatOpen) {
                    await pollForNewMessages();
                }
            }, 10000); // Poll every 10 seconds
        }

        function stopChatPolling() {
            if (chatPollingInterval) {
                clearInterval(chatPollingInterval);
                chatPollingInterval = null;
            }
        }

        async function pollForNewMessages() {
            if (!currentConversationId) return;

            try {
                let url = `/chat/conversation/${currentConversationId}`;
                if (!currentUser) {
                    url += '?guestId=' + encodeURIComponent(getGuestId());
                }

                const data = await apiCall(url);

                if (data.conversation && data.conversation.messages) {
                    const messages = data.conversation.messages;

                    // Check if there are new messages
                    if (messages.length > lastRenderedMessageCount) {
                        // Render only new messages
                        const newMessages = messages.slice(lastRenderedMessageCount);
                        newMessages.forEach(msg => {
                            // Only render agent/system messages (user messages already rendered optimistically)
                            if (msg.from !== 'user') {
                                appendChatMessage('received', msg.text, new Date(msg.createdAt));
                            }
                        });
                        lastRenderedMessageCount = messages.length;
                    }
                }
            } catch (error) {
                console.error('Error polling messages:', error);
            }
        }

        // ========== PHOTO UPLOAD FUNCTIONALITY ==========
        function openPhotoUpload() {
            document.getElementById('photoUploadModal').classList.add('show');
        }

        function triggerFileUpload() {
            document.getElementById('photoInput').click();
        }

        function handlePhotoUpload(event) {
            const files = event.target.files;
            const previewContainer = document.getElementById('uploadPreviewContainer');

            for (let file of files) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    previewContainer.innerHTML += `<img src="${e.target.result}" class="preview-thumb" alt="Upload preview">`;
                };
                reader.readAsDataURL(file);
            }
        }

        function saveInspoPhotos() {
            alert(' Photos saved to your Inspo Board!\n\nYour stylist will be able to see these during your next consultation.');
            closeModal('photoUploadModal');
        }

        // ========== TEAM FUNCTIONALITY ==========
        function openStylistInsta(stylist) {
            alert(`Opening ${stylists[stylist].name}'s Instagram portfolio... `);
        }

        function bookWithStylist(stylistId) {
            selectStylist(stylistId);
            switchTab('booking');
        }

        function chatWithStylist(stylist) {
            toggleChat();
            setTimeout(() => {
                const messagesContainer = document.getElementById('chatMessages');
                messagesContainer.innerHTML += `
                    <div class="chat-message received">
                        <div class="message-bubble">Hi! You've requested to chat with ${stylists[stylist].name}. She'll be notified and will respond soon! </div>
                        <div class="message-time">Just now</div>
                    </div>
                `;
            }, 500);
        }

        // ========== FLASH SALE TIMER ==========
        function updateFlashSaleTimer() {
            let hours = parseInt(document.getElementById('hours').textContent);
            let minutes = parseInt(document.getElementById('minutes').textContent);
            let seconds = parseInt(document.getElementById('seconds').textContent);

            seconds--;
            if (seconds < 0) {
                seconds = 59;
                minutes--;
                if (minutes < 0) {
                    minutes = 59;
                    hours--;
                    if (hours < 0) {
                        hours = 5;
                        minutes = 32;
                        seconds = 48;
                    }
                }
            }

            document.getElementById('hours').textContent = hours.toString().padStart(2, '0');
            document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
            document.getElementById('seconds').textContent = seconds.toString().padStart(2, '0');
        }

        setInterval(updateFlashSaleTimer, 1000);

        // Close modals when clicking outside
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('show');
            }
        }

        // ============================================
        // INITIALIZATION
        // ============================================

        // Register Service Worker for PWA
        async function registerServiceWorker() {
            if ('serviceWorker' in navigator) {
                try {
                    const registration = await navigator.serviceWorker.register('/sw.js');
                    console.log('[PWA] Service Worker registered:', registration.scope);

                    // Listen for updates
                    registration.addEventListener('updatefound', () => {
                        const newWorker = registration.installing;
                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                // New version available
                                if (confirm('A new version of the app is available. Reload to update?')) {
                                    newWorker.postMessage('skipWaiting');
                                    window.location.reload();
                                }
                            }
                        });
                    });
                } catch (error) {
                    console.log('[PWA] Service Worker registration failed:', error);
                }
            }
        }

        async function initApp() {
            console.log(' Initializing Flirt Hair & Beauty App...');
            console.log('API_BASE:', API_BASE);

            // Dev auto-login for localhost
            await devAutoLoginIfNeeded();

            // Register service worker
            registerServiceWorker();
            // Wire support WhatsApp link
            const whatsappLink = document.getElementById('supportWhatsappLink');
            if (whatsappLink) {
                whatsappLink.href = `https://wa.me/${SUPPORT_WHATSAPP}`;
            }

            // Setup auth input listeners for clearing errors
            setupAuthInputListeners();

            // Initialize UI for guest state first, then check auth
            updateUserUI();

            // Check if user is already logged in (will update UI if logged in)
            console.log('Checking auth status...');
            await checkAuthStatus();

            // Load all data independently - errors in one section won't block others
            console.log('Loading booking data...');
            try {
                await loadBookingData();
            } catch (e) {
                console.error('Booking data load failed:', e);
            }

            console.log('Loading special offers...');
            try {
                await loadSpecialOffers();
            } catch (e) {
                console.error('Special offers load failed:', e);
            }

            console.log('Loading gallery...');
            try {
                await loadGallery();
                console.log(' Gallery loaded');
            } catch (e) {
                console.error('Gallery load failed:', e);
            }

            console.log('Loading hair tip...');
            try {
                await loadHairTip();
                console.log(' Hair tip loaded');
            } catch (e) {
                console.error('Hair tip load failed:', e);
            }

            console.log('Loading upcoming appointments...');
            try {
                await loadUpcomingAppointment();
                console.log(' Upcoming appointments loaded');
            } catch (e) {
                console.error('Upcoming appointments load failed:', e);
            }

            // Initialize cart from localStorage (cart is already loaded at declaration)
            // Just update the display
            updateCartCount();

            // Check for admin-triggered notifications after a short delay
            setTimeout(() => {
                checkForNotifications();
            }, 2000);

            console.log('Flirt Hair & Beauty App initialized');
            if (cart.length > 0) {
                console.log(`Cart restored with ${cart.length} item(s)`);
            }
        }

        // Run on page load
        document.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
